{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane/./node_modules/bibtex-parse-js/bibtexParse.js","webpack://office-addin-taskpane/webpack/bootstrap","webpack://office-addin-taskpane/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane/webpack/runtime/publicPath","webpack://office-addin-taskpane/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane/./src/lib/bibtex.ts","webpack://office-addin-taskpane/./src/lib/storage.ts","webpack://office-addin-taskpane/./src/lib/cite.ts","webpack://office-addin-taskpane/./src/taskpane/taskpane.ts","webpack://office-addin-taskpane/./src/taskpane/taskpane.html"],"sourcesContent":["/* start bibtexParse 0.0.22 */\n\n//Original work by Henrik Muehe (c) 2010\n//\n//CommonJS port by Mikola Lysenko 2013\n//\n//Port to Browser lib by ORCID / RCPETERS\n//\n//Issues:\n//no comment handling within strings\n//no string concatenation\n//no variable values yet\n//Grammar implemented here:\n//bibtex -> (string | preamble | comment | entry)*;\n//string -> '@STRING' '{' key_equals_value '}';\n//preamble -> '@PREAMBLE' '{' value '}';\n//comment -> '@COMMENT' '{' value '}';\n//entry -> '@' key '{' key ',' key_value_list '}';\n//key_value_list -> key_equals_value (',' key_equals_value)*;\n//key_equals_value -> key '=' value;\n//value -> value_quotes | value_braces | key;\n//value_quotes -> '\"' .*? '\"'; // not quite\n//value_braces -> '{' .*? '\"'; // not quite\n(function(exports) {\n\n    function BibtexParser() {\n        \n        this.months = [\"jan\", \"feb\", \"mar\", \"apr\", \"may\", \"jun\", \"jul\", \"aug\", \"sep\", \"oct\", \"nov\", \"dec\"];\n        this.notKey = [',','{','}',' ','='];\n        this.pos = 0;\n        this.input = \"\";\n        this.entries = new Array();\n\n        this.currentEntry = \"\";\n\n        this.setInput = function(t) {\n            this.input = t;\n        };\n\n        this.getEntries = function() {\n            return this.entries;\n        };\n\n        this.isWhitespace = function(s) {\n            return (s == ' ' || s == '\\r' || s == '\\t' || s == '\\n');\n        };\n\n        this.match = function(s, canCommentOut) {\n            if (canCommentOut == undefined || canCommentOut == null)\n                canCommentOut = true;\n            this.skipWhitespace(canCommentOut);\n            if (this.input.substring(this.pos, this.pos + s.length) == s) {\n                this.pos += s.length;\n            } else {\n                throw \"Token mismatch, expected \" + s + \", found \"\n                        + this.input.substring(this.pos);\n            };\n            this.skipWhitespace(canCommentOut);\n        };\n\n        this.tryMatch = function(s, canCommentOut) {\n            if (canCommentOut == undefined || canCommentOut == null)\n                canCommentOut = true;\n            this.skipWhitespace(canCommentOut);\n            if (this.input.substring(this.pos, this.pos + s.length) == s) {\n                return true;\n            } else {\n                return false;\n            };\n            this.skipWhitespace(canCommentOut);\n        };\n\n        /* when search for a match all text can be ignored, not just white space */\n        this.matchAt = function() {\n            while (this.input.length > this.pos && this.input[this.pos] != '@') {\n                this.pos++;\n            };\n\n            if (this.input[this.pos] == '@') {\n                return true;\n            };\n            return false;\n        };\n\n        this.skipWhitespace = function(canCommentOut) {\n            while (this.isWhitespace(this.input[this.pos])) {\n                this.pos++;\n            };\n            if (this.input[this.pos] == \"%\" && canCommentOut == true) {\n                while (this.input[this.pos] != \"\\n\") {\n                    this.pos++;\n                };\n                this.skipWhitespace(canCommentOut);\n            };\n        };\n\n        this.value_braces = function() {\n            var bracecount = 0;\n            this.match(\"{\", false);\n            var start = this.pos;\n            var escaped = false;\n            while (true) {\n                if (!escaped) {\n                    if (this.input[this.pos] == '}') {\n                        if (bracecount > 0) {\n                            bracecount--;\n                        } else {\n                            var end = this.pos;\n                            this.match(\"}\", false);\n                            return this.input.substring(start, end);\n                        };\n                    } else if (this.input[this.pos] == '{') {\n                        bracecount++;\n                    } else if (this.pos >= this.input.length - 1) {\n                        throw \"Unterminated value\";\n                    };\n                };\n                if (this.input[this.pos] == '\\\\' && escaped == false)\n                    escaped = true;\n                else\n                    escaped = false;\n                this.pos++;\n            };\n        };\n\n        this.value_comment = function() {\n            var str = '';\n            var brcktCnt = 0;\n            while (!(this.tryMatch(\"}\", false) && brcktCnt == 0)) {\n                str = str + this.input[this.pos];\n                if (this.input[this.pos] == '{')\n                    brcktCnt++;\n                if (this.input[this.pos] == '}')\n                    brcktCnt--;\n                if (this.pos >= this.input.length - 1) {\n                    throw \"Unterminated value:\" + this.input.substring(start);\n                };\n                this.pos++;\n            };\n            return str;\n        };\n\n        this.value_quotes = function() {\n            this.match('\"', false);\n            var start = this.pos;\n            var escaped = false;\n            while (true) {\n                if (!escaped) {\n                    if (this.input[this.pos] == '\"') {\n                        var end = this.pos;\n                        this.match('\"', false);\n                        return this.input.substring(start, end);\n                    } else if (this.pos >= this.input.length - 1) {\n                        throw \"Unterminated value:\" + this.input.substring(start);\n                    };\n                }\n                if (this.input[this.pos] == '\\\\' && escaped == false)\n                    escaped = true;\n                else\n                    escaped = false;\n                this.pos++;\n            };\n        };\n\n        this.single_value = function() {\n            var start = this.pos;\n            if (this.tryMatch(\"{\")) {\n                return this.value_braces();\n            } else if (this.tryMatch('\"')) {\n                return this.value_quotes();\n            } else {\n                var k = this.key();\n                if (k.match(\"^[0-9]+$\"))\n                    return k;\n                else if (this.months.indexOf(k.toLowerCase()) >= 0)\n                    return k.toLowerCase();\n                else\n                    throw \"Value expected:\" + this.input.substring(start) + ' for key: ' + k;\n            \n            };\n        };\n\n        this.value = function() {\n            var values = [];\n            values.push(this.single_value());\n            while (this.tryMatch(\"#\")) {\n                this.match(\"#\");\n                values.push(this.single_value());\n            };\n            return values.join(\"\");\n        };\n\n        this.key = function() {\n            var start = this.pos;\n            while (true) {\n                if (this.pos >= this.input.length) {\n                    throw \"Runaway key\";\n                };\n                                // -- is Cyrillic\n                //console.log(this.input[this.pos]);\n                if (this.notKey.indexOf(this.input[this.pos]) >= 0) {\n                    return this.input.substring(start, this.pos);\n                } else {\n                    this.pos++;\n                    \n                };\n            };\n        };\n\n        this.key_equals_value = function() {\n            var key = this.key();\n            if (this.tryMatch(\"=\")) {\n                this.match(\"=\");\n                var val = this.value();\n                return [ key, val ];\n            } else {\n                throw \"... = value expected, equals sign missing:\"\n                        + this.input.substring(this.pos);\n            };\n        };\n\n        this.key_value_list = function() {\n            var kv = this.key_equals_value();\n            this.currentEntry['entryTags'] = {};\n            this.currentEntry['entryTags'][kv[0]] = kv[1];\n            while (this.tryMatch(\",\")) {\n                this.match(\",\");\n                // fixes problems with commas at the end of a list\n                if (this.tryMatch(\"}\")) {\n                    break;\n                }\n                ;\n                kv = this.key_equals_value();\n                this.currentEntry['entryTags'][kv[0]] = kv[1];\n            };\n        };\n\n        this.entry_body = function(d) {\n            this.currentEntry = {};\n            this.currentEntry['citationKey'] = this.key();\n            this.currentEntry['entryType'] = d.substring(1);\n            this.match(\",\");\n            this.key_value_list();\n            this.entries.push(this.currentEntry);\n        };\n\n        this.directive = function() {\n            this.match(\"@\");\n            return \"@\" + this.key();\n        };\n\n        this.preamble = function() {\n            this.currentEntry = {};\n            this.currentEntry['entryType'] = 'PREAMBLE';\n            this.currentEntry['entry'] = this.value_comment();\n            this.entries.push(this.currentEntry);\n        };\n\n        this.comment = function() {\n            this.currentEntry = {};\n            this.currentEntry['entryType'] = 'COMMENT';\n            this.currentEntry['entry'] = this.value_comment();\n            this.entries.push(this.currentEntry);\n        };\n\n        this.entry = function(d) {\n            this.entry_body(d);\n        };\n\n        this.bibtex = function() {\n            while (this.matchAt()) {\n                var d = this.directive();\n                this.match(\"{\");\n                if (d == \"@STRING\") {\n                    this.string();\n                } else if (d == \"@PREAMBLE\") {\n                    this.preamble();\n                } else if (d == \"@COMMENT\") {\n                    this.comment();\n                } else {\n                    this.entry(d);\n                }\n                this.match(\"}\");\n            };\n        };\n    };\n    \n    exports.toJSON = function(bibtex) {\n        var b = new BibtexParser();\n        b.setInput(bibtex);\n        b.bibtex();\n        return b.entries;\n    };\n\n    /* added during hackathon don't hate on me */\n    exports.toBibtex = function(json) {\n        var out = '';\n        for ( var i in json) {\n            out += \"@\" + json[i].entryType;\n            out += '{';\n            if (json[i].citationKey)\n                out += json[i].citationKey + ', ';\n            if (json[i].entry)\n                out += json[i].entry ;\n            if (json[i].entryTags) {\n                var tags = '';\n                for (var jdx in json[i].entryTags) {\n                    if (tags.length != 0)\n                        tags += ', ';\n                    tags += jdx + '= {' + json[i].entryTags[jdx] + '}';\n                }\n                out += tags;\n            }\n            out += '}\\n\\n';\n        }\n        return out;\n        \n    };\n\n})(typeof exports === 'undefined' ? this['bibtexParse'] = {} : exports);\n\n/* end bibtexParse */\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","__webpack_require__.p = \"/\";","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","// src/lib/bibtex.ts\n// Use require to avoid ESM/CJS interop issues\n// eslint-disable-next-line @typescript-eslint/no-var-requires\nconst bib = require(\"bibtex-parse-js\");\n\nexport type BibEntry = {\n  id: string;\n  type: string;\n  fields: Record<string, string>;\n  createdAt: string;\n  notes?: { where?: string; text?: string }[];\n};\n\nexport function parseBibtex(raw: string): BibEntry[] {\n  const text = (raw || \"\").trim();\n  if (!text) return [];\n  const parsed = bib.toJSON(text) || [];\n  return parsed.map((it: any) => ({\n    id: it.citationKey || it.entryTags?.citationKey || cryptoId(),\n    type: it.entryType,\n    fields: it.entryTags || {},\n    createdAt: new Date().toISOString(),\n  }));\n}\n\nfunction cryptoId() {\n  return \"id_\" + Math.random().toString(36).slice(2, 9);\n}","/// <reference types=\"office-js\" />\n\nfunction getStore() {\n  const or = (globalThis as any).OfficeRuntime;\n  const storage = or?.storage;\n  if (storage) return storage;\n  // Fallback for normal browsers\n  return {\n    async getItem(k: string) { return localStorage.getItem(k); },\n    async setItem(k: string, v: string) { localStorage.setItem(k, v); },\n    async removeItem(k: string) { localStorage.removeItem(k); },\n  };\n}\n\nconst LIB_KEY = \"wordref.library\";\nconst ORDER_KEY = \"wordref.citedOrder\";\n\nexport async function getLibrary(): Promise<Record<string, any>> {\n  const raw = await getStore().getItem(LIB_KEY);\n  return raw ? JSON.parse(raw) : {};\n}\nexport async function saveLibrary(lib: Record<string, any>) {\n  await getStore().setItem(LIB_KEY, JSON.stringify(lib));\n}\nexport async function upsertEntry(entry: any) {\n  const lib = await getLibrary();\n  lib[entry.id] = { ...(lib[entry.id] || {}), ...entry };\n  await saveLibrary(lib);\n}\nexport async function getCitedOrder(): Promise<string[]> {\n  const raw = await getStore().getItem(ORDER_KEY);\n  return raw ? JSON.parse(raw) : [];\n}\nexport async function setCitedOrder(ids: string[]) {\n  await getStore().setItem(ORDER_KEY, JSON.stringify(ids));\n}\nexport async function markCited(id: string) {\n  const order = await getCitedOrder();\n  if (!order.includes(id)) {\n    order.push(id);\n    await setCitedOrder(order);\n  }\n}\nexport async function clearCitedOrder() {\n  await getStore().removeItem(ORDER_KEY);\n}\nexport async function clearLibrary() {\n  await getStore().removeItem(LIB_KEY);\n}","/// <reference types=\"office-js\" />\nimport type { BibEntry } from \"./bibtex\";\n\n/* ======================= types ======================= */\n\n\n/* ======================= helpers ======================= */\n\nfunction normalizeStyle(style?: string): string {\n  return (style || \"apa\").toLowerCase();\n}\nfunction firstAuthorSurname(e: BibEntry): string {\n  const a = e.fields.author || e.fields.editor || \"Anon\";\n  return a.split(\" and \")[0].split(\",\")[0].trim();\n}\nfunction isNumericStyle(sty: string) {\n  sty = normalizeStyle(sty);\n  return sty === \"ieee\" || sty === \"numeric\" || sty === \"vancouver\" || sty === \"acs\";\n}\n\nasync function ensureSelectionAtEnd(): Promise<void> {\n  await Word.run(async (ctx) => {\n    const end = ctx.document.body.getRange(\"End\");\n    end.select();\n    await ctx.sync();\n  });\n}\n\n/* ================= in-text formatting ================= */\n\nexport function formatInText(e: BibEntry, style: string, index: number): string {\n  const sty = normalizeStyle(style);\n  const author = firstAuthorSurname(e);\n  const year = e.fields.year || \"n.d.\";\n\n  if (isNumericStyle(sty)) return `[${index}]`;\n  // authoryear styles\n  return `(${author}, ${year})`;\n}\n\n/* =============== bibliography formatting =============== */\n\nexport function formatBibliographyEntry(e: BibEntry, style: string, index: number): string {\n  const sty = normalizeStyle(style);\n  const a = e.fields.author || e.fields.editor || \"Anon\";\n  const y = e.fields.year || \"n.d.\";\n  const t = e.fields.title || \"\";\n  const j = e.fields.journal || e.fields.booktitle || \"\";\n  const v = e.fields.volume ? `${e.fields.volume}` : \"\";\n  const n = e.fields.number ? `(${e.fields.number})` : \"\";\n  const p = e.fields.pages ? `, ${e.fields.pages}` : \"\";\n  const doi = e.fields.doi ? ` https://doi.org/${e.fields.doi}` : \"\";\n\n  switch (sty) {\n    case \"ieee\":\n    case \"numeric\":\n      return `[${index}] ${a}. ${t}, ${j} ${v}${n}${p}, ${y}.${doi}`;\n    case \"vancouver\":\n      return `${index}. ${a}. ${t}. ${j} ${y}${v ? `;${v}` : \"\"}${n ? `(${n})` : \"\"}${p ? `:${p.replace(\", \", \"-\").replace(/^, /, \"\")}` : \"\"}.`;\n    case \"harvard\":\n      return `${a}, ${y}. ${t}. ${j}${v ? `, ${v}` : \"\"}${n ? ` ${n}` : \"\"}${p}.`;\n    case \"acs\":\n      return `${a}. ${t}. ${j} ${y}${v ? `, ${v}` : \"\"}${n ? ` ${n}` : \"\"}${p}.`;\n    case \"apa\":\n    default:\n      return `${a} (${y}). ${t}. ${j}${v ? `, ${v}` : \"\"}${n ? ` ${n}` : \"\"}${p}.${doi}`;\n  }\n}\n\n/* ============== heading + bibliography block ============== */\n\n// replaces the old ensureReferencesHeading()\nfunction ensureReferencesHeadingInContext(ctx: Word.RequestContext): Promise<Word.Paragraph> {\n  return new Promise(async (resolve) => {\n    const body = ctx.document.body;\n    const paras = body.paragraphs;\n    paras.load(\"items,text\");\n    await ctx.sync();\n\n    let heading = paras.items.find(p => p.text.trim().toLowerCase() === \"references\");\n    if (!heading) {\n      heading = body.insertParagraph(\"References\", Word.InsertLocation.end);\n      heading.styleBuiltIn = Word.BuiltInStyleName.heading1;\n      body.insertParagraph(\"\", Word.InsertLocation.end);\n      await ctx.sync();\n    }\n    resolve(heading!);\n  });\n}\n\n/**\n * Build/replace the bibliography *per entry paragraph*, each wrapped in its own CC:\n *  - Deletes any old WordRef bibliography CCs (legacy block + per-entry) to avoid duplicates.\n *  - Inserts new entries directly after the \"References\" heading.\n *  - Applies best-effort formatting (font, size, alignment, line spacing).\n */\n// cite.ts\nexport type BibFormatOptions = {\n  fontName?: string;\n  fontSize?: number;      // pt\n  lineSpacing?: number;   // pt (best-effort)\n  alignment?: Word.Alignment; // \"Left\" | \"Right\" | \"Centered\" | \"Justified\"\n  color?: string;         // CSS color name or hex like \"#333333\"\n};\n\n// Helper: create/find the single bibliography CC after the References heading\nasync function getOrCreateBibCC(ctx: Word.RequestContext, heading: Word.Paragraph): Promise<Word.ContentControl> {\n  const existing = ctx.document.contentControls.getByTag(\"wordref-bibliography\");\n  existing.load(\"items\");\n  await ctx.sync();\n\n  if (existing.items.length > 0) return existing.items[0];\n\n  const afterHeading = heading.getRange(\"End\");\n  const p = afterHeading.insertParagraph(\"\", Word.InsertLocation.after);\n  const cc = p.insertContentControl();\n  cc.tag = \"wordref-bibliography\";\n  cc.title = \"WordRef Bibliography\";\n  return cc;\n}\n\nexport async function updateBibliography(\n  entries: BibEntry[],\n  style: string = \"apa\",\n  opts?: BibFormatOptions\n): Promise<void> {\n  // de-dup + sort for author-year styles\n  const seen = new Set<string>();\n  let list = entries.filter(e => !seen.has(e.id) && (seen.add(e.id), true));\n  if ([\"apa\", \"harvard\", \"mla\"].includes((style || \"apa\").toLowerCase())) {\n    list = [...list].sort((a, b) => (a.fields.author || \"\").localeCompare(b.fields.author || \"\"));\n  }\n\n  await Word.run(async (ctx) => {\n    // ensure heading, then one CC\n    const heading = await (async () => {\n      const body = ctx.document.body;\n      const paras = body.paragraphs;\n      paras.load(\"items,text\");\n      await ctx.sync();\n      let h = paras.items.find(p => p.text.trim().toLowerCase() === \"references\");\n      if (!h) {\n        h = body.insertParagraph(\"References\", Word.InsertLocation.end);\n        h.styleBuiltIn = Word.BuiltInStyleName.heading1;\n        body.insertParagraph(\"\", Word.InsertLocation.end);\n        await ctx.sync();\n      }\n      return h!;\n    })();\n\n    const bibCC = await getOrCreateBibCC(ctx, heading);\n\n    // Build full text once\n    const lines = list.map((e, i) => formatBibliographyEntry(e, style, i + 1));\n    const bibText = lines.join(\"\\n\");\n\n    // Replace the whole CC with fresh text (one write)\n    bibCC.insertText(bibText, Word.InsertLocation.replace);\n    await ctx.sync();\n\n    // Apply formatting to paragraphs inside the CC\n    try {\n      const rng = bibCC.getRange();\n      const paras = rng.paragraphs;\n      paras.load(\"items/font\");\n      await ctx.sync();\n\n      for (const p of paras.items) {\n        if (opts?.fontName) p.font.name = opts.fontName;\n        if (opts?.fontSize) p.font.size = opts.fontSize;\n        if (opts?.color)    p.font.color = opts.color;        // NEW: color\n        if (opts?.alignment) (p as any).alignment = opts.alignment;\n        if (opts?.lineSpacing) (p as any).lineSpacing = opts.lineSpacing; // best-effort\n      }\n    } catch {\n      // ignore if host doesnt expose these setters\n    }\n\n    await ctx.sync();\n  });\n}\n\n/* =================== scan & re-render =================== */\n\n/** Return cited IDs in reading order based on content controls tagged \"wordref-cite:<id>\" */\nexport async function scanCitationsInDoc(): Promise<string[]> {\n  return await Word.run(async (ctx) => {\n    const controls = ctx.document.contentControls;\n    controls.load(\"items/tag\");\n    await ctx.sync();\n\n    const ids: string[] = [];\n    for (const cc of controls.items) {\n      const tag = (cc.tag || \"\");\n      if (tag.startsWith(\"wordref-cite:\")) {\n        const id = tag.split(\":\")[1];\n        if (id) ids.push(id);\n      }\n    }\n    return ids;\n  });\n}\n\nexport async function rerenderAllCitations(style: string, order: string[], lib: Record<string, BibEntry>) {\n  await Word.run(async (ctx) => {\n    const controls = ctx.document.contentControls;\n    controls.load(\"items/tag\");\n    await ctx.sync();\n\n    const items = controls.items.filter(cc => (cc.tag || \"\").startsWith(\"wordref-cite:\"));\n    for (const cc of items) {\n      const id = (cc.tag || \"\").split(\":\")[1];\n      const e = lib[id];\n      if (!e) continue;\n\n      const idx = Math.max(0, order.indexOf(id)) + 1;\n      const newText = formatInText(e, style, idx);\n      cc.insertText(newText, Word.InsertLocation.replace);\n    }\n    await ctx.sync();\n  });\n}\n\n/* ================== grouping for numeric ================== */\n\nfunction parseBracketIndices(text: string): number[] {\n  // Accept \"[2]\", \"[2, 3-5]\" / \"[2][3]\"  well normalize later\n  const inside = text.match(/\\[(.*?)\\]/g);\n  const bag: number[] = [];\n  if (!inside) return bag;\n  for (const block of inside) {\n    const s = block.replace(/^\\[|\\]$/g, \"\");\n    for (const part of s.split(\",\").map(t => t.trim()).filter(Boolean)) {\n      if (/^\\d+$/.test(part)) {\n        bag.push(parseInt(part, 10));\n      } else if (/^\\d+\\s*-\\s*\\d+$/.test(part)) {\n        const [a, b] = part.split(\"-\").map(x => parseInt(x.trim(), 10));\n        for (let i = Math.min(a, b); i <= Math.max(a, b); i++) bag.push(i);\n      }\n    }\n  }\n  return bag;\n}\n\nfunction formatCitationGroup(indices: number[]): string {\n  const arr = Array.from(new Set(indices)).sort((a, b) => a - b);\n  if (!arr.length) return \"[]\";\n  const out: string[] = [];\n  let start = arr[0], prev = arr[0];\n\n  for (let i = 1; i <= arr.length; i++) {\n    const cur = arr[i];\n    if (cur === prev + 1) { prev = cur; continue; }\n    if (start === prev) out.push(`${start}`);\n    else if (prev === start + 1) out.push(`${start}`, `${prev}`);\n    else out.push(`${start}-${prev}`);\n    start = cur ?? NaN;\n    prev = cur ?? NaN;\n  }\n  return `[${out.join(\", \")}]`;\n}\n\nexport async function mergeAdjacentCitationsInParagraph() {\n  await Word.run(async (ctx) => {\n    const sel = ctx.document.getSelection();\n    const para = sel.paragraphs.getFirst();\n    para.load(\"contentControls/items/tag\");\n    await ctx.sync();\n\n    // Collect contiguous runs of our cite CCs\n    const items = para.contentControls.items;\n    let i = 0;\n    while (i < items.length) {\n      // start a group if this is a wordref-cite\n      const group: Word.ContentControl[] = [];\n      while (i < items.length && (items[i].tag || \"\").startsWith(\"wordref-cite:\")) {\n        group.push(items[i]);\n        i++;\n      }\n\n      if (group.length > 1) {\n        // Load text of all CCs in the group\n        group.forEach(cc => cc.getRange().load(\"text\"));\n        await ctx.sync();\n\n        // Parse/merge numbers from each CC\n        const allNums: number[] = [];\n        for (const cc of group) {\n          const txt = cc.getRange().text || \"\";\n          allNums.push(...parseBracketIndices(txt));\n        }\n        const merged = formatCitationGroup(allNums);\n\n        // Replace text in the FIRST CC, delete the rest\n        group[0].insertText(merged, Word.InsertLocation.replace);\n        for (let k = 1; k < group.length; k++) {\n          // delete control + its contents so duplicates dont remain\n          group[k].delete(false);\n        }\n        await ctx.sync();\n      }\n\n      // Skip non-citation CC or advance\n      while (i < items.length && !(items[i].tag || \"\").startsWith(\"wordref-cite:\")) {\n        i++;\n      }\n    }\n  });\n}\n/* ============== insert citation (with merge) ============== */\n\n/**\n * Insert citation at selection. For numeric styles, if the user inserts\n * *inside* an existing WordRef citation CC, we merge indices into one bracket\n * e.g. `[2]` + `[3,4]`  `[2, 34]`. For authoryear styles we just replace text.\n */\n// cite.ts\n// cite.ts (replace the whole function)\nexport async function insertCitationControl(\n  e: BibEntry,\n  text: string,\n  style?: string,\n  index?: number\n) {\n  const sty = (style || \"apa\").toLowerCase();\n  const isNumeric = [\"ieee\", \"numeric\", \"vancouver\", \"acs\"].includes(sty);\n\n  const dbg = (window as any).__WORDREF_DEBUG__ || {};\n  const FORCE_APPEND_END   = !!dbg.FORCE_APPEND_END;\n  const NO_CC_FALLBACK     = dbg.NO_CONTENT_CONTROL_FALLBACK !== false;\n  const SAFE_MODE_NO_MERGE = !!dbg.SAFE_MODE_NO_MERGE;\n\n  const setSelectedTextAsync = (t: string) =>\n    new Promise<boolean>((resolve) => {\n      Office.context.document.setSelectedDataAsync(\n        t,\n        { coercionType: Office.CoercionType.Text },\n        (res) => resolve(res.status === Office.AsyncResultStatus.Succeeded)\n      );\n    });\n\n  return Word.run(async (ctx) => {\n    const body = ctx.document.body;\n\n    if (FORCE_APPEND_END) {\n      const p = body.insertParagraph(\"\", Word.InsertLocation.end);\n      const r = p.getRange(\"Start\");\n      r.insertText(text, Word.InsertLocation.replace);\n      await ctx.sync();\n      return;\n    }\n\n    const sel = ctx.document.getSelection();\n    sel.load(\"text,parentContentControl,paragraphs\");\n    await ctx.sync();\n\n    // 1) INSIDE a WordRef cite  merge\n    if (!SAFE_MODE_NO_MERGE) {\n      const parent = sel.parentContentControl;\n      if (\n        parent && !parent.isNullObject &&\n        (parent.tag || \"\").startsWith(\"wordref-cite:\") &&\n        isNumeric && typeof index === \"number\"\n      ) {\n        const r = parent.getRange();\n        r.load(\"text\");\n        await ctx.sync();\n        const nums = parseBracketIndices(r.text);\n        nums.push(index);\n        parent.insertText(formatCitationGroup(nums), Word.InsertLocation.replace);\n        await ctx.sync();\n        return;\n      }\n    }\n\n    // 2) JUST AFTER a WordRef cite in same paragraph  snap back and merge\n    if (!SAFE_MODE_NO_MERGE && isNumeric && typeof index === \"number\") {\n      try {\n        const para = sel.paragraphs.getFirst();\n        para.load(\"text\");\n        await ctx.sync();\n\n        // find last WordRef cite CC whose end touches selection\n        const candidate = await (async () => {\n          const all = ctx.document.contentControls;\n          all.load(\"items/tag\");\n          await ctx.sync();\n          const items = all.items.filter(cc => (cc.tag || \"\").startsWith(\"wordref-cite:\"));\n          for (const cc of items) {\n            const rr = cc.getRange();\n            rr.load(\"text\");\n            await ctx.sync();\n            // compare end-of-CC to selection start\n            const end = rr.getRange(\"End\");\n            const cmp = end.compareLocationWith(sel);\n            // cmp === \"Equal\" means selection is at the same point; \"After\" means caret is after end\n            if (cmp.value === \"Equal\") return cc;\n          }\n          return null;\n        })();\n\n        if (candidate) {\n          const r = candidate.getRange();\n          r.load(\"text\");\n          await ctx.sync();\n          const nums = parseBracketIndices(r.text);\n          nums.push(index);\n          candidate.insertText(formatCitationGroup(nums), Word.InsertLocation.replace);\n          await ctx.sync();\n          return;\n        }\n      } catch {\n        // ignore, fall through\n      }\n    }\n\n    // helper to try CC, then plain text fallback\n    const tryCreateCC = async (range: Word.Range) => {\n      try {\n        const cc = range.insertContentControl();\n        cc.tag = `wordref-cite:${e.id}`;\n        cc.title = \"WordRef Citation\";\n        cc.appearance = \"BoundingBox\";\n        cc.insertText(text, Word.InsertLocation.replace);\n        await ctx.sync();\n        return true;\n      } catch {\n        if (NO_CC_FALLBACK) {\n          const ok = await setSelectedTextAsync(text);\n          if (ok) return true;\n        }\n        return false;\n      }\n    };\n\n    // 3) Try at selection\n    if (await tryCreateCC(sel)) return;\n\n    // 4) If inside a foreign CC, insert after paragraph\n    try {\n      const parent = sel.parentContentControl;\n      if (parent && !parent.isNullObject && !(parent.tag || \"\").startsWith(\"wordref-cite:\")) {\n        const para = sel.paragraphs.getFirst();\n        const afterPara = para.getRange(\"End\").insertParagraph(\"\", Word.InsertLocation.after);\n        const r = afterPara.getRange(\"Start\");\n        if (await tryCreateCC(r)) return;\n      }\n    } catch { /* ignore */ }\n\n    // 5) Common API try again\n    if (await setSelectedTextAsync(text)) return;\n\n    // 6) Append at doc end\n    const p = body.insertParagraph(\"\", Word.InsertLocation.end);\n    const r = p.getRange(\"Start\");\n    if (!(await tryCreateCC(r))) {\n      r.insertText(text, Word.InsertLocation.replace);\n      await ctx.sync();\n    }\n  });\n}","\n\n\n/// <reference types=\"office-js\" />\n\nimport * as Bib from \"../lib/bibtex\";\nimport {\n  getLibrary,\n  upsertEntry,\n  getCitedOrder,\n  setCitedOrder,\n  markCited,\n  clearCitedOrder,\n  clearLibrary,\n} from \"../lib/storage\";\nimport type { BibFormatOptions } from \"../lib/cite\";\nimport * as Cite from \"../lib/cite\";\n\nconst DEBUG_SIMPLE_INSERT = true;\nconst {\n  formatInText,\n  insertCitationControl,\n  updateBibliography,\n  scanCitationsInDoc,\n  rerenderAllCitations,\n} = Cite;\n\nconst GROUP_PREFIX = \"wordref-group:\";\nconst GROUP_TITLE  = \"WordRef Citation (Group)\";\n/* ============= Types & helpers ============= */\n\ntype BibEntry = Bib.BibEntry;\ntype CsvRow = Record<string, string>;\n\nconst $ = <T extends HTMLElement = HTMLElement>(id: string) =>\n  document.getElementById(id) as T | null;\n\nconst getStyle = () =>\n  (($(\"styleSelect\") as HTMLSelectElement | null)?.value || \"apa\").toLowerCase();\n\nfunction show(id: string) { document.getElementById(id)?.classList.remove(\"hidden\"); }\nfunction hide(id: string) { document.getElementById(id)?.classList.add(\"hidden\"); }\n\nfunction normalizeAlignment(v: string): Word.Alignment {\n  switch ((v || \"\").toLowerCase()) {\n    case \"center\":\n    case \"centered\":\n      return Word.Alignment.centered;\n    case \"right\":\n      return Word.Alignment.right;\n    case \"justify\":\n    case \"justified\":\n      return Word.Alignment.justified;\n    case \"left\":\n    default:\n      return Word.Alignment.left;\n  }\n}\n\nfunction getBibFormatOpts(): BibFormatOptions {\n  const fontName = (document.getElementById(\"bibFont\") as HTMLSelectElement)?.value || \"Times New Roman\";\n  const fontSize = parseInt((document.getElementById(\"bibSize\") as HTMLInputElement)?.value || \"12\", 10);\n  const lineSpacing = parseInt((document.getElementById(\"bibSpacing\") as HTMLInputElement)?.value || \"14\", 10);\n  const alignRaw = (document.getElementById(\"bibAlign\") as HTMLSelectElement)?.value || \"Left\";\n  const color = (document.getElementById(\"bibColor\") as HTMLInputElement)?.value || \"#333333\";\n  const alignment = normalizeAlignment(alignRaw);\n  return { fontName, fontSize, lineSpacing, alignment, color };\n}\n\nconst nowIso = () => new Date().toISOString();\nfunction normalizeEntry(e: Partial<BibEntry>): BibEntry {\n  if (!e || !e.id) throw new Error(\"normalizeEntry: missing id\");\n  return {\n    id: String(e.id),\n    type: (e.type as any) || \"misc\",\n    fields: e.fields || {},\n    notes: e.notes || [],\n    createdAt: e.createdAt ?? nowIso(),\n  };\n}\n\n/** Return array with first-appearance ordering (stable unique). */\nfunction uniqueInOrder(ids: string[]): string[] {\n  const seen = new Set<string>();\n  const out: string[] = [];\n  for (const id of ids) {\n    if (!seen.has(id)) { seen.add(id); out.push(id); }\n  }\n  return out;\n}\n\n/* ============= Renumbering & merge helpers ============= */\n\n/** Re-scan doc order  save order  rerender all in-text  rebuild bibliography. */\n/** Re-scan (singles + groups)  save order  rerender singles  rebuild bibliography. */\n/** Re-scan doc order  save order  rerender all in-text  rebuild bibliography. */\nasync function refreshNumbersAndBibliography(): Promise<void> {\n  const style = getStyle();\n  const lib   = await getLibrary();\n\n  // 1) Get IDs in true document order (singles + groups expanded)\n  const idsInDoc   = await getAllCitationIdsInDoc(); // e.g., [\"A\",\"B\",\"B\",\"C\",\"A\",...]\n  const uniqueOrder = uniqueInOrder(idsInDoc);       // [\"A\",\"B\",\"C\",...]\n\n  // 2) Store first-appearance order\n  await setCitedOrder(uniqueOrder);\n\n  // 3) Re-render every in-text citation using the unique order for indices\n  await rerenderAllCitations(style, uniqueOrder, lib);\n\n  // 4) Bibliography = unique cited entries in that order\n  const cited = uniqueOrder\n    .map(id => lib[id])\n    .filter(Boolean);\n\n  await updateBibliography(cited, style, getBibFormatOpts());\n  await refreshCitedBibtexPanel();\n}\n\nlet opInFlight = false;\nasync function safeRefreshAll(): Promise<void> {\n  if (opInFlight) return;\n  opInFlight = true;\n  try {\n    await refreshNumbersAndBibliography();\n    await rerenderGroupCitations(getStyle());\n  } finally {\n    opInFlight = false;\n  }\n}\n\n/** Compress consecutive numbers: [1,2,3,5,6,9] -> \"13,56,9\" */\nfunction compressNumericList(nums: number[]): string {\n  if (!nums.length) return \"\";\n  const out: string[] = [];\n  let start = nums[0], prev = nums[0];\n  for (let i = 1; i < nums.length; i++) {\n    const n = nums[i];\n    if (n === prev + 1) { prev = n; continue; }\n    out.push(start === prev ? String(start) : `${start}${prev}`);\n    start = prev = n;\n  }\n  out.push(start === prev ? String(start) : `${start}${prev}`);\n  return out.join(\",\");\n}\n\n/** Scan both single and group WordRef CCs in true document order (may include duplicates). */\nasync function scanCitationsEverywhere(): Promise<string[]> {\n  let result: string[] = [];\n\n  await Word.run(async (ctx) => {\n    type Item = { ids: string[]; start: Word.Range };\n    const items: Item[] = [];\n\n    // Singles\n    const singles = ctx.document.contentControls.getByTitle(\"WordRef Citation\");\n    singles.load(\"items/tag,items/id\");\n    // Groups\n    const groups = ctx.document.contentControls.getByTitle(GROUP_TITLE);\n    groups.load(\"items/tag,items/id\");\n\n    await ctx.sync();\n\n    for (const cc of singles.items) {\n      const tag = cc.tag || \"\";\n      if (!tag.startsWith(\"wordref-cite:\")) continue;\n      const id = tag.slice(\"wordref-cite:\".length).trim();\n      if (!id) continue;\n      items.push({ ids: [id], start: cc.getRange(\"Start\") });\n    }\n\n    for (const cc of groups.items) {\n      const tag = cc.tag || \"\";\n      if (!tag.startsWith(GROUP_PREFIX)) continue;\n      const ids = tag.slice(GROUP_PREFIX.length)\n        .split(\",\")\n        .map(s => s.trim())\n        .filter(Boolean);\n      if (!ids.length) continue;\n      items.push({ ids, start: cc.getRange(\"Start\") });\n    }\n\n    // Stable sort by position in the document\n    const sorted: Item[] = [];\n    for (const it of items) {\n      let placed = false;\n      for (let i = 0; i < sorted.length; i++) {\n        const rel = it.start.compareLocationWith(sorted[i].start);\n        await ctx.sync();\n        if (rel.value === Word.LocationRelation.before) {\n          sorted.splice(i, 0, it);\n          placed = true;\n          break;\n        }\n      }\n      if (!placed) sorted.push(it);\n    }\n\n    // Flatten in order; duplicates allowed (well uniq later)\n    result = sorted.flatMap(it => it.ids);\n  });\n\n  return result;\n}\n/**\n * Merge adjacent WordRef citation content controls per paragraph.\n * Numeric styles  [24,6]; Text styles  (Smith, 2019; Lee & Kim, 2020).\n */\nasync function mergeAdjacentCitationsInParagraph(): Promise<void> {\n  const style = getStyle();\n  const numericLike = [\"ieee\", \"numeric\", \"vancouver\", \"acs\"].includes(style);\n\n  await Word.run(async (ctx) => {\n    const doc = ctx.document;\n\n    const allCcs = doc.contentControls.getByTitle(\"WordRef Citation\");\n    allCcs.load(\"items/tag,items/id,items/paragraphs\");\n    await ctx.sync();\n\n    type CcInfo = { cc: Word.ContentControl; id: number; tag: string; paraKey: string; start: Word.Range };\n    const perParagraph: Record<string, CcInfo[]> = {};\n\n    for (const cc of allCcs.items) {\n      const tag = (cc.tag || \"\");\n      if (!tag.startsWith(\"wordref-cite:\")) continue;\n\n      const start = cc.getRange(\"Start\");\n      const para = cc.paragraphs.getFirst();\n      const oox = para.getRange().getOoxml();\n      await ctx.sync(); // resolves ClientResult<string>\n\n      const paraKey = oox.value || `para-${Math.random().toString(36).slice(2)}`;\n      (perParagraph[paraKey] ||= []).push({ cc, id: cc.id, tag, paraKey, start });\n    }\n\n    // For each paragraph, sort by location and merge\n    for (const group of Object.values(perParagraph)) {\n      const sorted: CcInfo[] = [];\n\n      for (const it of group) {\n        let inserted = false;\n        for (let i = 0; i < sorted.length; i++) {\n          const cmp = it.start.compareLocationWith(sorted[i].start);\n          await ctx.sync(); // resolves ClientResult<LocationRelation>\n          if (cmp.value === Word.LocationRelation.before) {\n            sorted.splice(i, 0, it);\n            inserted = true;\n            break;\n          }\n        }\n        if (!inserted) sorted.push(it);\n      }\n\n      if (sorted.length < 2) continue;\n\n      const run = sorted;\n      const ids = run.map(({ tag }) => tag.replace(\"wordref-cite:\", \"\"));\n      const order = await getCitedOrder();\n\n      if (numericLike) {\n        const numbers = ids\n          .map((id) => order.indexOf(id) + 1)\n          .filter((n) => n > 0)\n          .sort((a, b) => a - b);\n        const combined = `[${compressNumericList(numbers)}]`;\n\n        const first = run[0].cc;\n        first.insertText(combined, Word.InsertLocation.replace);\n        for (let i = 1; i < run.length; i++) run[i].cc.delete(false);\n      } else {\n        const lib = await getLibrary();\n        const pieces: string[] = [];\n        for (const id of ids) {\n          const e = (lib as any)[id];\n          if (!e) continue;\n          const idx = order.indexOf(id) + 1;\n          pieces.push(formatInText(e, style, idx));\n        }\n        const stripped = pieces.map((p) => p.replace(/^[(\\[]\\s*|\\s*[)\\]]$/g, \"\"));\n        const combined = `(${stripped.join(\"; \")})`;\n\n        const first = run[0].cc;\n        first.insertText(combined, Word.InsertLocation.replace);\n        for (let i = 1; i < run.length; i++) run[i].cc.delete(false);\n      }\n    }\n\n    await ctx.sync();\n  });\n}\n\n// ====== Global error diagnostics and safe wrappers ======\ntry {\n  OfficeExtension.config.extendedErrorLogging = true;\n} catch {}\n\n// Log all unhandled rejections / runtime errors for debugging\nwindow.addEventListener(\"unhandledrejection\", (e) => {\n  const err = e.reason as any;\n  const dbg = err?.debugInfo ? ` [${err.debugInfo.code || \"\"} @ ${err.debugInfo.errorLocation || \"\"}]` : \"\";\n  console.error(\"Unhandled rejection:\", err, err?.debugInfo);\n  try { showToast(\"Unexpected error: \" + (err?.message || String(err)) + dbg); } catch {}\n});\n\nwindow.addEventListener(\"error\", (e) => {\n  const err = e.error as any;\n  const dbg = err?.debugInfo ? ` [${err.debugInfo.code || \"\"} @ ${err.debugInfo.errorLocation || \"\"}]` : \"\";\n  console.error(\"Window error:\", err, err?.debugInfo);\n  try { showToast(\"Unexpected error: \" + (err?.message || String(err)) + dbg); } catch {}\n});\n\n/** Wrapper to safely run async Word operations */\nasync function guard<T>(label: string, fn: () => Promise<T>): Promise<T | undefined> {\n  try {\n    return await fn();\n  } catch (err: any) {\n    const dbg = err?.debugInfo ? ` [${err.debugInfo.code || \"\"} @ ${err.debugInfo.errorLocation || \"\"}]` : \"\";\n    console.error(`[WordRef] ${label} failed:`, err, err?.debugInfo);\n    showToast(`${label} failed: ${(err?.message || String(err))}${dbg}`);\n    return undefined;\n  }\n}\n/* ============= UI boot ============= */\n\nOffice.onReady(async () => {\n  $(\"btnAddOnly\")?.addEventListener(\"click\", onAddOnly);\n  $(\"btnAddCite\")?.addEventListener(\"click\", onAddAndCite);\n  $(\"btnInsertCite\")?.addEventListener(\"click\", onInsertOnly);\n  $(\"btnUpdateBib\")?.addEventListener(\"click\", onUpdateBib);\n  $(\"btnResetNumbering\")?.addEventListener(\"click\", onResetNumbering);\n  $(\"btnClearLibrary\")?.addEventListener(\"click\", onClearLibraryClick);\n  $(\"btnReload\")?.addEventListener(\"click\", () => {\n    void guard(\"Reload UI\", async () => {\n      // Clear main input + note fields\n      const bibbox = document.getElementById(\"bibtexInput\") as HTMLTextAreaElement | null;\n      if (bibbox) bibbox.value = \"\";\n  \n      const np = document.getElementById(\"notePage\") as HTMLInputElement | null;\n      if (np) np.value = \"\";\n  \n      const nt = document.getElementById(\"noteText\") as HTMLInputElement | null;\n      if (nt) nt.value = \"\";\n  \n      // Reset search box\n      const search = document.getElementById(\"search\") as HTMLInputElement | null;\n      if (search) search.value = \"\";\n  \n      // Repaint list + cited BibTeX + style badge\n      await refreshResults(\"\");\n      await refreshCitedBibtexPanel();\n      updateStyleBadge();\n  \n      showToast(\"WordRef panel reloaded.\");\n    });\n  });\n  // Open panels\n$(\"btnOpenLibPanel\")?.addEventListener(\"click\", async () => {\n  show(\"citedLibPanel\");\n  await refreshCitedBibtexPanel(); // always current\n});\n\n$(\"btnOpenImportPanel\")?.addEventListener(\"click\", () => {\n  (document.getElementById(\"importBibtexBox\") as HTMLTextAreaElement).value = \"\";\n  show(\"importLibPanel\");\n});\n\n// Cited panel actions\n$(\"btnCitedClose\")?.addEventListener(\"click\", () => hide(\"citedLibPanel\"));\n$(\"btnCitedRefresh\")?.addEventListener(\"click\", () => { void refreshCitedBibtexPanel(); });\n$(\"btnCitedCopy\")?.addEventListener(\"click\", copyCitedBibtexToClipboard);\n\n// Import panel actions\n$(\"btnImportClose\")?.addEventListener(\"click\", () => hide(\"importLibPanel\"));\n$(\"btnImportParse\")?.addEventListener(\"click\", () => { void onImportBibtexPasted(); });\n\n// ensure panel shows correct content on first open\nawait refreshCitedBibtexPanel();\n\n  // Export / Import\n  document.getElementById(\"btnExport\")?.addEventListener(\"click\", async () => {\n    try {\n      await onExportLibrary();\n      setIoStatus(platformDownloadHint());\n    } catch (e) {\n      setIoStatus(\"Export failed. See console.\", 5000);\n      console.error(e);\n    }\n  });\n  document.getElementById(\"btnImport\")?.addEventListener(\"click\", () => {\n    (document.getElementById(\"importFile\") as HTMLInputElement)?.click();\n  });\n  (document.getElementById(\"importFile\") as HTMLInputElement)\n    ?.addEventListener(\"change\", (ev) => { void onImportFilePicked(ev); });\n\n  // Help modal\n  document.getElementById(\"helpIcon\")?.addEventListener(\"click\", () => {\n    document.getElementById(\"instructionsModal\")?.classList.add(\"show\");\n  });\n  document.getElementById(\"helpText\")?.addEventListener(\"click\", () => {\n    document.getElementById(\"instructionsModal\")?.classList.add(\"show\");\n  });\n  document.getElementById(\"closeInstructions\")?.addEventListener(\"click\", () => {\n    document.getElementById(\"instructionsModal\")?.classList.remove(\"show\");\n  });\n\n  document.getElementById(\"btnMergeSelected\")\n  ?.addEventListener(\"click\", () => { void onMergeSelectedCitations(); });\n\n  document.getElementById(\"btnUnmergeSelected\")\n    ?.addEventListener(\"click\", () => { void onUnmergeSelectedCitation(); });\n\n  // Live color swatch\n  const fontColorInput = document.getElementById(\"bibColor\") as HTMLInputElement;\n  fontColorInput?.addEventListener(\"input\", () => {\n    fontColorInput.style.backgroundColor = fontColorInput.value;\n  });\n  const openImportModal = () => {\n    document.getElementById(\"importModal\")?.classList.remove(\"hidden\");\n    document.body.classList.add(\"body-no-scroll\");\n  };\n  const closeImportModal = () => {\n    document.getElementById(\"importModal\")?.classList.add(\"hidden\");\n    document.body.classList.remove(\"body-no-scroll\");\n  };\n  \n  document.getElementById(\"btnOpenImportPanel\")?.addEventListener(\"click\", () => {\n    // dont overlap with the sheet\n    document.getElementById(\"citedLibPanel\")?.classList.add(\"hidden\");\n    const box = document.getElementById(\"importBibtexBox\");\n    if (box) (box as HTMLTextAreaElement).value = \"\";\n    openImportModal();\n  });\n  document.getElementById(\"btnImportClose\")?.addEventListener(\"click\", closeImportModal);\n  document.getElementById(\"importBackdrop\")?.addEventListener(\"click\", closeImportModal);\n  \n  // When user confirms:\n  document.getElementById(\"btnImportParse\")?.addEventListener(\"click\", async () => {\n    await onImportBibtexPasted(); // your existing parser that calls upsertEntry(...)\n    closeImportModal();\n  });\n  // Search\n  const search = $(\"search\") as HTMLInputElement | null;\n  search?.addEventListener(\"input\", async () => {\n    const q = search.value;\n    if (isLikelyBibtex(q)) {\n      const match = await findExistingFromBibtex(q);\n      await refreshResults(\"\"); // show all for highlight\n      if (match?.id) {\n        const container = document.getElementById(\"results\")!;\n        flashResultRow(container, match.id);\n        const reasonMsg = match.reason === \"citationKey\" ? \"citation key\" : match.reason.toUpperCase();\n        showToast(`Already in your library (matched by ${reasonMsg}).`);\n        return;\n      }\n    }\n    await refreshResults(q);\n    await refreshCitedBibtexPanel();\n  });\n\n  // Style badge + on change\n  updateStyleBadge();\n  (document.getElementById(\"styleSelect\") as HTMLSelectElement | null)\n    ?.addEventListener(\"change\", onStyleChanged);\n\n  Office.context.document.addHandlerAsync(\n    Office.EventType.DocumentSelectionChanged,\n    () => { void onSelectionChanged(); }\n  );\n  // Initial results\n  await refreshResults(\"\");\n});\n\n/* ============= Insert paths ============= */\n\nasync function simpleInsert(e: BibEntry, style: string) {\n  // compute numeric index from first-cited order\n  let order = await getCitedOrder();\n  let pos = order.indexOf(e.id);\n  if (pos === -1) {\n    await markCited(e.id);\n    order = await getCitedOrder();\n    pos = order.indexOf(e.id);\n  }\n  const idx = pos >= 0 ? pos + 1 : 1;\n  const text = formatInText(e, style, idx);\n\n  await Word.run(async (ctx) => {\n    const body = ctx.document.body;\n\n    // Ensure selection; else end-of-doc\n    const ensureSelection = async (): Promise<Word.Range> => {\n      try {\n        const sel = ctx.document.getSelection();\n        sel.load(\"text\");\n        await ctx.sync();\n        return sel;\n      } catch {\n        const end = body.getRange(\"End\");\n        end.select();\n        await ctx.sync();\n        return ctx.document.getSelection();\n      }\n    };\n\n    try {\n      const sel = await ensureSelection();\n      const cc = sel.insertContentControl();\n      cc.tag = `wordref-cite:${e.id}`;\n      cc.title = \"WordRef Citation\";\n      cc.appearance = \"BoundingBox\";\n      cc.insertText(text, Word.InsertLocation.replace);\n      await ctx.sync();\n      return;\n    } catch (err) {\n      console.warn(\"[WordRef] selection CC insert failed; will append at end\", err);\n    }\n\n    // Fallback: append at end\n    const p = body.insertParagraph(\"\", Word.InsertLocation.end);\n    const r = p.getRange(\"Start\");\n    const cc = r.insertContentControl();\n    cc.tag = `wordref-cite:${e.id}`;\n    cc.title = \"WordRef Citation\";\n    cc.appearance = \"BoundingBox\";\n    cc.insertText(text, Word.InsertLocation.replace);\n    await ctx.sync();\n  });\n}\n\nfunction sizeResultsPanel() {\n  const container = document.getElementById(\"results\");\n  if (!container) return;\n\n  const first = container.querySelector<HTMLElement>(\".item\");\n  if (!first) return;\n\n  const card = first.getBoundingClientRect().height || 120; // fallback\n  const gap  = 8;   // vertical gap between cards\n  const pad  = 16;  // top+bottom padding of #results\n\n  // 2 cards + 1 gap + padding\n  const max = Math.round(card * 2 + gap * 1 + pad);\n  container.style.maxHeight = `${max}px`;\n}\nwindow.addEventListener(\"resize\", () => sizeResultsPanel());\n\n/* ============= Style badge & numbering helpers ============= */\n\nfunction updateStyleBadge() {\n  const badge = document.getElementById(\"styleBadge\");\n  if (!badge) return;\n  const v = getStyle();\n  const label =\n    ({\n      ieee: \"IEEE (numeric)\",\n      numeric: \"Numeric\",\n      apa: \"APA\",\n      mla: \"MLA\",\n      harvard: \"Harvard\",\n      acs: \"ACS\",\n      vancouver: \"Vancouver\",\n    } as Record<string, string>)[v] || v.toUpperCase();\n  badge.textContent = label;\n}\n\nasync function ensureCitedIndex(id: string): Promise<number> {\n  let order = await getCitedOrder();\n  let pos = order.indexOf(id);\n  if (pos === -1) {\n    await markCited(id);\n    order = await getCitedOrder();\n    pos = order.indexOf(id);\n  }\n  return pos + 1;\n}\n\n/* ============= Button handlers ============= */\n\nasync function onAddOnly() {\n  const bibbox = $(\"bibtexInput\") as HTMLTextAreaElement | null;\n  if (!bibbox) return;\n  const raw = bibbox.value.trim();\n  if (!raw) return;\n\n  let entries: BibEntry[] = [];\n  try {\n    const parsed = Bib.parseBibtex(raw);\n    entries = parsed.map((e) => normalizeEntry(e));\n  } catch {\n    showToast(\"Could not parse the BibTeX you pasted.\");\n    return;\n  }\n\n  const lib = await getLibrary();\n  for (const e of entries) {\n    if (lib[e.id]) {\n      await refreshResults(\"\");\n      const container = document.getElementById(\"results\")!;\n      flashResultRow(container, e.id);\n      showToast(`Already in your library (key: ${e.id}).`);\n      continue;\n    }\n    const where = ($(\"notePage\") as HTMLInputElement | null)?.value.trim() || \"\";\n    const note = ($(\"noteText\") as HTMLInputElement | null)?.value.trim() || \"\";\n    const withNotes = where || note ? normalizeEntry({ ...e, notes: [{ where, text: note }] }) : e;\n    await upsertEntry(withNotes);\n  }\n  bibbox.value = \"\";\n  await refreshResults(\"\");\n}\n\n/** When the user clicks inside a WordRef citation, jump to its bibliography entry. */\nasync function onSelectionChanged(): Promise<void> {\n  await guard(\"Selection change\", async () => {\n    await Word.run(async (ctx) => {\n      const doc = ctx.document;\n      const sel = doc.getSelection();\n\n      // Load the actual selection text so we can ignore pure caret moves\n      sel.load(\"text\");\n      const parent = sel.parentContentControlOrNullObject;\n      parent.load(\"tag,title,isNullObject\");\n      await ctx.sync();\n\n      // If there is no text selected (just a caret), do nothing\n      if (!sel.text || !sel.text.trim()) {\n        return;\n      }\n\n      if (parent.isNullObject) {\n        // Not inside any CC  ignore\n        return;\n      }\n\n      const tag   = parent.tag || \"\";\n      const title = parent.title || \"\";\n\n      // Decide if this is a WordRef single or group citation\n      let ids: string[] = [];\n      if (title === \"WordRef Citation\" && tag.startsWith(\"wordref-cite:\")) {\n        ids = [tag.slice(\"wordref-cite:\".length).trim()];\n      } else if (title === GROUP_TITLE && tag.startsWith(GROUP_PREFIX)) {\n        ids = tag\n          .slice(GROUP_PREFIX.length)\n          .split(\",\")\n          .map(s => s.trim())\n          .filter(Boolean);\n      } else {\n        // Some other CC  ignore\n        return;\n      }\n\n      if (!ids.length) return;\n\n      const firstId = ids[0];\n\n      // Lookup bib entry\n      const lib   = await getLibrary();\n      const entry = lib[firstId];\n      if (!entry) return;\n\n      const titleText = (entry.fields.title || \"\").trim();\n      if (!titleText) return;\n\n      // Search for the title (usually unique in bibliography)\n      const body = doc.body;\n      const hits = body.search(titleText, {\n        matchCase: false,\n        matchWholeWord: false,\n        matchPrefix: false,\n        matchSuffix: false,\n        matchWildcards: false,\n        ignoreSpace: true,\n        ignorePunct: true,\n      });\n\n      hits.load(\"items\");\n      await ctx.sync();\n\n      if (!hits.items.length) {\n        // No match  silently do nothing\n        return;\n      }\n\n      // Take the first match, go to its paragraph, and select it\n      const para = hits.items[0].paragraphs.getFirst();\n      para.load(\"text\");\n      await ctx.sync();\n\n      para.select();\n      await ctx.sync();\n    });\n  });\n}\n\n/** Jump to the bibliography paragraph for a given entry id and highlight it. */\nasync function jumpToBibliographyEntry(entryId: string, order: string[]): Promise<void> {\n  if (!entryId) return;\n  const idxInOrder = order.indexOf(entryId);\n  if (idxInOrder < 0) return;\n\n  await Word.run(async (ctx) => {\n    const body  = ctx.document.body;\n    const paras = body.paragraphs;\n    paras.load(\"items/text,items/font\");\n    await ctx.sync();\n\n    // Find the bibliography heading paragraph (e.g., \"References\" / \"Bibliography\")\n    let bibStart = -1;\n    for (let i = 0; i < paras.items.length; i++) {\n      const t = paras.items[i].text || \"\";\n      if (/references|bibliography/i.test(t)) {\n        bibStart = i;\n        break;\n      }\n    }\n    if (bibStart < 0) {\n      // No heading found; silently do nothing\n      return;\n    }\n\n    // We assume updateBibliography wrote entries as one paragraph per cited item\n    const targetIdx = bibStart + 1 + idxInOrder;\n    if (targetIdx >= paras.items.length) return;\n\n    const targetPara = paras.items[targetIdx];\n\n    // Clear highlight from all bibliography entries (optional)\n    for (let j = bibStart + 1; j < paras.items.length; j++) {\n      paras.items[j].font.highlightColor = \"NoColor\" as any;\n    }\n\n    // Highlight the target entry and select it\n    targetPara.font.highlightColor = \"Yellow\" as any;\n    const r = targetPara.getRange();\n    r.select();\n\n    await ctx.sync();\n  });\n}\n\nasync function onAddAndCite() {\n  const bibbox = $(\"bibtexInput\") as HTMLTextAreaElement | null;\n  if (!bibbox) return;\n  const raw = bibbox.value.trim();\n  if (!raw) return;\n\n  const where = ($(\"notePage\") as HTMLInputElement | null)?.value.trim() || \"\";\n  const note = ($(\"noteText\") as HTMLInputElement | null)?.value.trim() || \"\";\n  const style = getStyle();\n\n  let entries: BibEntry[] = [];\n  try {\n    const parsed = Bib.parseBibtex(raw);\n    entries = parsed.map((e) => normalizeEntry(e));\n  } catch {\n    showToast(\"Could not parse the BibTeX you pasted.\");\n    return;\n  }\n\n  let lib = await getLibrary();\n  for (const base of entries) {\n    if (lib[base.id]) {\n      await refreshResults(\"\");\n      const container = document.getElementById(\"results\")!;\n      flashResultRow(container, base.id);\n      showToast(`Already cited/added (${base.id}).`);\n      continue;\n    }\n    const e = where || note ? normalizeEntry({ ...base, notes: [{ where, text: note }] }) : base;\n\n    await upsertEntry(e);\n    lib[e.id] = e;\n\n    const idx = await ensureCitedIndex(e.id);\n    const citeText = formatInText(e, style, idx);\n\n    if (DEBUG_SIMPLE_INSERT) {\n      await simpleInsert(e, style);\n      await refreshNumbersAndBibliography();\n      await rerenderGroupCitations(getStyle());\n    } else {\n      await insertCitationControl(e, citeText, style, idx);\n      await refreshNumbersAndBibliography();\n      await rerenderGroupCitations(getStyle());\n    }\n  }\n\n  bibbox.value = \"\";\n  const np = $(\"notePage\") as HTMLInputElement | null; if (np) np.value = \"\";\n  const nt = $(\"noteText\") as HTMLInputElement | null; if (nt) nt.value = \"\";\n  await refreshResults(\"\");\n  await refreshCitedBibtexPanel();\n}\n\nasync function onInsertOnly() {\n  const lib = await getLibrary();\n  const list = Object.values(lib) as BibEntry[];\n  if (!list.length) return;\n  const e = list[0];\n  const style = getStyle();\n\n  await guard(\"Insert citation\", async () => {\n    const idx = await ensureCitedIndex(e.id);\n    const citeText = formatInText(e, style, idx);\n    if (DEBUG_SIMPLE_INSERT) {\n      await simpleInsert(e, style);\n    } else {\n      await insertCitationControl(e, citeText, style, idx);\n    }\n    await refreshNumbersAndBibliography();\n    await rerenderGroupCitations(getStyle());\n  });\n}\n\nasync function onResetNumbering() {\n  if (!(await askConfirm(\"Reset numbering? This re-numbers all citations from [1] based on current document order.\"))) return;\n  await clearCitedOrder(); // drop stored order\n  await refreshNumbersAndBibliography();\n  await rerenderGroupCitations(getStyle());\n  showToast(\"Numbering reset and citations reflowed.\");\n}\n\nasync function onClearLibraryClick() {\n  const ok = await askConfirm(\n    \"Clear ENTIRE library and numbering? This removes all in-document WordRef citations and resets your library. This cannot be undone.\"\n  );\n  if (!ok) return;\n\n  try {\n    // 0) Move cursor out of any CC to reduce edit conflicts\n    await Word.run(async (ctx) => {\n      ctx.document.body.getRange(\"End\").select();\n      await ctx.sync();\n    });\n  } catch {}\n\n  // 1) Delete all WordRef content controls everywhere (body + headers/footers)\n  try {\n    await deleteAllWordRefContentControlsEverywhere();\n  } catch (e) {\n    console.warn(\"[WordRef] deleteAllWordRefContentControlsEverywhere failed:\", e);\n  }\n\n  // 2) Clear storage last, so we still know tags while deleting\n  try { await clearLibrary(); } catch (e) { console.warn(\"[WordRef] clearLibrary failed:\", e); }\n  try { await clearCitedOrder(); } catch (e) { console.warn(\"[WordRef] clearCitedOrder failed:\", e); }\n\n  // 3) Rebuild an empty bibliography (guard against selection/CC issues)\n  try {\n    await Word.run(async (ctx) => {\n      ctx.document.body.getRange(\"End\").select(); // avoid being inside a CC\n      await ctx.sync();\n    });\n    await updateBibliography([], getStyle());\n  } catch (e) {\n    console.warn(\"[WordRef] updateBibliography([]) failed (non-fatal):\", e);\n  }\n\n  // 4) UI refresh\n  try { await refreshResults(\"\"); } catch {}\n  try { await refreshCitedBibtexPanel(); } catch {}\n\n  showToast(\"Library and in-document citations cleared.\");\n}\n\n/** Delete all WordRef citation CCs in body + headers/footers, even if cannotDelete is true. */\n/** Delete all WordRef citation CCs in body + headers/footers, even if cannotDelete is true. */\nasync function deleteAllWordRefContentControlsEverywhere(): Promise<void> {\n  await Word.run(async (ctx) => {\n    // Collect victims from the document BODY first\n    const bodyCcs = ctx.document.contentControls;\n    bodyCcs.load(\"items/tag,items/id,items/cannotDelete\");\n    const sections = ctx.document.sections;\n    sections.load(\"items\");\n    await ctx.sync();\n\n    const victims: Word.ContentControl[] = [];\n\n    // Helper: push WordRef CCs from a content-control collection into victims\n    const pushWordRef = (ccs: Word.ContentControlCollection) => {\n      ccs.load(\"items/tag,items/id,items/cannotDelete\");\n      return ccs;\n    };\n\n    // BODY victims\n    pushWordRef(bodyCcs);\n    await ctx.sync();\n    victims.push(\n      ...bodyCcs.items.filter((cc) => {\n        const t = cc.tag || \"\";\n        return t.startsWith(\"wordref-cite:\") || t.startsWith(\"wordref-group:\");\n      })\n    );\n\n    // HEADER/FOOTER victims via Section.getHeader / getFooter\n    const headerTypes: Word.HeaderFooterType[] = [\n      Word.HeaderFooterType.primary,\n      Word.HeaderFooterType.firstPage,\n      Word.HeaderFooterType.evenPages,\n    ];\n\n    for (const sec of sections.items) {\n      for (const ht of headerTypes) {\n        try {\n          const h = sec.getHeader(ht);\n          const hRange = h.getRange();\n          const hCcs = hRange.contentControls;\n          pushWordRef(hCcs);\n          await ctx.sync();\n          victims.push(\n            ...hCcs.items.filter((cc) => {\n              const t = cc.tag || \"\";\n              return t.startsWith(\"wordref-cite:\") || t.startsWith(\"wordref-group:\");\n            })\n          );\n        } catch { /* header might not exist; ignore */ }\n      }\n      for (const ht of headerTypes) {\n        try {\n          const f = sec.getFooter(ht);\n          const fRange = f.getRange();\n          const fCcs = fRange.contentControls;\n          pushWordRef(fCcs);\n          await ctx.sync();\n          victims.push(\n            ...fCcs.items.filter((cc) => {\n              const t = cc.tag || \"\";\n              return t.startsWith(\"wordref-cite:\") || t.startsWith(\"wordref-group:\");\n            })\n          );\n        } catch { /* footer might not exist; ignore */ }\n      }\n    }\n\n    // Move caret to a safe spot (avoid being inside a CC while deleting)\n    try { ctx.document.body.getRange(\"End\").select(); await ctx.sync(); } catch {}\n\n    // Unlock -> blank content -> delete wrapper\n    for (const cc of victims) {\n      try {\n        if (cc.cannotDelete) cc.cannotDelete = false;\n        await ctx.sync();\n\n        try { cc.getRange().insertText(\"\", Word.InsertLocation.replace); } catch {}\n        await ctx.sync();\n\n        try { cc.delete(true); } catch { cc.delete(false); }\n        await ctx.sync();\n      } catch (e) {\n        console.warn(\"[WordRef] CC delete failed for id\", cc.id, e);\n      }\n    }\n  });\n}\n\nasync function onUpdateBib() {\n  try {\n    await refreshNumbersAndBibliography();\n    await rerenderGroupCitations(getStyle());\n  } catch (err: any) {\n    console.error(\"updateBibliography failed\", err);\n    const info = (err && err.debugInfo) ? JSON.stringify(err.debugInfo) : String(err);\n    showToast(\"Update bibliography failed. \" + info);\n  }\n}\n\nlet styleChangeTimer: number | null = null;\nlet styleChangeInFlight = false;\n\nasync function onStyleChanged() {\n  if (styleChangeTimer) clearTimeout(styleChangeTimer);\n  styleChangeTimer = window.setTimeout(async () => {\n    if (styleChangeInFlight) return;\n    styleChangeInFlight = true;\n\n    const sel = document.getElementById(\"styleSelect\") as HTMLSelectElement | null;\n    if (sel) sel.disabled = true;\n\n    await guard(\"Change citation style\", async () => {\n      updateStyleBadge();\n\n      // Move cursor to end to avoid GeneralException when updating CCs\n      await Word.run(async (ctx) => {\n        ctx.document.body.getRange(\"End\").select();\n        await ctx.sync();\n      });\n\n      await refreshNumbersAndBibliography();\n      await rerenderGroupCitations(getStyle());\n      await refreshCitedBibtexPanel();\n    });\n\n    if (sel) sel.disabled = false;\n    styleChangeInFlight = false;\n  }, 150) as any as number;\n}\n\n/* ============= Export / Import ============= */\n\nfunction toCsvValue(v: unknown): string {\n  const s = (v ?? \"\").toString();\n  return /[\",\\n]/.test(s) ? `\"${s.replace(/\"/g, '\"\"')}\"` : s;\n}\nfunction rowsToCsv(rows: CsvRow[]): string {\n  if (!rows.length) return \"\";\n  const headers = Object.keys(rows[0]);\n  const lines = [\n    headers.map(h => toCsvValue(h)).join(\",\"),\n    ...rows.map(r => headers.map(h => toCsvValue(r[h] ?? \"\")).join(\",\")),\n  ];\n  return lines.join(\"\\n\");\n}\nfunction libraryToCsv(lib: Record<string, BibEntry>): string {\n  const rows: CsvRow[] = Object.values(lib).map(e => ({\n    id: e.id,\n    title: e.fields.title || \"\",\n    author: e.fields.author || e.fields.editor || \"\",\n    year: e.fields.year || \"\",\n    journal: e.fields.journal || \"\",\n    booktitle: e.fields.booktitle || \"\",\n    volume: e.fields.volume || \"\",\n    number: e.fields.number || \"\",\n    pages: e.fields.pages || \"\",\n    doi: e.fields.doi || \"\",\n    notes: (e.notes || []).map(n => `${n.where || \"\"} ${n.text || \"\"}`.trim()).join(\" | \"),\n  }));\n  return rowsToCsv(rows);\n}\nfunction libraryToXml(lib: Record<string, BibEntry>): string {\n  const esc = (s: string) =>\n    s.replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\")\n     .replace(/\"/g,\"&quot;\").replace(/'/g,\"&apos;\");\n  const entries = Object.values(lib).map(e => {\n    const fields = Object.entries(e.fields || {})\n      .map(([k,v]) => `<field name=\"${esc(k)}\">${esc(String(v ?? \"\"))}</field>`)\n      .join(\"\");\n    const notes = (e.notes || [])\n      .map(n => `<note where=\"${esc(n.where || \"\")}\">${esc(n.text || \"\")}</note>`)\n      .join(\"\");\n    return `<entry id=\"${esc(e.id)}\">${fields}${notes}</entry>`;\n  }).join(\"\");\n  return `<?xml version=\"1.0\" encoding=\"UTF-8\"?><wordref>${entries}</wordref>`;\n}\n\nfunction sanitizeFileName(s: string): string {\n  return (s || \"\").replace(/[\\\\/:*?\"<>|]/g, \"\").trim() || \"wordref-library\";\n}\nfunction platformDownloadHint(): string {\n  const p = Office?.context?.platform;\n  switch (p) {\n    case Office.PlatformType.Mac:          return \"Saved to your Mac Downloads folder (~/Downloads).\";\n    case Office.PlatformType.OfficeOnline: return \"Saved to your browser's Downloads folder.\";\n    case Office.PlatformType.PC:           return \"Saved to your Windows Downloads folder.\";\n    default:                               return \"Saved to your Downloads folder.\";\n  }\n}\n\nlet ioStatusTimer: number | null = null;\nfunction setIoStatus(msg: string, ttlMs = 3500) {\n  const el = document.getElementById(\"ioStatus\");\n  if (!el) return;\n  el.textContent = msg;\n  el.classList.remove(\"hide\");\n  if (ioStatusTimer) window.clearTimeout(ioStatusTimer);\n  ioStatusTimer = window.setTimeout(() => {\n    el.textContent = \"\";\n    el.classList.add(\"hide\");\n    ioStatusTimer = null;\n  }, ttlMs);\n}\n\n/** Use the same page as the dialog by switching to #download-dialog (handled in HTML) */\nfunction openDownloadDialogUrl() {\n  const base = new URL(window.location.href);\n  base.hash = \"download-dialog\";\n  return base.toString();\n}\n\nfunction separatorForStyle(style: string): string {\n  const s = (style || \"\").toLowerCase();\n  // Numeric families usually show [1], [2]\n  if ([\"ieee\", \"numeric\", \"vancouver\", \"acs\"].includes(s)) return \", \";\n  // Authoryear styles usually (Smith, 2019; Lee & Kim, 2020)\n  return \"; \";\n}\n\nfunction isMac() {\n  return Office?.context?.platform === Office.PlatformType.Mac;\n}\n\nfunction exportViaDialog(filename: string, data: string, mime: string): Promise<void> {\n  return new Promise((resolve, reject) => {\n    const url = openDownloadDialogUrl(); // same origin, same HTML\n    Office.context.ui.displayDialogAsync(\n      url,\n      { height: 35, width: 30, displayInIframe: !isMac() ? true : false },\n      (res) => {\n        if (res.status !== Office.AsyncResultStatus.Succeeded || !res.value) {\n          reject(new Error(\"Dialog failed to open\"));\n          return;\n        }\n        const dialog = res.value;\n\n        const onMsg = (args: any) => {\n          try {\n            const payload = JSON.parse(String(args?.message ?? \"{}\"));\n            if (payload?.ok) resolve();\n            else reject(new Error(payload?.error || \"Download failed\"));\n          } catch (e) {\n            reject(e instanceof Error ? e : new Error(String(e)));\n          } finally {\n            try { dialog.close(); } catch {}\n          }\n        };\n        const onErr = (args: any) => {\n          try { reject(new Error(`Dialog error code: ${args?.error}`)); }\n          finally { try { dialog.close(); } catch {} }\n        };\n\n        dialog.addEventHandler(Office.EventType.DialogMessageReceived, onMsg);\n        dialog.addEventHandler(Office.EventType.DialogEventReceived, onErr);\n\n        dialog.messageChild(JSON.stringify({ filename, data, mime }));\n      }\n    );\n  });\n}\n\nasync function onExportLibrary() {\n  const lib = await getLibrary();\n  const fmt = ((document.getElementById(\"exportFormat\") as HTMLSelectElement)?.value || \"json\").toLowerCase();\n\n  let data = \"\";\n  let mime = \"application/json\";\n  let ext  = \"json\";\n\n  if (fmt === \"csv\") { data = libraryToCsv(lib); mime = \"text/csv\"; ext = \"csv\"; }\n  else if (fmt === \"xml\") { data = libraryToXml(lib); mime = \"application/xml\"; ext = \"xml\"; }\n  else { data = JSON.stringify(lib, null, 2); }\n\n  const stamp = new Date().toISOString().slice(0,19).replace(/[:T]/g,\"-\");\n  const filename = sanitizeFileName(`wordref-library-${stamp}.${ext}`);\n\n  const isWin = Office?.context?.platform === Office.PlatformType.PC;\n  const isWeb = Office?.context?.platform === Office.PlatformType.OfficeOnline;\n  const isMacPlat = isMac();\n\n  if (isWin || isWeb) {\n    try {\n      const blob = new Blob([data], { type: mime });\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement(\"a\");\n      a.href = url; a.download = filename; a.rel = \"noopener\"; a.style.display = \"none\";\n      document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);\n      showToast(`${filename} saved to your Downloads folder.`);\n      return;\n    } catch {}\n  }\n\n  if (isMacPlat) {\n    try {\n      await exportViaDialog(filename, data, mime);\n      showToast(`Exported as ${filename} (check ~/Downloads).`);\n      return;\n    } catch {}\n  }\n\n  // Fallback visible link\n  try {\n    const blob = new Blob([data], { type: mime });\n    const url = URL.createObjectURL(blob);\n    const link = document.createElement(\"a\");\n    link.textContent = `Download ${filename}`;\n    link.href = url; link.download = filename; link.target = \"_blank\"; link.rel = \"noopener\";\n    link.style.display = \"inline-block\"; link.style.marginTop = \"8px\"; link.style.wordBreak = \"break-all\";\n    (document.getElementById(\"toast\") || document.body).appendChild(link);\n    showToast(\"Click to download. If blocked, try right-click  Save link as\");\n    setTimeout(() => { try { URL.revokeObjectURL(url); } catch {} }, 60_000);\n  } catch {}\n\n  if (mime === \"application/json\" || mime.startsWith(\"text/\")) {\n    try { await navigator.clipboard.writeText(data); showToast(`Also copied to clipboard (${ext.toUpperCase()}).`); } catch {}\n  }\n}\n\n/* ============= CSV/XML parsing, results, utilities ============= */\n\nfunction splitCsvLine(line: string): string[] {\n  const out: string[] = []; let cur = \"\", inQ = false;\n  for (let i = 0; i < line.length; i++) {\n    const ch = line[i];\n    if (inQ) {\n      if (ch === '\"' && line[i+1] === '\"') { cur += '\"'; i++; }\n      else if (ch === '\"') inQ = false;\n      else cur += ch;\n    } else {\n      if (ch === '\"') inQ = true;\n      else if (ch === \",\") { out.push(cur); cur = \"\"; }\n      else cur += ch;\n    }\n  }\n  out.push(cur);\n  return out;\n}\n\nfunction parseCsvToEntries(csv: string): BibEntry[] {\n  const lines = csv.replace(/\\r/g, \"\").split(\"\\n\").filter(Boolean);\n  if (!lines.length) return [];\n  const headers = splitCsvLine(lines[0]).map(h => h.trim().toLowerCase());\n  const idx = (k: string) => headers.indexOf(k);\n\n  const out: BibEntry[] = [];\n  for (let i = 1; i < lines.length; i++) {\n    const cols = splitCsvLine(lines[i]);\n    const get = (k: string) => { const j = idx(k); return j >= 0 ? (cols[j] || \"\").trim() : \"\"; };\n    const id = get(\"id\") || slugId(get(\"title\"), get(\"author\"), get(\"year\"));\n    const fields: any = {\n      title: get(\"title\"),\n      author: get(\"author\"),\n      year: get(\"year\"),\n      journal: get(\"journal\"),\n      booktitle: get(\"booktitle\"),\n      volume: get(\"volume\"),\n      number: get(\"number\"),\n      pages: get(\"pages\"),\n      doi: get(\"doi\"),\n    };\n    Object.keys(fields).forEach(k => { if (!fields[k]) delete fields[k]; });\n    const notesRaw = get(\"notes\");\n    const notes = notesRaw ? notesRaw.split(\" | \").map(s => ({ where: \"\", text: s })) : [];\n    out.push(normalizeEntry({ id, type: \"misc\", fields, notes }));\n  }\n  return out;\n}\n\nfunction parseXmlToEntries(xml: string): BibEntry[] {\n  const dom = new DOMParser().parseFromString(xml, \"application/xml\");\n  if (dom.querySelector(\"parsererror\")) return [];\n  const entries: BibEntry[] = [];\n  dom.querySelectorAll(\"entry\").forEach(node => {\n    const id = node.getAttribute(\"id\") || \"\";\n    const fields: Record<string, string> = {};\n    node.querySelectorAll(\"field\").forEach(f => {\n      const k = f.getAttribute(\"name\") || \"\";\n      fields[k] = f.textContent || \"\";\n    });\n    const notes = Array.from(node.querySelectorAll(\"note\")).map(n => ({\n      where: n.getAttribute(\"where\") || \"\",\n      text: n.textContent || \"\"\n    }));\n    if (id) entries.push(normalizeEntry({ id, type: \"misc\", fields, notes }));\n  });\n  return entries;\n}\n\nfunction slugId(title = \"\", author = \"\", year = \"\"): string {\n  const t = (title || \"\").toLowerCase().replace(/[^a-z0-9]+/g, \"-\").slice(0, 32).replace(/^-|-$/g, \"\");\n  const a = (author || \"\").split(/[,\\s]/)[0]?.toLowerCase() || \"anon\";\n  const y = year || \"nd\";\n  return [a, t || \"item\", y].filter(Boolean).join(\"-\");\n}\n\nasync function refreshBibliographyNow(style: string) {\n  const lib = await getLibrary();\n  const ids = await scanCitationsEverywhere();\n  const seen = new Set<string>();\n  const cited = ids.filter(id => (lib as any)[id] && !seen.has(id) && (seen.add(id), true))\n                   .map(id => (lib as any)[id]);\n  await updateBibliography(cited, style, getBibFormatOpts());\n}\n\n\nasync function refreshResults(query: string) {\n  const lib = await getLibrary();\n  const all = Object.values(lib) as BibEntry[];\n  const q = norm(query || \"\");\n  const filtered = q\n    ? all.filter((e) => {\n        const blob = [\n          e.id, e.fields.title, e.fields.author, e.fields.year,\n          e.fields.journal, e.fields.booktitle, e.fields.doi,\n          ...(e.notes?.map((n) => `${n.where || \"\"} ${n.text || \"\"}`) || []),\n        ].join(\" \").toLowerCase();\n        return blob.includes(q);\n      })\n    : all;\n\n  const container = $(\"results\");\n  if (!container) return;\n\n  const markify = (s: string) => (q ? highlightText(s, query) : s);\n  container.innerHTML = filtered.map((e) => {\n    const title = markify(e.fields.title || e.id);\n    const meta = markify(`${e.fields.author || \"Anon\"}  ${e.fields.year || \"n.d.\"}`);\n    const notes = (e.notes?.map((n) => `<div class=\"note\">${markify(` ${n.where || \"\"} ${n.text || \"\"}`)}</div>`) || []).join(\"\");\n    return `\n      <div class=\"row item\" data-id=\"${e.id}\">\n        <div class=\"grow\">\n          <div class=\"title\">${title}</div>\n          <div class=\"meta\">${meta}</div>\n          ${notes}\n        </div>\n        <button class=\"cite-btn\" data-id=\"${e.id}\">Cite</button>\n      </div>\n    `;\n  }).join(\"\");\n\n  container.querySelectorAll<HTMLButtonElement>(\"button.cite-btn\").forEach((btn) => {\n    btn.addEventListener(\"click\", async () => {\n      const id = btn.getAttribute(\"data-id\"); if (!id) return;\n      const lib = await getLibrary();\n      const e = (lib as any)[id] as BibEntry | undefined; if (!e) return;\n      const style = getStyle();\n      const idx = await ensureCitedIndex(e.id);\n      const citeText = formatInText(e, style, idx);\n      try {\n        if (DEBUG_SIMPLE_INSERT) {\n          await simpleInsert(e, style);\n          await refreshNumbersAndBibliography();\n          await rerenderGroupCitations(getStyle());\n        } else {\n          await insertCitationControl(e, citeText, style, idx);\n          await refreshNumbersAndBibliography();\n          await rerenderGroupCitations(getStyle());\n        }\n      } catch (err: any) {\n        console.error(\"Insert citation error:\", err, err?.debugInfo);\n        const info = err?.debugInfo ? JSON.stringify(err.debugInfo) : String(err);\n        showToast(\"Insert citation failed: \" + info);\n      }\n    });\n  });\n\n  const count = document.getElementById(\"libCount\");\n  if (count) count.textContent = `${filtered.length} item${filtered.length === 1 ? \"\" : \"s\"}`;\n  sizeResultsPanel();\n}\n\n/* ============= Utilities ============= */\n\nfunction norm(s: string) { return (s || \"\").toLowerCase().replace(/\\s+/g, \" \").trim(); }\nfunction normTitle(s: string) { return norm(s).replace(/[^a-z0-9 ]/g, \"\"); }\nfunction isLikelyBibtex(s: string) { return /@\\w+\\s*\\{[\\s\\S]*\\}/.test(s); }\n\ntype BibMatch = { id?: string; reason: \"citationKey\" | \"doi\" | \"title\"; };\n\nasync function findExistingFromBibtex(raw: string): Promise<BibMatch | null> {\n  const lib = await getLibrary();\n  const all = Object.values(lib) as BibEntry[];\n  let parsed: BibEntry[];\n  try { parsed = Bib.parseBibtex(raw); } catch { return null; }\n  if (!parsed.length) return null;\n  const needle = parsed[0];\n\n  const nid = (needle.id || \"\").trim();\n  if (nid) { const hit = all.find((e) => e.id === nid); if (hit) return { id: hit.id, reason: \"citationKey\" }; }\n\n  const nd = norm(needle.fields.doi || \"\");\n  if (nd) { const hit = all.find((e) => norm(e.fields.doi || \"\") === nd); if (hit) return { id: hit.id, reason: \"doi\" }; }\n\n  const nt = normTitle(needle.fields.title || \"\");\n  if (nt) { const hit = all.find((e) => normTitle(e.fields.title || \"\") === nt); if (hit) return { id: hit.id, reason: \"title\" }; }\n\n  return null;\n}\n\n/** Scan document for all WordRef citations (single + group) in document order. */\nasync function getAllCitationIdsInDoc(): Promise<string[]> {\n  return Word.run(async (ctx) => {\n    const doc = ctx.document;\n    const allCcs = doc.contentControls;\n    allCcs.load(\"items/tag,items/title\");\n    await ctx.sync();\n\n    type ItemInfo = { ids: string[]; start: Word.Range };\n    const items: ItemInfo[] = [];\n\n    for (const cc of allCcs.items) {\n      const tag = cc.tag || \"\";\n      const title = cc.title || \"\";\n\n      if (!tag) continue;\n\n      // Single citation\n      if (title === \"WordRef Citation\" && tag.startsWith(\"wordref-cite:\")) {\n        const id = tag.slice(\"wordref-cite:\".length).trim();\n        if (!id) continue;\n        const start = cc.getRange(\"Start\");\n        items.push({ ids: [id], start });\n      }\n\n      // Group citation\n      if (title === GROUP_TITLE && tag.startsWith(GROUP_PREFIX)) {\n        const raw = tag.slice(GROUP_PREFIX.length);\n        const ids = raw.split(\",\").map(s => s.trim()).filter(Boolean);\n        if (!ids.length) continue;\n        const start = cc.getRange(\"Start\");\n        items.push({ ids, start });\n      }\n    }\n\n    // Sort items by location in doc\n    const sorted: ItemInfo[] = [];\n    for (const it of items) {\n      let placed = false;\n      for (let i = 0; i < sorted.length; i++) {\n        const cmp = it.start.compareLocationWith(sorted[i].start);\n        await ctx.sync();\n        if (cmp.value === Word.LocationRelation.before) {\n          sorted.splice(i, 0, it);\n          placed = true;\n          break;\n        }\n      }\n      if (!placed) sorted.push(it);\n    }\n\n    // Flatten to id sequence, preserving per-group order\n    const out: string[] = [];\n    for (const it of sorted) out.push(...it.ids);\n    return out;\n  });\n}\n\nfunction showToast(msg: string) {\n  const t = document.getElementById(\"toast\"); if (!t) return;\n  t.textContent = msg; t.classList.add(\"show\");\n  setTimeout(() => t.classList.remove(\"show\"), 1800);\n}\n\nfunction highlightText(haystackHtml: string, query: string) {\n  const q = query.trim(); if (!q) return haystackHtml;\n  const tokens = q.split(/\\s+/).filter(Boolean).map(tok => tok.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\"));\n  if (!tokens.length) return haystackHtml;\n  const rx = new RegExp(`(${tokens.join(\"|\")})`, \"gi\");\n  return haystackHtml.replace(rx, \"<mark>$1</mark>\");\n}\n\nfunction flashResultRow(container: HTMLElement, id: string) {\n  const row = container.querySelector<HTMLElement>(`.item[data-id=\"${CSS.escape(id)}\"]`);\n  if (!row) return;\n  row.classList.add(\"hit-highlight\");\n  row.scrollIntoView({ behavior: \"smooth\", block: \"center\" });\n  setTimeout(() => row.classList.remove(\"hit-highlight\"), 1200);\n}\n\n/** Inline confirm bar */\nfunction askConfirm(message: string): Promise<boolean> {\n  return new Promise((resolve) => {\n    const bar = document.getElementById(\"confirmBar\")!;\n    const msg = document.getElementById(\"confirmMsg\")!;\n    const yes = document.getElementById(\"confirmYes\")!;\n    const no = document.getElementById(\"confirmNo\")!;\n    msg.textContent = message;\n    bar.style.display = \"flex\";\n    const cleanup = () => { bar.style.display = \"none\"; yes.removeEventListener(\"click\", onYes); no.removeEventListener(\"click\", onNo); };\n    const onYes = () => { cleanup(); resolve(true); };\n    const onNo  = () => { cleanup(); resolve(false); };\n    yes.addEventListener(\"click\", onYes);\n    no.addEventListener(\"click\", onNo);\n  });\n}\n\n/* ============= Import handler (single definition) ============= */\n\nasync function onImportFilePicked(ev: Event): Promise<void> {\n  const input = ev.currentTarget as HTMLInputElement;\n  const file = input.files && input.files[0];\n  if (!file) return;\n\n  try {\n    const text = await file.text();\n    const name = file.name.toLowerCase();\n    let entries: Bib.BibEntry[] = [];\n\n    if (name.endsWith(\".json\")) {\n      const obj = JSON.parse(text);\n      const list: any[] = Array.isArray(obj) ? obj : Object.values(obj || {});\n      entries = list\n        .filter(x => x && x.id)\n        .map(x => normalizeEntry(x as Partial<Bib.BibEntry>));\n    } else if (name.endsWith(\".csv\")) {\n      entries = parseCsvToEntries(text);\n    } else if (name.endsWith(\".xml\")) {\n      entries = parseXmlToEntries(text);\n    } else {\n      showToast(\"Unsupported file. Use .json, .csv, or .xml.\");\n      input.value = \"\";\n      return;\n    }\n\n    if (!entries.length) {\n      showToast(\"No entries found in file.\");\n      input.value = \"\";\n      return;\n    }\n\n    for (const e of entries) {\n      await upsertEntry(e);\n    }\n\n    await refreshResults(\"\");\n    showToast(`Imported ${entries.length} entr${entries.length === 1 ? \"y\" : \"ies\"}.`);\n  } catch (err) {\n    console.error(\"Import failed:\", err);\n    showToast(\"Import failed. Check console for details.\");\n  } finally {\n    input.value = \"\"; // allow re-select of same file\n  }\n}\n\nconst BIB_BOOKMARK = \"_WORDREF_BIB\";\n\nasync function onUnmergeSelectedCitation(): Promise<void> {\n  const style = getStyle();\n  const lib   = await getLibrary();\n  const order = await getCitedOrder();\n\n  await guard(\"Unmerge citations\", async () => {\n    await Word.run(async (ctx) => {\n      const sel      = ctx.document.getSelection();\n      const selRange = sel.getRange();\n\n      const groups = ctx.document.contentControls.getByTitle(GROUP_TITLE);\n      groups.load(\"items/tag\");\n      await ctx.sync();\n\n      let target: Word.ContentControl | null = null;\n\n      // Find the group CC containing the selection\n      for (const cc of groups.items) {\n        const r   = cc.getRange();\n        const rel = r.compareLocationWith(selRange);\n        await ctx.sync();\n\n        const val = rel.value;\n        const touches =\n          val === Word.LocationRelation.inside ||\n          val === Word.LocationRelation.equal;\n\n        if (touches) {\n          target = cc;\n          break;\n        }\n      }\n\n      if (!target) {\n        showToast(\"Place the cursor inside a merged citation to unmerge.\");\n        return;\n      }\n\n      const tag = target.tag || \"\";\n      if (!tag.startsWith(GROUP_PREFIX)) {\n        showToast(\"This citation is not a merged group.\");\n        return;\n      }\n\n      const ids = tag\n        .slice(GROUP_PREFIX.length)\n        .split(\",\")\n        .map(s => s.trim())\n        .filter(Boolean);\n\n      if (!ids.length) {\n        showToast(\"Group is empty.\");\n        return;\n      }\n\n      // We just need valid IDs; numbering & text will be rebuilt later\n      const validIds = ids.filter(id => !!lib[id]);\n      if (!validIds.length) {\n        showToast(\"No valid entries in group.\");\n        return;\n      }\n\n      // Insert new single citation CCs BEFORE the group CC\n      const groupRange = target.getRange();\n      let cursor       = groupRange.insertText(\"\", Word.InsertLocation.before);\n\n      for (let i = 0; i < validIds.length; i++) {\n        const id = validIds[i];\n\n        if (i > 0) {\n          // space between them, e.g. [1] [2] -> will be combined later if you merge again\n          cursor = cursor.insertText(\" \", Word.InsertLocation.after);\n        }\n\n        // Create an empty CC; text will be set by rerenderAllCitations\n        const ccRange = cursor.insertText(\"\", Word.InsertLocation.after);\n        const cc      = ccRange.insertContentControl();\n        cc.title      = \"WordRef Citation\";\n        cc.tag        = `wordref-cite:${id}`;\n        cc.appearance = \"BoundingBox\";\n\n        cursor = cc.getRange(\"End\");\n      }\n\n      // Remove the old merged group completely\n      try {\n        target.delete(false); // delete wrapper + content\n      } catch {\n        try {\n          target.getRange().insertText(\"\", Word.InsertLocation.replace);\n          await ctx.sync();\n          target.delete(true);\n        } catch {}\n      }\n\n      await ctx.sync();\n    });\n  });\n\n  // Re-number and rebuild bibliography so everything is consistent\n  await guard(\"Refresh after unmerge\", async () => {\n    await refreshNumbersAndBibliography();\n    await rerenderGroupCitations(getStyle());\n  });\n\n  showToast(\"Citations unmerged.\");\n}\n\n\n/** Ensure a bookmark exists at the bibliography start. Call it after UpdateBibliography. */\nasync function ensureBibliographyBookmark(): Promise<void> {\n  await Word.run(async (ctx) => {\n    // Look for a paragraph whose text contains References or your bibliography heading\n    const body = ctx.document.body;\n    const paras = body.paragraphs;\n    paras.load(\"items/text\");\n    await ctx.sync();\n\n    let target = paras.items.find(p => /references|bibliography/i.test(p.text || \"\"));\n    if (!target) return; // silent if user hasnt inserted one yet\n\n    const r = target.getRange(\"Start\");\n    r.insertBookmark(BIB_BOOKMARK);\n    await ctx.sync();\n  });\n}\n\n/** Replace citation display text with a hyperlink pointing to the bibliography bookmark. */\nfunction escapeHtml(s: string) {\n  return (s ?? \"\")\n    .replace(/&/g, \"&amp;\")\n    .replace(/</g, \"&lt;\")\n    .replace(/>/g, \"&gt;\")\n    .replace(/\"/g, \"&quot;\");\n}\n\n/** Replace the content of a citation CC with clickable text.\n * If `href` is omitted, it just inserts plain text.\n */\nasync function setCitationTextAsHyperlink(\n  cc: Word.ContentControl,\n  displayText: string,\n  href?: string\n): Promise<void> {\n  return Word.run(async (ctx) => {\n    const r = cc.getRange();\n    if (href) {\n      const html = `<a href=\"${escapeHtml(href)}\" target=\"_self\">${escapeHtml(displayText)}</a>`;\n      r.insertHtml(html, Word.InsertLocation.replace);\n    } else {\n      r.insertText(displayText, Word.InsertLocation.replace);\n    }\n    await ctx.sync();\n  });\n}\n\n/** Minimal BibTeX generator from your BibEntry shape */\nfunction toBibtex(e: BibEntry): string {\n  const t = (e.type || \"misc\");\n  const k = e.id;\n  const f = e.fields || {};\n  const lines: string[] = [`@${t}{${k},`];\n  for (const [key, val] of Object.entries(f)) {\n    if (!val) continue;\n    lines.push(`  ${key} = {${String(val)}},`);\n  }\n  lines[lines.length-1] = lines[lines.length-1].replace(/,+$/, \"\"); // trim last comma\n  lines.push(\"}\");\n  return lines.join(\"\\n\");\n}\n\nasync function buildCitedBibtex(): Promise<string> {\n  const order = await getCitedOrder();\n  const lib = await getLibrary();\n  const cited = order.map(id => lib[id]).filter(Boolean);\n  return cited.map(toBibtex).join(\"\\n\\n\");\n}\n\nasync function refreshCitedBibtexPanel(): Promise<void> {\n  const box = document.getElementById(\"citedBibtexBox\") as HTMLTextAreaElement | null;\n  if (!box) return;\n  box.value = await buildCitedBibtex();\n}\n\n/** Delete all WordRef citation content controls ([single] and [group]) from the document. */\nasync function deleteAllCitationControls(): Promise<void> {\n  await Word.run(async (ctx) => {\n    const ccs = ctx.document.contentControls;\n    ccs.load(\"items/tag\");\n    await ctx.sync();\n\n    const victims = ccs.items.filter(cc => {\n      const t = cc.tag || \"\";\n      return t.startsWith(\"wordref-cite:\") || t.startsWith(\"wordref-group:\");\n    });\n\n    for (const v of victims) {\n      try { v.delete(false); } catch {}\n    }\n    await ctx.sync();\n  });\n}\nasync function onImportBibtexPasted(): Promise<void> {\n  const box = document.getElementById(\"importBibtexBox\") as HTMLTextAreaElement | null;\n  if (!box) return;\n  const raw = (box.value || \"\").trim();\n  if (!raw) { showToast(\"Paste some BibTeX first.\"); return; }\n\n  let entries: BibEntry[] = [];\n  try {\n    entries = Bib.parseBibtex(raw).map(e => normalizeEntry(e));\n  } catch (e) {\n    console.error(\"BibTeX parse failed:\", e);\n    showToast(\"Could not parse BibTeX. Check the format.\");\n    return;\n  }\n  if (!entries.length) { showToast(\"No BibTeX entries found.\"); return; }\n\n  const lib = await getLibrary();\n  let added = 0, skipped = 0;\n\n  for (const e of entries) {\n    if (!e.id) { skipped++; continue; }\n    if (lib[e.id]) { skipped++; continue; }\n    await upsertEntry(e);\n    (lib as any)[e.id] = e;\n    added++;\n  }\n\n  await refreshResults(\"\");\n  hide(\"importLibPanel\");\n  showToast(`Imported ${added} entr${added===1?\"y\":\"ies\"}${skipped?`, skipped ${skipped} duplicate${skipped===1?\"\":\"s\"}`:\"\"}.`);\n}\nfunction isNumericStyle(style: string): boolean {\n  const s = (style || \"\").toLowerCase();\n  return [\"ieee\", \"numeric\", \"vancouver\", \"acs\"].includes(s);\n}\n\nasync function formatGroupFromIds(ids: string[], style: string): Promise<string> {\n  const lib   = await getLibrary();\n  const order = await getCitedOrder();\n\n  // unique preserve order\n  const uniq = ids.filter((x, i, a) => a.indexOf(x) === i);\n\n  const numericIdx: number[] = [];\n  const alphaBits: string[] = [];\n\n  for (const id of uniq) {\n    const e = lib[id];\n    if (!e) continue;\n    const idx = order.indexOf(id) + 1;\n    if (idx > 0) numericIdx.push(idx);\n\n    // authoryear with formatInText; strip outer () or []\n    let t = formatInText(e, style, Math.max(idx, 1));\n    t = t.replace(/^[\\s\\[(]+|[\\s\\])]+$/g, \"\");\n    if (!isNumericStyle(style)) alphaBits.push(t);\n  }\n\n  numericIdx.sort((a,b)=>a-b);\n\n  if (isNumericStyle(style)) {\n    const numText = numericIdx.length ? `[${compressNumericList(numericIdx)}]` : \"\";\n    return numText || \"[]\";\n  } else {\n    // Authoryear style: just comma/semi-colon join. Most styles prefer ; \n    const alphaText = alphaBits.length ? `(${alphaBits.join(\"; \")})` : \"()\";\n    return alphaText;\n  }\n}\n\n/** Update all group controls to current style */\nasync function rerenderGroupCitations(style: string): Promise<void> {\n  await Word.run(async (ctx) => {\n    const groups = ctx.document.contentControls.getByTitle(GROUP_TITLE);\n    groups.load(\"items/tag,items/id\");\n    await ctx.sync();\n\n    for (const cc of groups.items) {\n      const tag = cc.tag || \"\";\n      if (!tag.startsWith(GROUP_PREFIX)) continue;\n      const ids = tag.slice(GROUP_PREFIX.length).split(\",\").map(s => s.trim()).filter(Boolean);\n      const text = await formatGroupFromIds(ids, style);\n      cc.insertText(text, Word.InsertLocation.replace);\n    }\n    await ctx.sync();\n  });\n}\nasync function formatMixedFromIds(ids: string[], style: string): Promise<string> {\n  const lib   = await getLibrary();\n  const order = await getCitedOrder();\n\n  // de-dup while preserving first appearance within the selection\n  const uniq = ids.filter((x, i, a) => a.indexOf(x) === i);\n\n  const numericIdx: number[] = [];\n  const alphaBits: string[] = [];\n\n  for (const id of uniq) {\n    const e = lib[id];\n    if (!e) continue;\n    const idx = order.indexOf(id) + 1;\n\n    if (idx > 0) {\n      numericIdx.push(idx);\n    } else {\n      // fallback to author-year style text if not numbered yet\n      let s = formatInText(e, style, 1);\n      s = s.replace(/^[\\s\\[(]+|[\\s\\])]+$/g, \"\");\n      alphaBits.push(s);\n    }\n  }\n\n  numericIdx.sort((a,b)=>a-b);\n  const numText   = numericIdx.length ? `[${compressNumericList(numericIdx)}]` : \"\";\n  const alphaText = alphaBits.length  ? `(${alphaBits.join(\"; \")})`           : \"\";\n\n  if (numText && alphaText) return `${numText}, ${alphaText}`;\n  return numText || alphaText || \"\";\n}\n\nfunction guid(): string {\n  return \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, c => {\n    const r = (Math.random() * 16) | 0, v = c === \"x\" ? r : (r & 0x3) | 0x8;\n    return v.toString(16);\n  });\n}\n\nasync function onMergeSelectedCitations(): Promise<void> {\n  const style = getStyle();\n  const isNumericStyleLocal = (s: string) =>\n    [\"ieee\", \"numeric\", \"vancouver\", \"acs\"].includes((s || \"\").toLowerCase());\n\n  const renderMergedText = async (ids: string[], styleNow: string): Promise<string> => {\n    const lib = await getLibrary();\n    const order = await getCitedOrder();\n    const uniq = ids.filter((x, i, a) => a.indexOf(x) === i);\n\n    if (isNumericStyleLocal(styleNow)) {\n      const nums = uniq.map(id => order.indexOf(id) + 1).filter(n => n > 0).sort((a, b) => a - b);\n      const body = nums.length ? compressNumericList(nums) : \"\";\n      return body ? `[${body}]` : \"[]\";\n    } else {\n      const bits: string[] = [];\n      for (const id of uniq) {\n        const e = (lib as any)[id];\n        if (!e) continue;\n        const idx = Math.max(order.indexOf(id) + 1, 1);\n        let t = formatInText(e, styleNow, idx);\n        t = t.replace(/^[\\s\\[(]+|[\\s\\])]+$/g, \"\");\n        bits.push(t);\n      }\n      return bits.length ? `(${bits.join(\"; \")})` : \"()\";\n    }\n  };\n\n  await guard(\"Merge selected citations\", async () => {\n    await Word.run(async (ctx) => {\n      const selRange = ctx.document.getSelection(); // correct\n      const singles = ctx.document.contentControls.getByTitle(\"WordRef Citation\");\n      singles.load(\"items/tag,items/id\");\n      await ctx.sync();\n\n      type Pick = { cc: Word.ContentControl; tag: string; start: Word.Range };\n      const picked: Pick[] = [];\n\n      for (const cc of singles.items) {\n        const tag = cc.tag || \"\";\n        if (!tag.startsWith(\"wordref-cite:\")) continue;\n\n        const rStart = cc.getRange(\"Start\");\n        const rEnd = cc.getRange(\"End\");\n        const cmpA = rStart.compareLocationWith(selRange);\n        const cmpB = rEnd.compareLocationWith(selRange);\n        await ctx.sync();\n\n        const inside =\n          (cmpA.value === Word.LocationRelation.inside || cmpA.value === Word.LocationRelation.equal) &&\n          (cmpB.value === Word.LocationRelation.inside || cmpB.value === Word.LocationRelation.equal);\n        if (inside) picked.push({ cc, tag, start: rStart });\n      }\n\n      if (picked.length < 2) {\n        showToast(\"Select two or more WordRef citations to merge.\");\n        return;\n      }\n\n      // Safe manual sort\n      const sorted: Pick[] = [];\n      for (const it of picked) {\n        let placed = false;\n        for (let i = 0; i < sorted.length; i++) {\n          const cmp = it.start.compareLocationWith(sorted[i].start);\n          await ctx.sync();\n          if (cmp.value === Word.LocationRelation.before) {\n            sorted.splice(i, 0, it);\n            placed = true;\n            break;\n          }\n        }\n        if (!placed) sorted.push(it);\n      }\n\n      const ids = sorted.map(p => p.tag.replace(\"wordref-cite:\", \"\"));\n      const mergedText = await renderMergedText(ids, style);\n      const groupTag = \"wordref-group:\" + ids.join(\",\");\n\n      // Move caret away to avoid edit conflicts\n      ctx.document.body.getRange(\"End\").select();\n      await ctx.sync();\n\n      // First CC becomes group\n      const firstCC = sorted[0].cc;\n      firstCC.title = \"WordRef Citation (Group)\";\n      firstCC.tag = groupTag;\n      firstCC.appearance = \"BoundingBox\";\n      firstCC.insertText(mergedText, Word.InsertLocation.replace);\n      await ctx.sync();\n\n      // Delete the rest\n      for (let i = 1; i < sorted.length; i++) {\n        try {\n          sorted[i].cc.delete(false);\n        } catch {\n          try {\n            sorted[i].cc.getRange().insertText(\"\", Word.InsertLocation.replace);\n            await ctx.sync();\n            sorted[i].cc.delete(true);\n          } catch {}\n        }\n      }\n\n      await ctx.sync();\n    });\n  });\n\n  // Recalculate numbering and repaint\n  await guard(\"Post-merge refresh\", async () => {\n    await refreshNumbersAndBibliography();\n    await rerenderGroupCitations(getStyle());\n  });\n\n  showToast(\"Citations merged.\");\n}\nasync function safeDeleteContentControlsById(ids: number[], keepContent = true): Promise<void> {\n  await Word.run(async (ctx) => {\n    const set = ctx.document.contentControls;\n    for (const id of ids) {\n      try {\n        const cc = set.getById(id);\n        cc.load(\"id,cannotDelete,isNullObject\");\n        await ctx.sync();\n\n        if (cc.isNullObject) continue;\n        if (cc.cannotDelete) cc.cannotDelete = false;\n        await ctx.sync();\n\n        cc.delete(keepContent);\n      } catch (e) {\n        console.warn(\"safeDelete failed for CC id:\", id, e);\n      }\n    }\n    await ctx.sync();\n  });\n}\n\nfunction copyCitedBibtexToClipboard(): void {\n  const box = document.getElementById(\"citedBibtexBox\") as HTMLTextAreaElement | null;\n  if (!box) return;\n  box.select();\n  document.execCommand(\"copy\");\n  showToast(\"Cited BibTeX copied to clipboard.\");\n}\n\n\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar code = \"<!doctype html> <html lang=\\\"en\\\"> <head> <meta charset=\\\"utf-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"/> <title>WordRef</title> <link rel=\\\"stylesheet\\\" href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\"/> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> </head> <body> <div class=\\\"app-header\\\"> <h2 class=\\\"app-title\\\">WordRef</h2> <div class=\\\"help-wrap\\\"> <button id=\\\"helpIcon\\\" class=\\\"help-icon\\\" title=\\\"Instructions\\\">i</button> <span id=\\\"helpText\\\" class=\\\"help-text\\\">Instructions</span> </div> </div> <div id=\\\"instructionsModal\\\" class=\\\"backdrop\\\" role=\\\"dialog\\\" aria-modal=\\\"true\\\" aria-labelledby=\\\"instTitle\\\"> <div class=\\\"modal\\\"> <div class=\\\"modal-header\\\"> <div id=\\\"instTitle\\\" class=\\\"modal-title\\\">How to use WordRef</div> <button id=\\\"closeInstructions\\\" class=\\\"modal-close\\\" aria-label=\\\"Close\\\">&times;</button> </div> <div class=\\\"modal-body\\\"> <ol> <li>Search your paper on <strong>Google Scholar</strong>.</li> <li>Click <em>Cite</em>, then choose <em>BibTeX</em>.</li> <li>Paste the BibTeX below and click <strong>Add</strong> (or <strong>Add &amp; Cite</strong>).</li> <li>Re-use items via the <strong>Cite</strong> button in results.</li> <li>Change citation style anytime; in-text &amp; bibliography update.</li> <li>Format the bibliography (font, size, spacing, alignment, color) below.</li> </ol> </div> </div> </div> <div class=\\\"pane\\\"> <textarea id=\\\"bibtexInput\\\" placeholder=\\\"Paste BibTeX entry here\\\"></textarea> <div id=\\\"noteInputs\\\"> <input id=\\\"notePage\\\" placeholder=\\\"Page / para / line\\\"/> <input id=\\\"noteText\\\" placeholder=\\\"Your note (optional)\\\"/> </div> <div id=\\\"controlsRow\\\"> <button id=\\\"btnAddOnly\\\">Add</button> <button id=\\\"btnAddCite\\\">Add &amp; Cite</button> <select id=\\\"styleSelect\\\" aria-label=\\\"Citation style\\\"> <option value=\\\"apa\\\">APA</option> <option value=\\\"ieee\\\">IEEE</option> <option value=\\\"harvard\\\">Harvard</option> <option value=\\\"acs\\\">American Chemical Society</option> <option value=\\\"vancouver\\\">Vancouver</option> </select> </div> <div class=\\\"row\\\" id=\\\"styleBadgeRow\\\"> <span id=\\\"styleBadge\\\" class=\\\"badge\\\">APA</span> </div> <input id=\\\"search\\\" placeholder=\\\"Search author, year, title\\\"/> <div id=\\\"results\\\"></div> <hr/> <div class=\\\"action-row\\\"> <button id=\\\"btnResetNumbering\\\" title=\\\"Forget first-cited order only\\\">Reset numbering</button> <button id=\\\"btnClearLibrary\\\" title=\\\"Delete all saved entries\\\">Clear Library</button> <button id=\\\"btnReload\\\" title=\\\"Reload task pane UI\\\">Reload</button> </div> <div class=\\\"action-row-secondary\\\"> <button id=\\\"btnMergeSelected\\\" class=\\\"btn-outline\\\" title=\\\"Merge selected citations\\\"> Merge citations </button> <button id=\\\"btnUnmergeSelected\\\" class=\\\"btn-outline\\\" title=\\\"Unmerge group citation\\\"> Unmerge citations </button> </div> <div class=\\\"single-action-row\\\"> <button id=\\\"btnUpdateBib\\\" class=\\\"btn-accent\\\"> Update bibliography </button> </div> <section id=\\\"bibFormat\\\"> <div class=\\\"section-title\\\">Bibliography Format</div> <div id=\\\"bibFormatRow\\\"> <div class=\\\"form-chunk\\\"> <label for=\\\"bibFont\\\">Font:</label> <select id=\\\"bibFont\\\"> <option value=\\\"Times New Roman\\\" selected=\\\"selected\\\">Times New Roman</option> <option value=\\\"Calibri\\\">Calibri</option> <option value=\\\"Arial\\\">Arial</option> <option value=\\\"Cambria\\\">Cambria</option> </select> </div> <div class=\\\"form-chunk\\\"> <label for=\\\"bibSize\\\">Size:</label> <input id=\\\"bibSize\\\" type=\\\"number\\\" value=\\\"12\\\" min=\\\"8\\\" max=\\\"24\\\" style=\\\"width:4.5em\\\"> </div> <div class=\\\"form-chunk\\\"> <label for=\\\"bibSpacing\\\">Line spacing:</label> <input id=\\\"bibSpacing\\\" type=\\\"number\\\" value=\\\"14\\\" min=\\\"10\\\" max=\\\"36\\\" style=\\\"width:4.5em\\\"> </div> <div class=\\\"form-chunk\\\"> <label for=\\\"bibAlign\\\">Alignment:</label> <select id=\\\"bibAlign\\\"> <option value=\\\"Left\\\" selected=\\\"selected\\\">Left</option> <option value=\\\"Justified\\\">Justified</option> <option value=\\\"Centered\\\">Centered</option> <option value=\\\"Right\\\">Right</option> </select> </div> <div class=\\\"form-chunk\\\"> <label for=\\\"bibColor\\\">Font color:</label> <input id=\\\"bibColor\\\" class=\\\"swatch\\\" type=\\\"color\\\" value=\\\"#333333\\\"/> </div> </div> </section> </div> <div id=\\\"toast\\\" class=\\\"toast\\\" aria-live=\\\"polite\\\"></div> <div id=\\\"confirmBar\\\" class=\\\"confirm-bar\\\" style=\\\"display:none\\\"> <span id=\\\"confirmMsg\\\"></span> <button id=\\\"confirmYes\\\">Yes</button> <button id=\\\"confirmNo\\\">Cancel</button> </div> <div class=\\\"footer-actions\\\"> <button id=\\\"btnOpenLibPanel\\\">Create library</button> <button id=\\\"btnOpenImportPanel\\\">Import library</button> </div> <div id=\\\"citedLibPanel\\\" class=\\\"sheet hidden\\\"> <div class=\\\"sheet-head\\\"> <div class=\\\"sheet-title\\\">Cited BibTeX</div> <div class=\\\"sheet-actions\\\"> <button id=\\\"btnCitedRefresh\\\">Refresh</button> <button id=\\\"btnCitedCopy\\\">Copy</button> <button id=\\\"btnCitedClose\\\">Close</button> </div> </div> <textarea id=\\\"citedBibtexBox\\\" readonly=\\\"readonly\\\" spellcheck=\\\"false\\\"></textarea> <div class=\\\"hint\\\"> This is generated from the citations in your document. Click <b>Copy</b> to use elsewhere. </div> </div> <div id=\\\"importModal\\\" class=\\\"modal-wrap hidden\\\"> <div class=\\\"modal-backdrop\\\" id=\\\"importBackdrop\\\"></div> <div class=\\\"modal-card\\\"> <div class=\\\"sheet-head\\\"> <div class=\\\"sheet-title\\\">Import BibTeX</div> <div class=\\\"sheet-actions\\\"> <button id=\\\"btnImportParse\\\">Parse &amp; Add</button> <button id=\\\"btnImportClose\\\">Cancel</button> </div> </div> <textarea id=\\\"importBibtexBox\\\" placeholder=\\\"@article{...}\\\\n@inproceedings{...}\\\"></textarea> <div class=\\\"hint\\\">Paste one or more BibTeX entries. Duplicates are skipped.</div> </div> </div> </body> </html>\";\n// Exports\nexport default code;"],"names":["exports","BibtexParser","this","months","notKey","pos","input","entries","Array","currentEntry","setInput","t","getEntries","isWhitespace","s","match","canCommentOut","undefined","skipWhitespace","substring","length","tryMatch","matchAt","value_braces","bracecount","start","escaped","end","value_comment","str","brcktCnt","value_quotes","single_value","k","key","indexOf","toLowerCase","value","values","push","join","key_equals_value","key_value_list","kv","entry_body","d","directive","preamble","comment","entry","bibtex","string","toJSON","b","toBibtex","json","out","i","entryType","citationKey","entryTags","tags","jdx","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","module","__webpack_modules__","m","o","obj","prop","Object","prototype","hasOwnProperty","call","p","document","baseURI","self","location","href","bib","require","parseBibtex","raw","text","trim","map","it","_it$entryTags","id","Math","random","toString","slice","type","fields","createdAt","Date","toISOString","e","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","bind","l","TypeError","done","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","getStore","or","globalThis","OfficeRuntime","storage","getItem","_callee","_context","localStorage","setItem","_callee2","_context2","removeItem","_callee3","_context3","LIB_KEY","ORDER_KEY","getLibrary","_getLibrary","_callee4","_context4","JSON","parse","saveLibrary","_x","_saveLibrary","_callee5","lib","_context5","stringify","upsertEntry","_x2","_upsertEntry","_callee6","_context6","_objectSpread","getCitedOrder","_getCitedOrder","_callee7","_context7","setCitedOrder","_x3","_setCitedOrder","_callee8","ids","_context8","markCited","_x4","_markCited","_callee9","order","_context9","includes","clearCitedOrder","_clearCitedOrder","_callee0","_context0","clearLibrary","_clearLibrary","_callee1","_context1","normalizeStyle","style","formatInText","index","sty","author","editor","split","firstAuthorSurname","year","isNumericStyle","concat","formatBibliographyEntry","title","j","journal","booktitle","volume","number","pages","doi","replace","getOrCreateBibCC","_getOrCreateBibCC","ctx","heading","existing","afterHeading","cc","contentControls","getByTag","load","sync","items","getRange","insertParagraph","Word","InsertLocation","after","insertContentControl","tag","_updateBibliography","opts","seen","list","_args7","Set","filter","has","add","_toConsumableArray","sort","localeCompare","run","_ref3","bibCC","lines","bibText","rng","paras","_iterator3","_step3","body","h","paragraphs","find","styleBuiltIn","BuiltInStyleName","heading1","insertText","_createForOfIteratorHelper","fontName","font","name","fontSize","size","color","alignment","lineSpacing","err","_x11","_rerenderAllCitations","_ref6","controls","_iterator5","_step5","idx","newText","_t2","startsWith","max","_x13","parseBracketIndices","inside","bag","_step","_iterator","_step2","_iterator2","Boolean","part","test","parseInt","_part$split$map2","_slicedToArray","x","min","formatCitationGroup","indices","arr","from","prev","cur","NaN","_insertCitationControl","_callee15","isNumeric","dbg","FORCE_APPEND_END","NO_CC_FALLBACK","SAFE_MODE_NO_MERGE","setSelectedTextAsync","_context15","window","__WORDREF_DEBUG__","NO_CONTENT_CONTROL_FALLBACK","Office","context","setSelectedDataAsync","coercionType","CoercionType","Text","res","status","AsyncResultStatus","Succeeded","_ref8","_callee14","sel","parent","_r2","nums","candidate","_r3","_nums","tryCreateCC","_parent","_para","afterPara","_r4","_context14","getSelection","parentContentControl","isNullObject","getFirst","_callee12","all","_iterator7","_step7","rr","_t3","_context12","compareLocationWith","_ref0","_callee13","range","_context13","appearance","_x16","para","_x15","isArray","_unsupportedIterableToArray","_n","F","next","_arrayLikeToArray","constructor","Cite","insertCitationControl","_x8","_x9","_x0","_x1","updateBibliography","rerenderAllCitations","_x5","_x6","_x7","GROUP_PREFIX","GROUP_TITLE","$","getElementById","getStyle","_$","show","_document$getElementB","classList","remove","hide","_document$getElementB2","getBibFormatOpts","_document$getElementB3","_document$getElementB4","_document$getElementB5","_document$getElementB6","_document$getElementB7","alignRaw","Alignment","centered","right","justified","left","normalizeAlignment","normalizeEntry","_e$createdAt","Error","String","notes","uniqueInOrder","refreshNumbersAndBibliography","_refreshNumbersAndBibliography","idsInDoc","uniqueOrder","cited","getAllCitationIdsInDoc","refreshCitedBibtexPanel","compressNumericList","OfficeExtension","config","extendedErrorLogging","_unused","guard","_guard","_callee11","label","fn","_t7","debugInfo","code","errorLocation","console","error","showToast","message","simpleInsert","_simpleInsert","_ref10","ensureSelection","_cc2","_t9","_ref11","select","warn","_x21","sizeResultsPanel","container","first","querySelector","card","getBoundingClientRect","height","round","gap","maxHeight","updateStyleBadge","badge","ieee","numeric","apa","mla","harvard","acs","vancouver","toUpperCase","textContent","ensureCitedIndex","_ensureCitedIndex","_context16","onAddOnly","_onAddOnly","_callee16","bibbox","parsed","_$14","_$15","where","note","withNotes","_t1","_context17","Bib","refreshResults","flashResultRow","onSelectionChanged","_onSelectionChanged","_callee19","_context20","_callee18","_context19","_ref13","_callee17","doc","firstId","titleText","hits","_context18","parentContentControlOrNullObject","search","matchCase","matchWholeWord","matchPrefix","matchSuffix","matchWildcards","ignoreSpace","ignorePunct","_x22","onAddAndCite","_onAddAndCite","_callee22","_$16","_$17","_iterator8","_step8","base","citeText","np","nt","_t11","_context23","rerenderGroupCitations","onInsertOnly","_onInsertOnly","_callee24","_context25","_callee23","_context24","onResetNumbering","_onResetNumbering","_callee25","_context26","askConfirm","onClearLibraryClick","_onClearLibraryClick","_callee28","_t13","_t14","_t15","_t16","_context29","_ref16","_callee26","_context27","_x24","deleteAllWordRefContentControlsEverywhere","_ref17","_callee27","_context28","_x25","_deleteAllWordRefContentControlsEverywhere","_callee30","_context31","_ref18","_callee29","bodyCcs","sections","victims","pushWordRef","headerTypes","_iterator9","_step9","sec","_iterator0","_step0","ht","hRange","hCcs","_iterator1","_step1","_ht","fRange","fCcs","_i6","_victims","_t20","_t22","_t23","_t25","_context30","ccs","HeaderFooterType","primary","firstPage","evenPages","getHeader","getFooter","cannotDelete","_unused11","delete","_unused12","_x26","onUpdateBib","_onUpdateBib","_callee31","_t26","_context32","addEventListener","reason","_unused2","_unused3","onReady","_$2","_$3","_$4","_$5","_$6","_$7","_$8","_$9","_$0","_$1","_$10","_$11","_$12","_$13","_document$getElementB8","_document$getElementB9","_document$getElementB1","_document$getElementB10","_document$getElementB12","_document$getElementB14","_document$getElementB16","_document$getElementB17","_document$getElementB20","_document$getElementB22","_document$getElementB23","_document$getElementB24","_document$getElementB25","fontColorInput","openImportModal","closeImportModal","copyCitedBibtexToClipboard","onImportBibtexPasted","_t","onExportLibrary","setIoStatus","platformDownloadHint","_document$getElementB0","click","ev","onImportFilePicked","_document$getElementB11","_document$getElementB13","_document$getElementB15","onMergeSelectedCitations","onUnmergeSelectedCitation","backgroundColor","_document$getElementB18","_document$getElementB19","_document$getElementB21","box","q","reasonMsg","isLikelyBibtex","findExistingFromBibtex","onStyleChanged","addHandlerAsync","EventType","DocumentSelectionChanged","styleChangeTimer","styleChangeInFlight","_onStyleChanged","_callee35","_context36","clearTimeout","setTimeout","_callee34","_context35","disabled","_callee33","_context34","_ref21","_callee32","_context33","_x27","toCsvValue","libraryToCsv","rows","headers","keys","_r$h","rowsToCsv","libraryToXml","esc","_ref7","sanitizeFileName","_Office","platform","PlatformType","Mac","OfficeOnline","PC","ioStatusTimer","msg","ttlMs","el","isMac","_Office2","exportViaDialog","filename","data","mime","reject","url","URL","hash","ui","displayDialogAsync","width","displayInIframe","dialog","addEventHandler","DialogMessageReceived","args","_args$message","payload","ok","close","_unused4","DialogEventReceived","_unused5","messageChild","_onExportLibrary","_callee36","_document$getElementB26","_Office3","_Office4","fmt","ext","stamp","isWin","isWeb","isMacPlat","blob","_blob","_url","link","_context37","Blob","createObjectURL","createElement","download","rel","display","appendChild","revokeObjectURL","target","marginTop","wordBreak","_unused17","_unused18","navigator","clipboard","writeText","splitCsvLine","line","inQ","ch","parseCsvToEntries","csv","_loop","cols","get","_split$","slugId","forEach","notesRaw","parseXmlToEntries","xml","dom","DOMParser","parseFromString","querySelectorAll","node","getAttribute","_refreshResults","_callee39","query","filtered","markify","count","_context40","norm","_e$notes","highlightText","innerHTML","_e$notes2","meta","btn","_callee38","_t30","_context39","normTitle","_findExistingFromBibtex","_callee40","needle","nid","hit","nd","_hit","_hit2","_context41","_getAllCitationIdsInDoc","_callee42","_context43","_ref23","_callee41","allCcs","_iterator10","_step10","_start","sorted","_i7","_items2","placed","cmp","_i8","_sorted","_it","_t32","_context42","LocationRelation","before","splice","_x28","haystackHtml","tokens","tok","rx","RegExp","row","CSS","escape","scrollIntoView","behavior","block","bar","yes","no","cleanup","removeEventListener","onYes","onNo","_onImportFilePicked","_callee43","file","_iterator11","_step11","_t33","_t34","_context44","currentTarget","files","endsWith","_onUnmergeSelectedCitation","_callee47","_context48","_callee45","_context46","_ref25","_callee44","selRange","groups","_iterator12","_step12","_cc3","val","validIds","groupRange","cursor","ccRange","_t35","_context45","getByTitle","equal","_x29","_callee46","_context47","_i","_Object$entries","_Object$entries$_i","buildCitedBibtex","_buildCitedBibtex","_callee52","_context53","_refreshCitedBibtexPanel","_callee53","_context54","_onImportBibtexPasted","_callee56","added","skipped","_iterator14","_step14","_t38","_t39","_context57","formatGroupFromIds","_x14","_formatGroupFromIds","_callee57","uniq","numericIdx","alphaBits","_iterator15","_step15","numText","alphaText","_t40","_context58","_rerenderGroupCitations","_callee59","_context60","_ref30","_callee58","_iterator16","_step16","_t41","_context59","_x33","_onMergeSelectedCitations","_callee65","isNumericStyleLocal","renderMergedText","_context66","_ref31","_callee61","styleNow","bits","_iterator18","_step18","_t43","_context62","_x34","_x35","_callee63","_context64","_ref33","_callee62","singles","picked","_iterator19","_step19","rStart","rEnd","cmpA","cmpB","_i9","_picked","mergedText","groupTag","firstCC","_i0","_t44","_context63","_x36","_callee64","_context65","execCommand"],"sourceRoot":""}