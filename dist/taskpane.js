/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={58394:function(e,n,t){"use strict";e.exports=t.p+"7127f8620ec83af19397.css"},96014:function(e,n){!function(e){function n(){this.months=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],this.notKey=[",","{","}"," ","="],this.pos=0,this.input="",this.entries=new Array,this.currentEntry="",this.setInput=function(e){this.input=e},this.getEntries=function(){return this.entries},this.isWhitespace=function(e){return" "==e||"\r"==e||"\t"==e||"\n"==e},this.match=function(e,n){if(null!=n&&null!=n||(n=!0),this.skipWhitespace(n),this.input.substring(this.pos,this.pos+e.length)!=e)throw"Token mismatch, expected "+e+", found "+this.input.substring(this.pos);this.pos+=e.length,this.skipWhitespace(n)},this.tryMatch=function(e,n){return null!=n&&null!=n||(n=!0),this.skipWhitespace(n),this.input.substring(this.pos,this.pos+e.length)==e},this.matchAt=function(){for(;this.input.length>this.pos&&"@"!=this.input[this.pos];)this.pos++;return"@"==this.input[this.pos]},this.skipWhitespace=function(e){for(;this.isWhitespace(this.input[this.pos]);)this.pos++;if("%"==this.input[this.pos]&&1==e){for(;"\n"!=this.input[this.pos];)this.pos++;this.skipWhitespace(e)}},this.value_braces=function(){var e=0;this.match("{",!1);for(var n=this.pos,t=!1;;){if(!t)if("}"==this.input[this.pos]){if(!(e>0)){var r=this.pos;return this.match("}",!1),this.input.substring(n,r)}e--}else if("{"==this.input[this.pos])e++;else if(this.pos>=this.input.length-1)throw"Unterminated value";t="\\"==this.input[this.pos]&&0==t,this.pos++}},this.value_comment=function(){for(var e="",n=0;!this.tryMatch("}",!1)||0!=n;){if(e+=this.input[this.pos],"{"==this.input[this.pos]&&n++,"}"==this.input[this.pos]&&n--,this.pos>=this.input.length-1)throw"Unterminated value:"+this.input.substring(start);this.pos++}return e},this.value_quotes=function(){this.match('"',!1);for(var e=this.pos,n=!1;;){if(!n){if('"'==this.input[this.pos]){var t=this.pos;return this.match('"',!1),this.input.substring(e,t)}if(this.pos>=this.input.length-1)throw"Unterminated value:"+this.input.substring(e)}n="\\"==this.input[this.pos]&&0==n,this.pos++}},this.single_value=function(){var e=this.pos;if(this.tryMatch("{"))return this.value_braces();if(this.tryMatch('"'))return this.value_quotes();var n=this.key();if(n.match("^[0-9]+$"))return n;if(this.months.indexOf(n.toLowerCase())>=0)return n.toLowerCase();throw"Value expected:"+this.input.substring(e)+" for key: "+n},this.value=function(){var e=[];for(e.push(this.single_value());this.tryMatch("#");)this.match("#"),e.push(this.single_value());return e.join("")},this.key=function(){for(var e=this.pos;;){if(this.pos>=this.input.length)throw"Runaway key";if(this.notKey.indexOf(this.input[this.pos])>=0)return this.input.substring(e,this.pos);this.pos++}},this.key_equals_value=function(){var e=this.key();if(this.tryMatch("="))return this.match("="),[e,this.value()];throw"... = value expected, equals sign missing:"+this.input.substring(this.pos)},this.key_value_list=function(){var e=this.key_equals_value();for(this.currentEntry.entryTags={},this.currentEntry.entryTags[e[0]]=e[1];this.tryMatch(",")&&(this.match(","),!this.tryMatch("}"));)e=this.key_equals_value(),this.currentEntry.entryTags[e[0]]=e[1]},this.entry_body=function(e){this.currentEntry={},this.currentEntry.citationKey=this.key(),this.currentEntry.entryType=e.substring(1),this.match(","),this.key_value_list(),this.entries.push(this.currentEntry)},this.directive=function(){return this.match("@"),"@"+this.key()},this.preamble=function(){this.currentEntry={},this.currentEntry.entryType="PREAMBLE",this.currentEntry.entry=this.value_comment(),this.entries.push(this.currentEntry)},this.comment=function(){this.currentEntry={},this.currentEntry.entryType="COMMENT",this.currentEntry.entry=this.value_comment(),this.entries.push(this.currentEntry)},this.entry=function(e){this.entry_body(e)},this.bibtex=function(){for(;this.matchAt();){var e=this.directive();this.match("{"),"@STRING"==e?this.string():"@PREAMBLE"==e?this.preamble():"@COMMENT"==e?this.comment():this.entry(e),this.match("}")}}}e.toJSON=function(e){var t=new n;return t.setInput(e),t.bibtex(),t.entries},e.toBibtex=function(e){var n="";for(var t in e){if(n+="@"+e[t].entryType,n+="{",e[t].citationKey&&(n+=e[t].citationKey+", "),e[t].entry&&(n+=e[t].entry),e[t].entryTags){var r="";for(var a in e[t].entryTags)0!=r.length&&(r+=", "),r+=a+"= {"+e[t].entryTags[a]+"}";n+=r}n+="}\n\n"}return n}}(n)}},n={};function t(r){var a=n[r];if(void 0!==a)return a.exports;var o=n[r]={exports:{}};return e[r](o,o.exports,t),o.exports}t.m=e,t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="/",t.b=document.baseURI||self.location.href,function(){"use strict";var e=t(96014);function n(n){var t=(n||"").trim();return t?(e.toJSON(t)||[]).map(function(e){var n;return{id:e.citationKey||(null===(n=e.entryTags)||void 0===n?void 0:n.citationKey)||"id_"+Math.random().toString(36).slice(2,9),type:e.entryType,fields:e.entryTags||{},createdAt:(new Date).toISOString()}}):[]}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach(function(n){i(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function i(e,n,t){return(n=function(e){var n=function(e){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=r(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function c(){var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",a=t.toStringTag||"@@toStringTag";function o(t,r,a,o){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return u(l,"_invoke",function(t,r,a){var o,c,u,s=0,l=a||[],f=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(n,t){return o=n,c=0,u=e,d.n=t,i}};function p(t,r){for(c=t,u=r,n=0;!f&&s&&!a&&n<l.length;n++){var a,o=l[n],p=d.p,h=o[2];t>3?(a=h===r)&&(u=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=e):o[0]<=p&&((a=t<2&&p<o[1])?(c=0,d.v=r,d.n=o[1]):p<h&&(a=t<3||o[0]>r||r>h)&&(o[4]=t,o[5]=r,d.n=h,c=0))}if(a||t>1)return i;throw f=!0,r}return function(a,l,h){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&p(l,h),c=l,u=h;(n=c<2?e:u)||!f;){o||(c?c<3?(c>1&&(d.n=-1),p(c,u)):d.n=u:d.v=u);try{if(s=2,o){if(c||(a="next"),n=o[a]){if(!(n=n.call(o,u)))throw TypeError("iterator result is not an object");if(!n.done)return n;u=n.value,c<2&&(c=0)}else 1===c&&(n=o.return)&&n.call(o),c<2&&(u=TypeError("The iterator does not provide a '"+a+"' method"),c=1);o=e}else if((n=(f=d.n<0)?u:t.call(r,d))!==i)break}catch(n){o=e,c=1,u=n}finally{s=1}}return{value:n,done:f}}}(t,a,o),!0),l}var i={};function s(){}function l(){}function f(){}n=Object.getPrototypeOf;var d=[][r]?n(n([][r]())):(u(n={},r,function(){return this}),n),p=f.prototype=s.prototype=Object.create(d);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,u(e,a,"GeneratorFunction")),e.prototype=Object.create(p),e}return l.prototype=f,u(p,"constructor",f),u(f,"constructor",l),l.displayName="GeneratorFunction",u(f,a,"GeneratorFunction"),u(p),u(p,a,"Generator"),u(p,r,function(){return this}),u(p,"toString",function(){return"[object Generator]"}),(c=function(){return{w:o,m:h}})()}function u(e,n,t,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}u=function(e,n,t,r){function o(n,t){u(e,n,function(e){return this._invoke(n,t,e)})}n?a?a(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(o("next",0),o("throw",1),o("return",2))},u(e,n,t,r)}function s(e,n,t,r,a,o,i){try{var c=e[o](i),u=c.value}catch(e){return void t(e)}c.done?n(u):Promise.resolve(u).then(r,a)}function l(e){return function(){var n=this,t=arguments;return new Promise(function(r,a){var o=e.apply(n,t);function i(e){s(o,r,a,i,c,"next",e)}function c(e){s(o,r,a,i,c,"throw",e)}i(void 0)})}}function f(){var e=globalThis.OfficeRuntime;return(null==e?void 0:e.storage)||{getItem:function(e){return l(c().m(function n(){return c().w(function(n){for(;;)if(0===n.n)return n.a(2,localStorage.getItem(e))},n)}))()},setItem:function(e,n){return l(c().m(function t(){return c().w(function(t){for(;;)switch(t.n){case 0:localStorage.setItem(e,n);case 1:return t.a(2)}},t)}))()},removeItem:function(e){return l(c().m(function n(){return c().w(function(n){for(;;)switch(n.n){case 0:localStorage.removeItem(e);case 1:return n.a(2)}},n)}))()}}}var d="wordref.library",p="wordref.citedOrder";function h(){return v.apply(this,arguments)}function v(){return(v=l(c().m(function e(){var n;return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,f().getItem(d);case 1:return n=e.v,e.a(2,n?JSON.parse(n):{})}},e)}))).apply(this,arguments)}function m(e){return y.apply(this,arguments)}function y(){return(y=l(c().m(function e(n){return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,f().setItem(d,JSON.stringify(n));case 1:return e.a(2)}},e)}))).apply(this,arguments)}function b(e){return g.apply(this,arguments)}function g(){return(g=l(c().m(function e(n){var t;return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,h();case 1:return(t=e.v)[n.id]=o(o({},t[n.id]||{}),n),e.n=2,m(t);case 2:return e.a(2)}},e)}))).apply(this,arguments)}function w(){return k.apply(this,arguments)}function k(){return(k=l(c().m(function e(){var n;return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,f().getItem(p);case 1:return n=e.v,e.a(2,n?JSON.parse(n):[])}},e)}))).apply(this,arguments)}function E(e){return O.apply(this,arguments)}function O(){return(O=l(c().m(function e(n){return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,f().setItem(p,JSON.stringify(n));case 1:return e.a(2)}},e)}))).apply(this,arguments)}function I(e){return S.apply(this,arguments)}function S(){return(S=l(c().m(function e(n){var t;return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,w();case 1:if((t=e.v).includes(n)){e.n=2;break}return t.push(n),e.n=2,E(t);case 2:return e.a(2)}},e)}))).apply(this,arguments)}function x(){return L.apply(this,arguments)}function L(){return(L=l(c().m(function e(){return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,f().removeItem(p);case 1:return e.a(2)}},e)}))).apply(this,arguments)}function j(){return C.apply(this,arguments)}function C(){return(C=l(c().m(function e(){return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,f().removeItem(d);case 1:return e.a(2)}},e)}))).apply(this,arguments)}function T(e){return function(e){if(Array.isArray(e))return P(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||R(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,o,i,c=[],u=!0,s=!1;try{if(o=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;u=!1}else for(;!(u=(r=o.call(t)).done)&&(c.push(r.value),c.length!==n);u=!0);}catch(e){s=!0,a=e}finally{try{if(!u&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,n)||R(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=R(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(c)throw o}}}}function R(e,n){if(e){if("string"==typeof e)return P(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?P(e,n):void 0}}function P(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function A(){var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",a=t.toStringTag||"@@toStringTag";function o(t,r,a,o){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return _(s,"_invoke",function(t,r,a){var o,c,u,s=0,l=a||[],f=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(n,t){return o=n,c=0,u=e,d.n=t,i}};function p(t,r){for(c=t,u=r,n=0;!f&&s&&!a&&n<l.length;n++){var a,o=l[n],p=d.p,h=o[2];t>3?(a=h===r)&&(u=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=e):o[0]<=p&&((a=t<2&&p<o[1])?(c=0,d.v=r,d.n=o[1]):p<h&&(a=t<3||o[0]>r||r>h)&&(o[4]=t,o[5]=r,d.n=h,c=0))}if(a||t>1)return i;throw f=!0,r}return function(a,l,h){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&p(l,h),c=l,u=h;(n=c<2?e:u)||!f;){o||(c?c<3?(c>1&&(d.n=-1),p(c,u)):d.n=u:d.v=u);try{if(s=2,o){if(c||(a="next"),n=o[a]){if(!(n=n.call(o,u)))throw TypeError("iterator result is not an object");if(!n.done)return n;u=n.value,c<2&&(c=0)}else 1===c&&(n=o.return)&&n.call(o),c<2&&(u=TypeError("The iterator does not provide a '"+a+"' method"),c=1);o=e}else if((n=(f=d.n<0)?u:t.call(r,d))!==i)break}catch(n){o=e,c=1,u=n}finally{s=1}}return{value:n,done:f}}}(t,a,o),!0),s}var i={};function c(){}function u(){}function s(){}n=Object.getPrototypeOf;var l=[][r]?n(n([][r]())):(_(n={},r,function(){return this}),n),f=s.prototype=c.prototype=Object.create(l);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,_(e,a,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,_(f,"constructor",s),_(s,"constructor",u),u.displayName="GeneratorFunction",_(s,a,"GeneratorFunction"),_(f),_(f,a,"Generator"),_(f,r,function(){return this}),_(f,"toString",function(){return"[object Generator]"}),(A=function(){return{w:o,m:d}})()}function _(e,n,t,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}_=function(e,n,t,r){function o(n,t){_(e,n,function(e){return this._invoke(n,t,e)})}n?a?a(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(o("next",0),o("throw",1),o("return",2))},_(e,n,t,r)}function N(e,n,t,r,a,o,i){try{var c=e[o](i),u=c.value}catch(e){return void t(e)}c.done?n(u):Promise.resolve(u).then(r,a)}function M(e){return function(){var n=this,t=arguments;return new Promise(function(r,a){var o=e.apply(n,t);function i(e){N(o,r,a,i,c,"next",e)}function c(e){N(o,r,a,i,c,"throw",e)}i(void 0)})}}function D(e){return(e||"apa").toLowerCase()}function U(e,n,t){var r=D(n),a=function(e){return(e.fields.author||e.fields.editor||"Anon").split(" and ")[0].split(",")[0].trim()}(e),o=e.fields.year||"n.d.";return function(e){return"ieee"===(e=D(e))||"numeric"===e||"vancouver"===e||"acs"===e}(r)?"[".concat(t,"]"):"(".concat(a,", ").concat(o,")")}function F(e,n,t){var r=D(n),a=e.fields.author||e.fields.editor||"Anon",o=e.fields.year||"n.d.",i=e.fields.title||"",c=e.fields.journal||e.fields.booktitle||"",u=e.fields.volume?"".concat(e.fields.volume):"",s=e.fields.number?"(".concat(e.fields.number,")"):"",l=e.fields.pages?", ".concat(e.fields.pages):"",f=e.fields.doi?" https://doi.org/".concat(e.fields.doi):"";switch(r){case"ieee":case"numeric":return"[".concat(t,"] ").concat(a,". “").concat(i,",” ").concat(c," ").concat(u).concat(s).concat(l,", ").concat(o,".").concat(f);case"vancouver":return"".concat(t,". ").concat(a,". ").concat(i,". ").concat(c," ").concat(o).concat(u?";".concat(u):"").concat(s?"(".concat(s,")"):"").concat(l?":".concat(l.replace(", ","-").replace(/^, /,"")):"",".");case"harvard":return"".concat(a,", ").concat(o,". ").concat(i,". ").concat(c).concat(u?", ".concat(u):"").concat(s?" ".concat(s):"").concat(l,".");case"acs":return"".concat(a,". ").concat(i,". ").concat(c," ").concat(o).concat(u?", ".concat(u):"").concat(s?" ".concat(s):"").concat(l,".");default:return"".concat(a," (").concat(o,"). ").concat(i,". ").concat(c).concat(u?", ".concat(u):"").concat(s?" ".concat(s):"").concat(l,".").concat(f)}}function G(e,n){return q.apply(this,arguments)}function q(){return(q=M(A().m(function e(n,t){var r,a,o,i;return A().w(function(e){for(;;)switch(e.n){case 0:return(r=n.document.contentControls.getByTag("wordref-bibliography")).load("items"),e.n=1,n.sync();case 1:if(!(r.items.length>0)){e.n=2;break}return e.a(2,r.items[0]);case 2:return a=t.getRange("End"),o=a.insertParagraph("",Word.InsertLocation.after),(i=o.insertContentControl()).tag="wordref-bibliography",i.title="WordRef Bibliography",e.a(2,i)}},e)}))).apply(this,arguments)}function $(){return $=M(A().m(function e(n){var t,r,a,o,i=arguments;return A().w(function(e){for(;;)switch(e.n){case 0:return t=i.length>1&&void 0!==i[1]?i[1]:"apa",r=i.length>2?i[2]:void 0,a=new Set,o=n.filter(function(e){return!a.has(e.id)&&(a.add(e.id),!0)}),["apa","harvard","mla"].includes((t||"apa").toLowerCase())&&(o=T(o).sort(function(e,n){return(e.fields.author||"").localeCompare(n.fields.author||"")})),e.n=1,Word.run(function(){var e=M(A().m(function e(n){var a,i,c,u,s,l,f,d,p;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,M(A().m(function e(){var t,r,a;return A().w(function(e){for(;;)switch(e.n){case 0:return t=n.document.body,(r=t.paragraphs).load("items,text"),e.n=1,n.sync();case 1:if(a=r.items.find(function(e){return"references"===e.text.trim().toLowerCase()}),a){e.n=2;break}return(a=t.insertParagraph("References",Word.InsertLocation.end)).styleBuiltIn=Word.BuiltInStyleName.heading1,t.insertParagraph("",Word.InsertLocation.end),e.n=2,n.sync();case 2:return e.a(2,a)}},e)}))();case 1:return a=e.v,e.n=2,G(n,a);case 2:return i=e.v,c=o.map(function(e,n){return F(e,t,n+1)}),u=c.join("\n"),i.insertText(u,Word.InsertLocation.replace),e.n=3,n.sync();case 3:return e.p=3,s=i.getRange(),(l=s.paragraphs).load("items/font"),e.n=4,n.sync();case 4:f=B(l.items);try{for(f.s();!(d=f.n()).done;)p=d.value,null!=r&&r.fontName&&(p.font.name=r.fontName),null!=r&&r.fontSize&&(p.font.size=r.fontSize),null!=r&&r.color&&(p.font.color=r.color),null!=r&&r.alignment&&(p.alignment=r.alignment),null!=r&&r.lineSpacing&&(p.lineSpacing=r.lineSpacing)}catch(e){f.e(e)}finally{f.f()}e.n=6;break;case 5:e.p=5,e.v;case 6:return e.n=7,n.sync();case 7:return e.a(2)}},e,null,[[3,5]])}));return function(n){return e.apply(this,arguments)}}());case 1:return e.a(2)}},e)})),$.apply(this,arguments)}function J(){return J=M(A().m(function e(n,t,r){return A().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Word.run(function(){var e=M(A().m(function e(a){var o,i,c,u,s,l,f,d,p,h;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:return(o=a.document.contentControls).load("items/tag"),e.n=1,a.sync();case 1:i=o.items.filter(function(e){return(e.tag||"").startsWith("wordref-cite:")}),c=B(i),e.p=2,c.s();case 3:if((u=c.n()).done){e.n=6;break}if(s=u.value,l=(s.tag||"").split(":")[1],f=r[l]){e.n=4;break}return e.a(3,5);case 4:d=Math.max(0,t.indexOf(l))+1,p=U(f,n,d),s.insertText(p,Word.InsertLocation.replace);case 5:e.n=3;break;case 6:e.n=8;break;case 7:e.p=7,h=e.v,c.e(h);case 8:return e.p=8,c.f(),e.f(8);case 9:return e.n=10,a.sync();case 10:return e.a(2)}},e,null,[[2,7,8,9]])}));return function(n){return e.apply(this,arguments)}}());case 1:return e.a(2)}},e)})),J.apply(this,arguments)}function H(e){var n=e.match(/\[(.*?)\]/g),t=[];if(!n)return t;var r,a=B(n);try{for(a.s();!(r=a.n()).done;){var o,i=B(r.value.replace(/^\[|\]$/g,"").split(",").map(function(e){return e.trim()}).filter(Boolean));try{for(i.s();!(o=i.n()).done;){var c=o.value;if(/^\d+$/.test(c))t.push(parseInt(c,10));else if(/^\d+\s*-\s*\d+$/.test(c))for(var u=W(c.split("-").map(function(e){return parseInt(e.trim(),10)}),2),s=u[0],l=u[1],f=Math.min(s,l);f<=Math.max(s,l);f++)t.push(f)}}catch(e){i.e(e)}finally{i.f()}}}catch(e){a.e(e)}finally{a.f()}return t}function K(e){var n=Array.from(new Set(e)).sort(function(e,n){return e-n});if(!n.length)return"[]";for(var t=[],r=n[0],a=n[0],o=1;o<=n.length;o++){var i=n[o];i!==a+1?(r===a?t.push("".concat(r)):a===r+1?t.push("".concat(r),"".concat(a)):t.push("".concat(r,"-").concat(a)),r=null!=i?i:NaN,a=null!=i?i:NaN):a=i}return"[".concat(t.join(", "),"]")}function z(){return z=M(A().m(function e(n,t,r,a){var o,i,c,u,s,l,f;return A().w(function(e){for(;;)if(0===e.n)return o=(r||"apa").toLowerCase(),i=["ieee","numeric","vancouver","acs"].includes(o),c=window.__WORDREF_DEBUG__||{},u=!!c.FORCE_APPEND_END,s=!1!==c.NO_CONTENT_CONTROL_FALLBACK,l=!!c.SAFE_MODE_NO_MERGE,f=function(e){return new Promise(function(n){Office.context.document.setSelectedDataAsync(e,{coercionType:Office.CoercionType.Text},function(e){return n(e.status===Office.AsyncResultStatus.Succeeded)})})},e.a(2,Word.run(function(){var e=M(A().m(function e(r){var o,c,d,p,h,v,m,y,b,g,w,k,E,O,I;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:if(o=r.document.body,!u){e.n=2;break}return o.insertParagraph("",Word.InsertLocation.end).getRange("Start").insertText(t,Word.InsertLocation.replace),e.n=1,r.sync();case 1:return e.a(2);case 2:return(c=r.document.getSelection()).load("text,parentContentControl,paragraphs"),e.n=3,r.sync();case 3:if(l){e.n=6;break}if(!(d=c.parentContentControl)||d.isNullObject||!(d.tag||"").startsWith("wordref-cite:")||!i||"number"!=typeof a){e.n=6;break}return(p=d.getRange()).load("text"),e.n=4,r.sync();case 4:return(h=H(p.text)).push(a),d.insertText(K(h),Word.InsertLocation.replace),e.n=5,r.sync();case 5:return e.a(2);case 6:if(l||!i||"number"!=typeof a){e.n=14;break}return e.p=7,c.paragraphs.getFirst().load("text"),e.n=8,r.sync();case 8:return e.n=9,M(A().m(function e(){var n,t,a,o,i,u,s;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:return(n=r.document.contentControls).load("items/tag"),e.n=1,r.sync();case 1:t=n.items.filter(function(e){return(e.tag||"").startsWith("wordref-cite:")}),a=B(t),e.p=2,a.s();case 3:if((o=a.n()).done){e.n=6;break}return i=o.value,(u=i.getRange()).load("text"),e.n=4,r.sync();case 4:if("Equal"!==u.getRange("End").compareLocationWith(c).value){e.n=5;break}return e.a(2,i);case 5:e.n=3;break;case 6:e.n=8;break;case 7:e.p=7,s=e.v,a.e(s);case 8:return e.p=8,a.f(),e.f(8);case 9:return e.a(2,null)}},e,null,[[2,7,8,9]])}))();case 9:if(!(v=e.v)){e.n=12;break}return(m=v.getRange()).load("text"),e.n=10,r.sync();case 10:return(y=H(m.text)).push(a),v.insertText(K(y),Word.InsertLocation.replace),e.n=11,r.sync();case 11:return e.a(2);case 12:e.n=14;break;case 13:e.p=13,e.v;case 14:return b=function(){var e=M(A().m(function e(a){var o;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,(o=a.insertContentControl()).tag="wordref-cite:".concat(n.id),o.title="WordRef Citation",o.appearance="BoundingBox",o.insertText(t,Word.InsertLocation.replace),e.n=1,r.sync();case 1:return e.a(2,!0);case 2:if(e.p=2,e.v,!s){e.n=4;break}return e.n=3,f(t);case 3:if(!e.v){e.n=4;break}return e.a(2,!0);case 4:return e.a(2,!1)}},e,null,[[0,2]])}));return function(n){return e.apply(this,arguments)}}(),e.n=15,b(c);case 15:if(!e.v){e.n=16;break}return e.a(2);case 16:if(e.p=16,!(g=c.parentContentControl)||g.isNullObject||(g.tag||"").startsWith("wordref-cite:")){e.n=18;break}return w=c.paragraphs.getFirst(),k=w.getRange("End").insertParagraph("",Word.InsertLocation.after),E=k.getRange("Start"),e.n=17,b(E);case 17:if(!e.v){e.n=18;break}return e.a(2);case 18:e.n=20;break;case 19:e.p=19,e.v;case 20:return e.n=21,f(t);case 21:if(!e.v){e.n=22;break}return e.a(2);case 22:return O=o.insertParagraph("",Word.InsertLocation.end),I=O.getRange("Start"),e.n=23,b(I);case 23:if(e.v){e.n=24;break}return I.insertText(t,Word.InsertLocation.replace),e.n=24,r.sync();case 24:return e.a(2)}},e,null,[[16,19],[7,13]])}));return function(n){return e.apply(this,arguments)}}()))},e)})),z.apply(this,arguments)}function X(e){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X(e)}function V(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function Y(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?V(Object(t),!0).forEach(function(n){Q(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):V(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Q(e,n,t){return(n=function(e){var n=function(e){if("object"!=X(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=X(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==X(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function Z(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,o,i,c=[],u=!0,s=!1;try{if(o=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;u=!1}else for(;!(u=(r=o.call(t)).done)&&(c.push(r.value),c.length!==n);u=!0);}catch(e){s=!0,a=e}finally{try{if(!u&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,n)||ie(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ee(e){return function(e){if(Array.isArray(e))return ce(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ie(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ne(){var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",a=t.toStringTag||"@@toStringTag";function o(t,r,a,o){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return te(s,"_invoke",function(t,r,a){var o,c,u,s=0,l=a||[],f=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(n,t){return o=n,c=0,u=e,d.n=t,i}};function p(t,r){for(c=t,u=r,n=0;!f&&s&&!a&&n<l.length;n++){var a,o=l[n],p=d.p,h=o[2];t>3?(a=h===r)&&(u=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=e):o[0]<=p&&((a=t<2&&p<o[1])?(c=0,d.v=r,d.n=o[1]):p<h&&(a=t<3||o[0]>r||r>h)&&(o[4]=t,o[5]=r,d.n=h,c=0))}if(a||t>1)return i;throw f=!0,r}return function(a,l,h){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&p(l,h),c=l,u=h;(n=c<2?e:u)||!f;){o||(c?c<3?(c>1&&(d.n=-1),p(c,u)):d.n=u:d.v=u);try{if(s=2,o){if(c||(a="next"),n=o[a]){if(!(n=n.call(o,u)))throw TypeError("iterator result is not an object");if(!n.done)return n;u=n.value,c<2&&(c=0)}else 1===c&&(n=o.return)&&n.call(o),c<2&&(u=TypeError("The iterator does not provide a '"+a+"' method"),c=1);o=e}else if((n=(f=d.n<0)?u:t.call(r,d))!==i)break}catch(n){o=e,c=1,u=n}finally{s=1}}return{value:n,done:f}}}(t,a,o),!0),s}var i={};function c(){}function u(){}function s(){}n=Object.getPrototypeOf;var l=[][r]?n(n([][r]())):(te(n={},r,function(){return this}),n),f=s.prototype=c.prototype=Object.create(l);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,te(e,a,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,te(f,"constructor",s),te(s,"constructor",u),u.displayName="GeneratorFunction",te(s,a,"GeneratorFunction"),te(f),te(f,a,"Generator"),te(f,r,function(){return this}),te(f,"toString",function(){return"[object Generator]"}),(ne=function(){return{w:o,m:d}})()}function te(e,n,t,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}te=function(e,n,t,r){function o(n,t){te(e,n,function(e){return this._invoke(n,t,e)})}n?a?a(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(o("next",0),o("throw",1),o("return",2))},te(e,n,t,r)}function re(e,n,t,r,a,o,i){try{var c=e[o](i),u=c.value}catch(e){return void t(e)}c.done?n(u):Promise.resolve(u).then(r,a)}function ae(e){return function(){var n=this,t=arguments;return new Promise(function(r,a){var o=e.apply(n,t);function i(e){re(o,r,a,i,c,"next",e)}function c(e){re(o,r,a,i,c,"throw",e)}i(void 0)})}}function oe(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=ie(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(c)throw o}}}}function ie(e,n){if(e){if("string"==typeof e)return ce(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?ce(e,n):void 0}}function ce(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}var ue=U,se=function(e,n,t,r){return z.apply(this,arguments)},le=function(e){return $.apply(this,arguments)},fe=function(e,n,t){return J.apply(this,arguments)},de="wordref-group:",pe="WordRef Citation (Group)",he=function(e){return document.getElementById(e)},ve=function(){var e;return((null===(e=he("styleSelect"))||void 0===e?void 0:e.value)||"apa").toLowerCase()};function me(e){var n;null===(n=document.getElementById(e))||void 0===n||n.classList.remove("hidden")}function ye(e){var n;null===(n=document.getElementById(e))||void 0===n||n.classList.add("hidden")}function be(){var e,n,t,r,a,o=(null===(e=document.getElementById("bibFont"))||void 0===e?void 0:e.value)||"Times New Roman",i=parseInt((null===(n=document.getElementById("bibSize"))||void 0===n?void 0:n.value)||"12",10),c=parseInt((null===(t=document.getElementById("bibSpacing"))||void 0===t?void 0:t.value)||"14",10),u=(null===(r=document.getElementById("bibAlign"))||void 0===r?void 0:r.value)||"Left",s=(null===(a=document.getElementById("bibColor"))||void 0===a?void 0:a.value)||"#333333";return{fontName:o,fontSize:i,lineSpacing:c,alignment:function(e){switch((e||"").toLowerCase()){case"center":case"centered":return Word.Alignment.centered;case"right":return Word.Alignment.right;case"justify":case"justified":return Word.Alignment.justified;default:return Word.Alignment.left}}(u),color:s}}function ge(e){var n;if(!e||!e.id)throw new Error("normalizeEntry: missing id");return{id:String(e.id),type:e.type||"misc",fields:e.fields||{},notes:e.notes||[],createdAt:null!==(n=e.createdAt)&&void 0!==n?n:(new Date).toISOString()}}function we(e){var n,t=new Set,r=[],a=oe(e);try{for(a.s();!(n=a.n()).done;){var o=n.value;t.has(o)||(t.add(o),r.push(o))}}catch(e){a.e(e)}finally{a.f()}return r}function ke(){return Ee.apply(this,arguments)}function Ee(){return(Ee=ae(ne().m(function e(){var n,t,r,a,o;return ne().w(function(e){for(;;)switch(e.n){case 0:return n=ve(),e.n=1,h();case 1:return t=e.v,e.n=2,wn();case 2:return r=e.v,a=we(r),e.n=3,E(a);case 3:return e.n=4,fe(n,a,t);case 4:return o=a.map(function(e){return t[e]}).filter(Boolean),e.n=5,le(o,n,be());case 5:return e.n=6,Rn();case 6:return e.a(2)}},e)}))).apply(this,arguments)}function Oe(e){if(!e.length)return"";for(var n=[],t=e[0],r=e[0],a=1;a<e.length;a++){var o=e[a];o!==r+1?(n.push(t===r?String(t):"".concat(t,"–").concat(r)),t=r=o):r=o}return n.push(t===r?String(t):"".concat(t,"–").concat(r)),n.join(",")}try{OfficeExtension.config.extendedErrorLogging=!0}catch(e){}function Ie(e,n){return Se.apply(this,arguments)}function Se(){return(Se=ae(ne().m(function e(n,t){var r,a;return ne().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,t();case 1:return e.a(2,e.v);case 2:return e.p=2,a=e.v,r=null!=a&&a.debugInfo?" [".concat(a.debugInfo.code||""," @ ").concat(a.debugInfo.errorLocation||"","]"):"",console.error("[WordRef] ".concat(n," failed:"),a,null==a?void 0:a.debugInfo),En("".concat(n," failed: ").concat((null==a?void 0:a.message)||String(a)).concat(r)),e.a(2,void 0)}},e,null,[[0,2]])}))).apply(this,arguments)}function xe(e,n){return Le.apply(this,arguments)}function Le(){return Le=ae(ne().m(function e(n,t){var r,a,o;return ne().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,w();case 1:if(r=e.v,-1!==(a=r.indexOf(n.id))){e.n=4;break}return e.n=2,I(n.id);case 2:return e.n=3,w();case 3:r=e.v,a=r.indexOf(n.id);case 4:return o=ue(n,t,a>=0?a+1:1),e.n=5,Word.run(function(){var e=ae(ne().m(function e(t){var r,a,i,c,u,s,l,f;return ne().w(function(e){for(;;)switch(e.p=e.n){case 0:return r=t.document.body,a=function(){var e=ae(ne().m(function e(){var n;return ne().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,(n=t.document.getSelection()).load("text"),e.n=1,t.sync();case 1:return e.a(2,n);case 2:return e.p=2,e.v,r.getRange("End").select(),e.n=3,t.sync();case 3:return e.a(2,t.document.getSelection())}},e,null,[[0,2]])}));return function(){return e.apply(this,arguments)}}(),e.p=1,e.n=2,a();case 2:return i=e.v,(c=i.insertContentControl()).tag="wordref-cite:".concat(n.id),c.title="WordRef Citation",c.appearance="BoundingBox",c.insertText(o,Word.InsertLocation.replace),e.n=3,t.sync();case 3:case 5:return e.a(2);case 4:return e.p=4,f=e.v,console.warn("[WordRef] selection CC insert failed; will append at end",f),u=r.insertParagraph("",Word.InsertLocation.end),s=u.getRange("Start"),(l=s.insertContentControl()).tag="wordref-cite:".concat(n.id),l.title="WordRef Citation",l.appearance="BoundingBox",l.insertText(o,Word.InsertLocation.replace),e.n=5,t.sync()}},e,null,[[1,4]])}));return function(n){return e.apply(this,arguments)}}());case 5:return e.a(2)}},e)})),Le.apply(this,arguments)}function je(){var e=document.getElementById("results");if(e){var n=e.querySelector(".item");if(n){var t=n.getBoundingClientRect().height||120,r=Math.round(2*t+8+16);e.style.maxHeight="".concat(r,"px")}}}function Ce(){var e=document.getElementById("styleBadge");if(e){var n=ve(),t={ieee:"IEEE (numeric)",numeric:"Numeric",apa:"APA",mla:"MLA",harvard:"Harvard",acs:"ACS",vancouver:"Vancouver"}[n]||n.toUpperCase();e.textContent=t}}function Te(e){return We.apply(this,arguments)}function We(){return(We=ae(ne().m(function e(n){var t,r;return ne().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,w();case 1:if(t=e.v,-1!==(r=t.indexOf(n))){e.n=4;break}return e.n=2,I(n);case 2:return e.n=3,w();case 3:t=e.v,r=t.indexOf(n);case 4:return e.a(2,r+1)}},e)}))).apply(this,arguments)}function Be(){return Re.apply(this,arguments)}function Re(){return(Re=ae(ne().m(function e(){var t,r,a,o,i,c,u,s,l,f,d,p,v,m;return ne().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=he("bibtexInput")){e.n=1;break}return e.a(2);case 1:if(r=t.value.trim()){e.n=2;break}return e.a(2);case 2:a=[],e.p=3,o=n(r),a=o.map(function(e){return ge(e)}),e.n=5;break;case 4:return e.p=4,e.v,En("Could not parse the BibTeX you pasted."),e.a(2);case 5:return e.n=6,h();case 6:i=e.v,c=oe(a),e.p=7,c.s();case 8:if((u=c.n()).done){e.n=12;break}if(f=u.value,!i[f.id]){e.n=10;break}return e.n=9,pn("");case 9:return In(document.getElementById("results"),f.id),En("Already in your library (key: ".concat(f.id,").")),e.a(3,11);case 10:return d=(null===(s=he("notePage"))||void 0===s?void 0:s.value.trim())||"",p=(null===(l=he("noteText"))||void 0===l?void 0:l.value.trim())||"",v=d||p?ge(Y(Y({},f),{},{notes:[{where:d,text:p}]})):f,e.n=11,b(v);case 11:e.n=8;break;case 12:e.n=14;break;case 13:e.p=13,m=e.v,c.e(m);case 14:return e.p=14,c.f(),e.f(14);case 15:return t.value="",e.n=16,pn("");case 16:return e.a(2)}},e,null,[[7,13,14,15],[3,4]])}))).apply(this,arguments)}function Pe(){return Ae.apply(this,arguments)}function Ae(){return Ae=ae(ne().m(function e(){return ne().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Ie("Selection change",ae(ne().m(function e(){return ne().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Word.run(function(){var e=ae(ne().m(function e(n){var t,r,a,o,i,c,u,s,l,f,d,p,v;return ne().w(function(e){for(;;)switch(e.n){case 0:return t=n.document,(r=t.getSelection()).load("text"),(a=r.parentContentControlOrNullObject).load("tag,title,isNullObject"),e.n=1,n.sync();case 1:if(r.text&&r.text.trim()){e.n=2;break}return e.a(2);case 2:if(!a.isNullObject){e.n=3;break}return e.a(2);case 3:if(o=a.tag||"",i=a.title||"",c=[],"WordRef Citation"!==i||!o.startsWith("wordref-cite:")){e.n=4;break}c=[o.slice(13).trim()],e.n=6;break;case 4:if(i!==pe||!o.startsWith(de)){e.n=5;break}c=o.slice(14).split(",").map(function(e){return e.trim()}).filter(Boolean),e.n=6;break;case 5:case 14:return e.a(2);case 6:if(c.length){e.n=7;break}return e.a(2);case 7:return u=c[0],e.n=8,h();case 8:if(s=e.v,l=s[u]){e.n=9;break}return e.a(2);case 9:if(f=(l.fields.title||"").trim()){e.n=10;break}return e.a(2);case 10:return d=t.body,(p=d.search(f,{matchCase:!1,matchWholeWord:!1,matchPrefix:!1,matchSuffix:!1,matchWildcards:!1,ignoreSpace:!0,ignorePunct:!0})).load("items"),e.n=11,n.sync();case 11:if(p.items.length){e.n=12;break}return e.a(2);case 12:return(v=p.items[0].paragraphs.getFirst()).load("text"),e.n=13,n.sync();case 13:return v.select(),e.n=14,n.sync()}},e)}));return function(n){return e.apply(this,arguments)}}());case 1:return e.a(2)}},e)})));case 1:return e.a(2)}},e)})),Ae.apply(this,arguments)}function _e(){return Ne.apply(this,arguments)}function Ne(){return(Ne=ae(ne().m(function e(){var t,r,a,o,i,c,u,s,l,f,d,p,v,m,y,g,w,k,E;return ne().w(function(e){for(;;)switch(e.p=e.n){case 0:if(a=he("bibtexInput")){e.n=1;break}return e.a(2);case 1:if(o=a.value.trim()){e.n=2;break}return e.a(2);case 2:i=(null===(t=he("notePage"))||void 0===t?void 0:t.value.trim())||"",c=(null===(r=he("noteText"))||void 0===r?void 0:r.value.trim())||"",u=ve(),s=[],e.p=3,l=n(o),s=l.map(function(e){return ge(e)}),e.n=5;break;case 4:return e.p=4,e.v,En("Could not parse the BibTeX you pasted."),e.a(2);case 5:return e.n=6,h();case 6:f=e.v,d=oe(s),e.p=7,d.s();case 8:if((p=d.n()).done){e.n=20;break}if(v=p.value,!f[v.id]){e.n=10;break}return e.n=9,pn("");case 9:return In(document.getElementById("results"),v.id),En("Already cited/added (".concat(v.id,").")),e.a(3,19);case 10:return m=i||c?ge(Y(Y({},v),{},{notes:[{where:i,text:c}]})):v,e.n=11,b(m);case 11:return f[m.id]=m,e.n=12,Te(m.id);case 12:return y=e.v,g=ue(m,u,y),e.n=13,xe(m,u);case 13:return e.n=14,ke();case 14:return e.n=15,Un(ve());case 15:e.n=19;break;case 16:return e.n=17,se(m,g,u,y);case 17:return e.n=18,ke();case 18:return e.n=19,Un(ve());case 19:e.n=8;break;case 20:e.n=22;break;case 21:e.p=21,E=e.v,d.e(E);case 22:return e.p=22,d.f(),e.f(22);case 23:return a.value="",(w=he("notePage"))&&(w.value=""),(k=he("noteText"))&&(k.value=""),e.n=24,pn("");case 24:return e.n=25,Rn();case 25:return e.a(2)}},e,null,[[7,21,22,23],[3,4]])}))).apply(this,arguments)}function Me(){return De.apply(this,arguments)}function De(){return(De=ae(ne().m(function e(){var n,t,r,a;return ne().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,h();case 1:if(n=e.v,(t=Object.values(n)).length){e.n=2;break}return e.a(2);case 2:return r=t[0],a=ve(),e.n=3,Ie("Insert citation",ae(ne().m(function e(){var n,t;return ne().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Te(r.id);case 1:return n=e.v,t=ue(r,a,n),e.n=2,xe(r,a);case 2:e.n=4;break;case 3:return e.n=4,se(r,t,a,n);case 4:return e.n=5,ke();case 5:return e.n=6,Un(ve());case 6:return e.a(2)}},e)})));case 3:return e.a(2)}},e)}))).apply(this,arguments)}function Ue(){return Fe.apply(this,arguments)}function Fe(){return(Fe=ae(ne().m(function e(){return ne().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Sn("Reset numbering? This re-numbers all citations from [1] based on current document order.");case 1:if(e.v){e.n=2;break}return e.a(2);case 2:return e.n=3,x();case 3:return e.n=4,ke();case 4:return e.n=5,Un(ve());case 5:En("Numbering reset and citations reflowed.");case 6:return e.a(2)}},e)}))).apply(this,arguments)}function Ge(){return qe.apply(this,arguments)}function qe(){return qe=ae(ne().m(function e(){var n,t,r,a;return ne().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,Sn("Clear ENTIRE library and numbering? This removes all in-document WordRef citations and resets your library. This cannot be undone.");case 1:if(e.v){e.n=2;break}return e.a(2);case 2:return e.p=2,e.n=3,Word.run(function(){var e=ae(ne().m(function e(n){return ne().w(function(e){for(;;)switch(e.n){case 0:return n.document.body.getRange("End").select(),e.n=1,n.sync();case 1:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}());case 3:e.n=5;break;case 4:e.p=4,e.v;case 5:return e.p=5,e.n=6,$e();case 6:e.n=8;break;case 7:e.p=7,n=e.v,console.warn("[WordRef] deleteAllWordRefContentControlsEverywhere failed:",n);case 8:return e.p=8,e.n=9,j();case 9:e.n=11;break;case 10:e.p=10,t=e.v,console.warn("[WordRef] clearLibrary failed:",t);case 11:return e.p=11,e.n=12,x();case 12:e.n=14;break;case 13:e.p=13,r=e.v,console.warn("[WordRef] clearCitedOrder failed:",r);case 14:return e.p=14,e.n=15,Word.run(function(){var e=ae(ne().m(function e(n){return ne().w(function(e){for(;;)switch(e.n){case 0:return n.document.body.getRange("End").select(),e.n=1,n.sync();case 1:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}());case 15:return e.n=16,le([],ve());case 16:e.n=18;break;case 17:e.p=17,a=e.v,console.warn("[WordRef] updateBibliography([]) failed (non-fatal):",a);case 18:return e.p=18,e.n=19,pn("");case 19:e.n=21;break;case 20:e.p=20,e.v;case 21:return e.p=21,e.n=22,Rn();case 22:e.n=24;break;case 23:e.p=23,e.v;case 24:En("Library and in-document citations cleared.");case 25:return e.a(2)}},e,null,[[21,23],[18,20],[14,17],[11,13],[8,10],[5,7],[2,4]])})),qe.apply(this,arguments)}function $e(){return Je.apply(this,arguments)}function Je(){return Je=ae(ne().m(function e(){return ne().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Word.run(function(){var e=ae(ne().m(function e(n){var t,r,a,o,i,c,u,s,l,f,d,p,h,v,m,y,b,g,w,k,E,O,I,S,x,L,j;return ne().w(function(e){for(;;)switch(e.p=e.n){case 0:return(t=n.document.contentControls).load("items/tag,items/id,items/cannotDelete"),(r=n.document.sections).load("items"),e.n=1,n.sync();case 1:return a=[],(o=function(e){return e.load("items/tag,items/id,items/cannotDelete"),e})(t),e.n=2,n.sync();case 2:a.push.apply(a,ee(t.items.filter(function(e){var n=e.tag||"";return n.startsWith("wordref-cite:")||n.startsWith("wordref-group:")}))),i=[Word.HeaderFooterType.primary,Word.HeaderFooterType.firstPage,Word.HeaderFooterType.evenPages],c=oe(r.items),e.p=3,c.s();case 4:if((u=c.n()).done){e.n=25;break}s=u.value,l=oe(i),e.p=5,l.s();case 6:if((f=l.n()).done){e.n=11;break}return d=f.value,e.p=7,p=s.getHeader(d),h=p.getRange(),v=h.contentControls,o(v),e.n=8,n.sync();case 8:a.push.apply(a,ee(v.items.filter(function(e){var n=e.tag||"";return n.startsWith("wordref-cite:")||n.startsWith("wordref-group:")}))),e.n=10;break;case 9:e.p=9,e.v;case 10:e.n=6;break;case 11:e.n=13;break;case 12:e.p=12,S=e.v,l.e(S);case 13:return e.p=13,l.f(),e.f(13);case 14:m=oe(i),e.p=15,m.s();case 16:if((y=m.n()).done){e.n=21;break}return b=y.value,e.p=17,g=s.getFooter(b),w=g.getRange(),k=w.contentControls,o(k),e.n=18,n.sync();case 18:a.push.apply(a,ee(k.items.filter(function(e){var n=e.tag||"";return n.startsWith("wordref-cite:")||n.startsWith("wordref-group:")}))),e.n=20;break;case 19:e.p=19,e.v;case 20:e.n=16;break;case 21:e.n=23;break;case 22:e.p=22,x=e.v,m.e(x);case 23:return e.p=23,m.f(),e.f(23);case 24:e.n=4;break;case 25:e.n=27;break;case 26:e.p=26,L=e.v,c.e(L);case 27:return e.p=27,c.f(),e.f(27);case 28:return e.p=28,n.document.body.getRange("End").select(),e.n=29,n.sync();case 29:e.n=31;break;case 30:e.p=30,e.v;case 31:E=0,O=a;case 32:if(!(E<O.length)){e.n=39;break}return I=O[E],e.p=33,I.cannotDelete&&(I.cannotDelete=!1),e.n=34,n.sync();case 34:try{I.getRange().insertText("",Word.InsertLocation.replace)}catch(e){}return e.n=35,n.sync();case 35:try{I.delete(!0)}catch(e){I.delete(!1)}return e.n=36,n.sync();case 36:e.n=38;break;case 37:e.p=37,j=e.v,console.warn("[WordRef] CC delete failed for id",I.id,j);case 38:E++,e.n=32;break;case 39:return e.a(2)}},e,null,[[33,37],[28,30],[17,19],[15,22,23,24],[7,9],[5,12,13,14],[3,26,27,28]])}));return function(n){return e.apply(this,arguments)}}());case 1:return e.a(2)}},e)})),Je.apply(this,arguments)}function He(){return Ke.apply(this,arguments)}function Ke(){return(Ke=ae(ne().m(function e(){var n;return ne().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,ke();case 1:return e.n=2,Un(ve());case 2:e.n=4;break;case 3:e.p=3,n=e.v,console.error("updateBibliography failed",n),En("Update bibliography failed. "+(n&&n.debugInfo?JSON.stringify(n.debugInfo):String(n)));case 4:return e.a(2)}},e,null,[[0,3]])}))).apply(this,arguments)}window.addEventListener("unhandledrejection",function(e){var n=e.reason,t=null!=n&&n.debugInfo?" [".concat(n.debugInfo.code||""," @ ").concat(n.debugInfo.errorLocation||"","]"):"";console.error("Unhandled rejection:",n,null==n?void 0:n.debugInfo);try{En("Unexpected error: "+((null==n?void 0:n.message)||String(n))+t)}catch(e){}}),window.addEventListener("error",function(e){var n=e.error,t=null!=n&&n.debugInfo?" [".concat(n.debugInfo.code||""," @ ").concat(n.debugInfo.errorLocation||"","]"):"";console.error("Window error:",n,null==n?void 0:n.debugInfo);try{En("Unexpected error: "+((null==n?void 0:n.message)||String(n))+t)}catch(e){}}),Office.onReady(ae(ne().m(function e(){var n,t,r,a,o,i,c,u,s,l,f,d,p,h,v,m,y,b,g,w,k,E,O,I,S,x,L,j,C,T,W;return ne().w(function(e){for(;;)switch(e.n){case 0:return null===(n=he("btnAddOnly"))||void 0===n||n.addEventListener("click",Be),null===(t=he("btnAddCite"))||void 0===t||t.addEventListener("click",_e),null===(r=he("btnInsertCite"))||void 0===r||r.addEventListener("click",Me),null===(a=he("btnUpdateBib"))||void 0===a||a.addEventListener("click",He),null===(o=he("btnResetNumbering"))||void 0===o||o.addEventListener("click",Ue),null===(i=he("btnClearLibrary"))||void 0===i||i.addEventListener("click",Ge),null===(c=he("btnReload"))||void 0===c||c.addEventListener("click",function(){Ie("Reload UI",ae(ne().m(function e(){var n,t,r,a;return ne().w(function(e){for(;;)switch(e.n){case 0:return(n=document.getElementById("bibtexInput"))&&(n.value=""),(t=document.getElementById("notePage"))&&(t.value=""),(r=document.getElementById("noteText"))&&(r.value=""),(a=document.getElementById("search"))&&(a.value=""),e.n=1,pn("");case 1:return e.n=2,Rn();case 2:Ce(),En("WordRef panel reloaded.");case 3:return e.a(2)}},e)})))}),null===(u=he("btnOpenLibPanel"))||void 0===u||u.addEventListener("click",ae(ne().m(function e(){return ne().w(function(e){for(;;)switch(e.n){case 0:return me("citedLibPanel"),e.n=1,Rn();case 1:return e.a(2)}},e)}))),null===(s=he("btnOpenImportPanel"))||void 0===s||s.addEventListener("click",function(){document.getElementById("importBibtexBox").value="",me("importLibPanel")}),null===(l=he("btnCitedClose"))||void 0===l||l.addEventListener("click",function(){return ye("citedLibPanel")}),null===(f=he("btnCitedRefresh"))||void 0===f||f.addEventListener("click",function(){Rn()}),null===(d=he("btnCitedCopy"))||void 0===d||d.addEventListener("click",$n),null===(p=he("btnImportClose"))||void 0===p||p.addEventListener("click",function(){return ye("importLibPanel")}),null===(h=he("btnImportParse"))||void 0===h||h.addEventListener("click",function(){An()}),e.n=1,Rn();case 1:return null===(v=document.getElementById("btnExport"))||void 0===v||v.addEventListener("click",ae(ne().m(function e(){var n;return ne().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,un();case 1:an(tn()),e.n=3;break;case 2:e.p=2,n=e.v,an("Export failed. See console.",5e3),console.error(n);case 3:return e.a(2)}},e,null,[[0,2]])}))),null===(m=document.getElementById("btnImport"))||void 0===m||m.addEventListener("click",function(){var e;null===(e=document.getElementById("importFile"))||void 0===e||e.click()}),null===(y=document.getElementById("importFile"))||void 0===y||y.addEventListener("change",function(e){xn(e)}),null===(b=document.getElementById("helpIcon"))||void 0===b||b.addEventListener("click",function(){var e;null===(e=document.getElementById("instructionsModal"))||void 0===e||e.classList.add("show")}),null===(g=document.getElementById("helpText"))||void 0===g||g.addEventListener("click",function(){var e;null===(e=document.getElementById("instructionsModal"))||void 0===e||e.classList.add("show")}),null===(w=document.getElementById("closeInstructions"))||void 0===w||w.addEventListener("click",function(){var e;null===(e=document.getElementById("instructionsModal"))||void 0===e||e.classList.remove("show")}),null===(k=document.getElementById("btnMergeSelected"))||void 0===k||k.addEventListener("click",function(){Gn()}),null===(E=document.getElementById("btnUnmergeSelected"))||void 0===E||E.addEventListener("click",function(){jn()}),null==(j=document.getElementById("bibColor"))||j.addEventListener("input",function(){j.style.backgroundColor=j.value}),C=function(){var e;null===(e=document.getElementById("importModal"))||void 0===e||e.classList.remove("hidden"),document.body.classList.add("body-no-scroll")},T=function(){var e;null===(e=document.getElementById("importModal"))||void 0===e||e.classList.add("hidden"),document.body.classList.remove("body-no-scroll")},null===(O=document.getElementById("btnOpenImportPanel"))||void 0===O||O.addEventListener("click",function(){var e;null===(e=document.getElementById("citedLibPanel"))||void 0===e||e.classList.add("hidden");var n=document.getElementById("importBibtexBox");n&&(n.value=""),C()}),null===(I=document.getElementById("btnImportClose"))||void 0===I||I.addEventListener("click",T),null===(S=document.getElementById("importBackdrop"))||void 0===S||S.addEventListener("click",T),null===(x=document.getElementById("btnImportParse"))||void 0===x||x.addEventListener("click",ae(ne().m(function e(){return ne().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,An();case 1:T();case 2:return e.a(2)}},e)}))),null==(W=he("search"))||W.addEventListener("input",ae(ne().m(function e(){var n,t,r;return ne().w(function(e){for(;;)switch(e.n){case 0:if(!yn(n=W.value)){e.n=3;break}return e.n=1,bn(n);case 1:return t=e.v,e.n=2,pn("");case 2:if(null==t||!t.id){e.n=3;break}return In(document.getElementById("results"),t.id),r="citationKey"===t.reason?"citation key":t.reason.toUpperCase(),En("Already in your library (matched by ".concat(r,").")),e.a(2);case 3:return e.n=4,pn(n);case 4:return e.n=5,Rn();case 5:return e.a(2)}},e)}))),Ce(),null===(L=document.getElementById("styleSelect"))||void 0===L||L.addEventListener("change",Ve),Office.context.document.addHandlerAsync(Office.EventType.DocumentSelectionChanged,function(){Pe()}),e.n=2,pn("");case 2:return e.a(2)}},e)}))),window.addEventListener("resize",function(){return je()});var ze=null,Xe=!1;function Ve(){return Ye.apply(this,arguments)}function Ye(){return Ye=ae(ne().m(function e(){return ne().w(function(e){for(;;)switch(e.n){case 0:ze&&clearTimeout(ze),ze=window.setTimeout(ae(ne().m(function e(){var n;return ne().w(function(e){for(;;)switch(e.n){case 0:if(!Xe){e.n=1;break}return e.a(2);case 1:return Xe=!0,(n=document.getElementById("styleSelect"))&&(n.disabled=!0),e.n=2,Ie("Change citation style",ae(ne().m(function e(){return ne().w(function(e){for(;;)switch(e.n){case 0:return Ce(),e.n=1,Word.run(function(){var e=ae(ne().m(function e(n){return ne().w(function(e){for(;;)switch(e.n){case 0:return n.document.body.getRange("End").select(),e.n=1,n.sync();case 1:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}());case 1:return e.n=2,ke();case 2:return e.n=3,Un(ve());case 3:return e.n=4,Rn();case 4:return e.a(2)}},e)})));case 2:n&&(n.disabled=!1),Xe=!1;case 3:return e.a(2)}},e)})),150);case 1:return e.a(2)}},e)})),Ye.apply(this,arguments)}function Qe(e){var n=(null!=e?e:"").toString();return/[",\n]/.test(n)?'"'.concat(n.replace(/"/g,'""'),'"'):n}function Ze(e){return function(e){if(!e.length)return"";var n=Object.keys(e[0]);return[n.map(function(e){return Qe(e)}).join(",")].concat(ee(e.map(function(e){return n.map(function(n){var t;return Qe(null!==(t=e[n])&&void 0!==t?t:"")}).join(",")}))).join("\n")}(Object.values(e).map(function(e){return{id:e.id,title:e.fields.title||"",author:e.fields.author||e.fields.editor||"",year:e.fields.year||"",journal:e.fields.journal||"",booktitle:e.fields.booktitle||"",volume:e.fields.volume||"",number:e.fields.number||"",pages:e.fields.pages||"",doi:e.fields.doi||"",notes:(e.notes||[]).map(function(e){return"".concat(e.where||""," ").concat(e.text||"").trim()}).join(" | ")}}))}function en(e){var n=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},t=Object.values(e).map(function(e){var t=Object.entries(e.fields||{}).map(function(e){var t=Z(e,2),r=t[0],a=t[1];return'<field name="'.concat(n(r),'">').concat(n(String(null!=a?a:"")),"</field>")}).join(""),r=(e.notes||[]).map(function(e){return'<note where="'.concat(n(e.where||""),'">').concat(n(e.text||""),"</note>")}).join("");return'<entry id="'.concat(n(e.id),'">').concat(t).concat(r,"</entry>")}).join("");return'<?xml version="1.0" encoding="UTF-8"?><wordref>'.concat(t,"</wordref>")}function nn(e){return(e||"").replace(/[\\/:*?"<>|]/g,"").trim()||"wordref-library"}function tn(){var e;switch(null===(e=Office)||void 0===e||null===(e=e.context)||void 0===e?void 0:e.platform){case Office.PlatformType.Mac:return"Saved to your Mac Downloads folder (~/Downloads).";case Office.PlatformType.OfficeOnline:return"Saved to your browser's Downloads folder.";case Office.PlatformType.PC:return"Saved to your Windows Downloads folder.";default:return"Saved to your Downloads folder."}}var rn=null;function an(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3500,t=document.getElementById("ioStatus");t&&(t.textContent=e,t.classList.remove("hide"),rn&&window.clearTimeout(rn),rn=window.setTimeout(function(){t.textContent="",t.classList.add("hide"),rn=null},n))}function on(){var e;return(null===(e=Office)||void 0===e||null===(e=e.context)||void 0===e?void 0:e.platform)===Office.PlatformType.Mac}function cn(e,n,t){return new Promise(function(r,a){var o,i=((o=new URL(window.location.href)).hash="download-dialog",o.toString());Office.context.ui.displayDialogAsync(i,{height:35,width:30,displayInIframe:!on()},function(o){if(o.status===Office.AsyncResultStatus.Succeeded&&o.value){var i=o.value;i.addEventHandler(Office.EventType.DialogMessageReceived,function(e){try{var n,t=JSON.parse(String(null!==(n=null==e?void 0:e.message)&&void 0!==n?n:"{}"));null!=t&&t.ok?r():a(new Error((null==t?void 0:t.error)||"Download failed"))}catch(e){a(e instanceof Error?e:new Error(String(e)))}finally{try{i.close()}catch(e){}}}),i.addEventHandler(Office.EventType.DialogEventReceived,function(e){try{a(new Error("Dialog error code: ".concat(null==e?void 0:e.error)))}finally{try{i.close()}catch(e){}}}),i.messageChild(JSON.stringify({filename:e,data:n,mime:t}))}else a(new Error("Dialog failed to open"))})})}function un(){return sn.apply(this,arguments)}function sn(){return(sn=ae(ne().m(function e(){var n,t,r,a,o,i,c,u,s,l,f,d,p,v,m,y,b,g,w;return ne().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,h();case 1:if(a=e.v,o=((null===(n=document.getElementById("exportFormat"))||void 0===n?void 0:n.value)||"json").toLowerCase(),i="",c="application/json",u="json","csv"===o?(i=Ze(a),c="text/csv",u="csv"):"xml"===o?(i=en(a),c="application/xml",u="xml"):i=JSON.stringify(a,null,2),s=(new Date).toISOString().slice(0,19).replace(/[:T]/g,"-"),l=nn("wordref-library-".concat(s,".").concat(u)),f=(null===(t=Office)||void 0===t||null===(t=t.context)||void 0===t?void 0:t.platform)===Office.PlatformType.PC,d=(null===(r=Office)||void 0===r||null===(r=r.context)||void 0===r?void 0:r.platform)===Office.PlatformType.OfficeOnline,p=on(),!f&&!d){e.n=4;break}return e.p=2,v=new Blob([i],{type:c}),m=URL.createObjectURL(v),(y=document.createElement("a")).href=m,y.download=l,y.rel="noopener",y.style.display="none",document.body.appendChild(y),y.click(),y.remove(),URL.revokeObjectURL(m),En("".concat(l," saved to your Downloads folder.")),e.a(2);case 3:e.p=3,e.v;case 4:if(!p){e.n=8;break}return e.p=5,e.n=6,cn(l,i,c);case 6:return En("Exported as ".concat(l," (check ~/Downloads).")),e.a(2);case 7:e.p=7,e.v;case 8:try{b=new Blob([i],{type:c}),g=URL.createObjectURL(b),(w=document.createElement("a")).textContent="Download ".concat(l),w.href=g,w.download=l,w.target="_blank",w.rel="noopener",w.style.display="inline-block",w.style.marginTop="8px",w.style.wordBreak="break-all",(document.getElementById("toast")||document.body).appendChild(w),En("Click to download. If blocked, try right-click → Save link as…"),setTimeout(function(){try{URL.revokeObjectURL(g)}catch(e){}},6e4)}catch(e){}if("application/json"!==c&&!c.startsWith("text/")){e.n=12;break}return e.p=9,e.n=10,navigator.clipboard.writeText(i);case 10:En("Also copied to clipboard (".concat(u.toUpperCase(),").")),e.n=12;break;case 11:e.p=11,e.v;case 12:return e.a(2)}},e,null,[[9,11],[5,7],[2,3]])}))).apply(this,arguments)}function ln(e){for(var n=[],t="",r=!1,a=0;a<e.length;a++){var o=e[a];r?'"'===o&&'"'===e[a+1]?(t+='"',a++):'"'===o?r=!1:t+=o:'"'===o?r=!0:","===o?(n.push(t),t=""):t+=o}return n.push(t),n}function fn(e){var n=e.replace(/\r/g,"").split("\n").filter(Boolean);if(!n.length)return[];for(var t=ln(n[0]).map(function(e){return e.trim().toLowerCase()}),r=[],a=function(){var e=ln(n[o]),a=function(n){var r=function(e){return t.indexOf(e)}(n);return r>=0?(e[r]||"").trim():""},i=a("id")||function(){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=((arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")||"").toLowerCase().replace(/[^a-z0-9]+/g,"-").slice(0,32).replace(/^-|-$/g,"");return[(null===(e=(n||"").split(/[,\s]/)[0])||void 0===e?void 0:e.toLowerCase())||"anon",r||"item",t||"nd"].filter(Boolean).join("-")}(a("title"),a("author"),a("year")),c={title:a("title"),author:a("author"),year:a("year"),journal:a("journal"),booktitle:a("booktitle"),volume:a("volume"),number:a("number"),pages:a("pages"),doi:a("doi")};Object.keys(c).forEach(function(e){c[e]||delete c[e]});var u=a("notes"),s=u?u.split(" | ").map(function(e){return{where:"",text:e}}):[];r.push(ge({id:i,type:"misc",fields:c,notes:s}))},o=1;o<n.length;o++)a();return r}function dn(e){var n=(new DOMParser).parseFromString(e,"application/xml");if(n.querySelector("parsererror"))return[];var t=[];return n.querySelectorAll("entry").forEach(function(e){var n=e.getAttribute("id")||"",r={};e.querySelectorAll("field").forEach(function(e){var n=e.getAttribute("name")||"";r[n]=e.textContent||""});var a=Array.from(e.querySelectorAll("note")).map(function(e){return{where:e.getAttribute("where")||"",text:e.textContent||""}});n&&t.push(ge({id:n,type:"misc",fields:r,notes:a}))}),t}function pn(e){return hn.apply(this,arguments)}function hn(){return(hn=ae(ne().m(function e(n){var t,r,a,o,i,c,u;return ne().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,h();case 1:if(t=e.v,r=Object.values(t),a=vn(n||""),o=a?r.filter(function(e){var n;return[e.id,e.fields.title,e.fields.author,e.fields.year,e.fields.journal,e.fields.booktitle,e.fields.doi].concat(ee((null===(n=e.notes)||void 0===n?void 0:n.map(function(e){return"".concat(e.where||""," ").concat(e.text||"")}))||[])).join(" ").toLowerCase().includes(a)}):r,i=he("results")){e.n=2;break}return e.a(2);case 2:c=function(e){return a?On(e,n):e},i.innerHTML=o.map(function(e){var n,t=c(e.fields.title||e.id),r=c("".concat(e.fields.author||"Anon"," — ").concat(e.fields.year||"n.d.")),a=((null===(n=e.notes)||void 0===n?void 0:n.map(function(e){return'<div class="note">'.concat(c("🔖 ".concat(e.where||""," ").concat(e.text||"")),"</div>")}))||[]).join("");return'\n      <div class="row item" data-id="'.concat(e.id,'">\n        <div class="grow">\n          <div class="title">').concat(t,'</div>\n          <div class="meta">').concat(r,"</div>\n          ").concat(a,'\n        </div>\n        <button class="cite-btn" data-id="').concat(e.id,'">Cite</button>\n      </div>\n    ')}).join(""),i.querySelectorAll("button.cite-btn").forEach(function(e){e.addEventListener("click",ae(ne().m(function n(){var t,r,a,o,i,c,u;return ne().w(function(n){for(;;)switch(n.p=n.n){case 0:if(t=e.getAttribute("data-id")){n.n=1;break}return n.a(2);case 1:return n.n=2,h();case 2:if(r=n.v,a=r[t]){n.n=3;break}return n.a(2);case 3:return o=ve(),n.n=4,Te(a.id);case 4:return i=n.v,c=ue(a,o,i),n.p=5,n.n=6,xe(a,o);case 6:return n.n=7,ke();case 7:return n.n=8,Un(ve());case 8:n.n=12;break;case 9:return n.n=10,se(a,c,o,i);case 10:return n.n=11,ke();case 11:return n.n=12,Un(ve());case 12:n.n=14;break;case 13:n.p=13,u=n.v,console.error("Insert citation error:",u,null==u?void 0:u.debugInfo),En("Insert citation failed: "+(null!=u&&u.debugInfo?JSON.stringify(u.debugInfo):String(u)));case 14:return n.a(2)}},n,null,[[5,13]])})))}),(u=document.getElementById("libCount"))&&(u.textContent="".concat(o.length," item").concat(1===o.length?"":"s")),je();case 3:return e.a(2)}},e)}))).apply(this,arguments)}function vn(e){return(e||"").toLowerCase().replace(/\s+/g," ").trim()}function mn(e){return vn(e).replace(/[^a-z0-9 ]/g,"")}function yn(e){return/@\w+\s*\{[\s\S]*\}/.test(e)}function bn(e){return gn.apply(this,arguments)}function gn(){return(gn=ae(ne().m(function e(t){var r,a,o,i,c,u,s,l,f,d;return ne().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,h();case 1:r=e.v,a=Object.values(r),e.p=2,o=n(t),e.n=4;break;case 3:return e.p=3,e.v,e.a(2,null);case 4:if(o.length){e.n=5;break}return e.a(2,null);case 5:if(i=o[0],!(c=(i.id||"").trim())){e.n=6;break}if(!(u=a.find(function(e){return e.id===c}))){e.n=6;break}return e.a(2,{id:u.id,reason:"citationKey"});case 6:if(!(s=vn(i.fields.doi||""))){e.n=7;break}if(!(l=a.find(function(e){return vn(e.fields.doi||"")===s}))){e.n=7;break}return e.a(2,{id:l.id,reason:"doi"});case 7:if(!(f=mn(i.fields.title||""))){e.n=8;break}if(!(d=a.find(function(e){return mn(e.fields.title||"")===f}))){e.n=8;break}return e.a(2,{id:d.id,reason:"title"});case 8:return e.a(2,null)}},e,null,[[2,3]])}))).apply(this,arguments)}function wn(){return kn.apply(this,arguments)}function kn(){return kn=ae(ne().m(function e(){return ne().w(function(e){for(;;)if(0===e.n)return e.a(2,Word.run(function(){var e=ae(ne().m(function e(n){var t,r,a,o,i,c,u,s,l,f,d,p,h,v,m,y,b,g,w,k,E,O,I,S,x;return ne().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=n.document,(r=t.contentControls).load("items/tag,items/title"),e.n=1,n.sync();case 1:a=[],o=oe(r.items),e.p=2,o.s();case 3:if((i=o.n()).done){e.n=9;break}if(c=i.value,u=c.tag||"",s=c.title||"",u){e.n=4;break}return e.a(3,8);case 4:if("WordRef Citation"!==s||!u.startsWith("wordref-cite:")){e.n=6;break}if(l=u.slice(13).trim()){e.n=5;break}return e.a(3,8);case 5:f=c.getRange("Start"),a.push({ids:[l],start:f});case 6:if(s!==pe||!u.startsWith(de)){e.n=8;break}if(d=u.slice(14),(p=d.split(",").map(function(e){return e.trim()}).filter(Boolean)).length){e.n=7;break}return e.a(3,8);case 7:h=c.getRange("Start"),a.push({ids:p,start:h});case 8:e.n=3;break;case 9:e.n=11;break;case 10:e.p=10,x=e.v,o.e(x);case 11:return e.p=11,o.f(),e.f(11);case 12:v=[],m=0,y=a;case 13:if(!(m<y.length)){e.n=19;break}b=y[m],g=!1,w=0;case 14:if(!(w<v.length)){e.n=17;break}return k=b.start.compareLocationWith(v[w].start),e.n=15,n.sync();case 15:if(k.value!==Word.LocationRelation.before){e.n=16;break}return v.splice(w,0,b),g=!0,e.a(3,17);case 16:w++,e.n=14;break;case 17:g||v.push(b);case 18:m++,e.n=13;break;case 19:for(E=[],O=0,I=v;O<I.length;O++)S=I[O],E.push.apply(E,ee(S.ids));return e.a(2,E)}},e,null,[[2,10,11,12]])}));return function(n){return e.apply(this,arguments)}}()))},e)})),kn.apply(this,arguments)}function En(e){var n=document.getElementById("toast");n&&(n.textContent=e,n.classList.add("show"),setTimeout(function(){return n.classList.remove("show")},1800))}function On(e,n){var t=n.trim();if(!t)return e;var r=t.split(/\s+/).filter(Boolean).map(function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")});if(!r.length)return e;var a=new RegExp("(".concat(r.join("|"),")"),"gi");return e.replace(a,"<mark>$1</mark>")}function In(e,n){var t=e.querySelector('.item[data-id="'.concat(CSS.escape(n),'"]'));t&&(t.classList.add("hit-highlight"),t.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(function(){return t.classList.remove("hit-highlight")},1200))}function Sn(e){return new Promise(function(n){var t=document.getElementById("confirmBar"),r=document.getElementById("confirmMsg"),a=document.getElementById("confirmYes"),o=document.getElementById("confirmNo");r.textContent=e,t.style.display="flex";var i=function(){t.style.display="none",a.removeEventListener("click",c),o.removeEventListener("click",u)},c=function(){i(),n(!0)},u=function(){i(),n(!1)};a.addEventListener("click",c),o.addEventListener("click",u)})}function xn(e){return Ln.apply(this,arguments)}function Ln(){return(Ln=ae(ne().m(function e(n){var t,r,a,o,i,c,u,s,l,f,d,p;return ne().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=n.currentTarget,r=t.files&&t.files[0]){e.n=1;break}return e.a(2);case 1:return e.p=1,e.n=2,r.text();case 2:if(a=e.v,o=r.name.toLowerCase(),i=[],!o.endsWith(".json")){e.n=3;break}c=JSON.parse(a),u=Array.isArray(c)?c:Object.values(c||{}),i=u.filter(function(e){return e&&e.id}).map(function(e){return ge(e)}),e.n=6;break;case 3:if(!o.endsWith(".csv")){e.n=4;break}i=fn(a),e.n=6;break;case 4:if(!o.endsWith(".xml")){e.n=5;break}i=dn(a),e.n=6;break;case 5:return En("Unsupported file. Use .json, .csv, or .xml."),t.value="",e.a(2);case 6:if(i.length){e.n=7;break}return En("No entries found in file."),t.value="",e.a(2);case 7:s=oe(i),e.p=8,s.s();case 9:if((l=s.n()).done){e.n=11;break}return f=l.value,e.n=10,b(f);case 10:e.n=9;break;case 11:e.n=13;break;case 12:e.p=12,d=e.v,s.e(d);case 13:return e.p=13,s.f(),e.f(13);case 14:return e.n=15,pn("");case 15:En("Imported ".concat(i.length," entr").concat(1===i.length?"y":"ies",".")),e.n=17;break;case 16:e.p=16,p=e.v,console.error("Import failed:",p),En("Import failed. Check console for details.");case 17:return e.p=17,t.value="",e.f(17);case 18:return e.a(2)}},e,null,[[8,12,13,14],[1,16,17,18]])}))).apply(this,arguments)}function jn(){return Cn.apply(this,arguments)}function Cn(){return Cn=ae(ne().m(function e(){var n;return ne().w(function(e){for(;;)switch(e.n){case 0:return ve(),e.n=1,h();case 1:return n=e.v,e.n=2,w();case 2:return e.v,e.n=3,Ie("Unmerge citations",ae(ne().m(function e(){return ne().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Word.run(function(){var e=ae(ne().m(function e(t){var r,a,o,i,c,u,s,l,f,d,p,h,v,m,y,b,g,w,k,E;return ne().w(function(e){for(;;)switch(e.p=e.n){case 0:return r=t.document.getSelection(),a=r.getRange(),(o=t.document.contentControls.getByTitle(pe)).load("items/tag"),e.n=1,t.sync();case 1:i=null,c=oe(o.items),e.p=2,c.s();case 3:if((u=c.n()).done){e.n=6;break}return s=u.value,l=s.getRange(),f=l.compareLocationWith(a),e.n=4,t.sync();case 4:if((d=f.value)!==Word.LocationRelation.inside&&d!==Word.LocationRelation.equal){e.n=5;break}return i=s,e.a(3,6);case 5:e.n=3;break;case 6:e.n=8;break;case 7:e.p=7,E=e.v,c.e(E);case 8:return e.p=8,c.f(),e.f(8);case 9:if(i){e.n=10;break}return En("Place the cursor inside a merged citation to unmerge."),e.a(2);case 10:if((p=i.tag||"").startsWith(de)){e.n=11;break}return En("This citation is not a merged group."),e.a(2);case 11:if((h=p.slice(14).split(",").map(function(e){return e.trim()}).filter(Boolean)).length){e.n=12;break}return En("Group is empty."),e.a(2);case 12:if(v=h.filter(function(e){return!!n[e]}),v.length){e.n=13;break}return En("No valid entries in group."),e.a(2);case 13:for(m=i.getRange(),y=m.insertText("",Word.InsertLocation.before),b=0;b<v.length;b++)g=v[b],b>0&&(y=y.insertText(" ",Word.InsertLocation.after)),w=y.insertText("",Word.InsertLocation.after),(k=w.insertContentControl()).title="WordRef Citation",k.tag="wordref-cite:".concat(g),k.appearance="BoundingBox",y=k.getRange("End");e.p=14,i.delete(!1),e.n=19;break;case 15:return e.p=15,e.v,e.p=16,i.getRange().insertText("",Word.InsertLocation.replace),e.n=17,t.sync();case 17:i.delete(!0),e.n=19;break;case 18:e.p=18,e.v;case 19:return e.n=20,t.sync();case 20:return e.a(2)}},e,null,[[16,18],[14,15],[2,7,8,9]])}));return function(n){return e.apply(this,arguments)}}());case 1:return e.a(2)}},e)})));case 3:return e.n=4,Ie("Refresh after unmerge",ae(ne().m(function e(){return ne().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,ke();case 1:return e.n=2,Un(ve());case 2:return e.a(2)}},e)})));case 4:En("Citations unmerged.");case 5:return e.a(2)}},e)})),Cn.apply(this,arguments)}function Tn(e){for(var n=e.type||"misc",t=e.id,r=e.fields||{},a=["@".concat(n,"{").concat(t,",")],o=0,i=Object.entries(r);o<i.length;o++){var c=Z(i[o],2),u=c[0],s=c[1];s&&a.push("  ".concat(u," = {").concat(String(s),"},"))}return a[a.length-1]=a[a.length-1].replace(/,+$/,""),a.push("}"),a.join("\n")}function Wn(){return Bn.apply(this,arguments)}function Bn(){return(Bn=ae(ne().m(function e(){var n,t,r;return ne().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,w();case 1:return n=e.v,e.n=2,h();case 2:return t=e.v,r=n.map(function(e){return t[e]}).filter(Boolean),e.a(2,r.map(Tn).join("\n\n"))}},e)}))).apply(this,arguments)}function Rn(){return Pn.apply(this,arguments)}function Pn(){return(Pn=ae(ne().m(function e(){var n;return ne().w(function(e){for(;;)switch(e.n){case 0:if(n=document.getElementById("citedBibtexBox")){e.n=1;break}return e.a(2);case 1:return e.n=2,Wn();case 2:n.value=e.v;case 3:return e.a(2)}},e)}))).apply(this,arguments)}function An(){return _n.apply(this,arguments)}function _n(){return(_n=ae(ne().m(function e(){var t,r,a,o,i,c,u,s,l,f,d;return ne().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=document.getElementById("importBibtexBox")){e.n=1;break}return e.a(2);case 1:if(r=(t.value||"").trim()){e.n=2;break}return En("Paste some BibTeX first."),e.a(2);case 2:a=[],e.p=3,a=n(r).map(function(e){return ge(e)}),e.n=5;break;case 4:return e.p=4,f=e.v,console.error("BibTeX parse failed:",f),En("Could not parse BibTeX. Check the format."),e.a(2);case 5:if(a.length){e.n=6;break}return En("No BibTeX entries found."),e.a(2);case 6:return e.n=7,h();case 7:o=e.v,i=0,c=0,u=oe(a),e.p=8,u.s();case 9:if((s=u.n()).done){e.n=14;break}if((l=s.value).id){e.n=10;break}return c++,e.a(3,13);case 10:if(!o[l.id]){e.n=11;break}return c++,e.a(3,13);case 11:return e.n=12,b(l);case 12:o[l.id]=l,i++;case 13:e.n=9;break;case 14:e.n=16;break;case 15:e.p=15,d=e.v,u.e(d);case 16:return e.p=16,u.f(),e.f(16);case 17:return e.n=18,pn("");case 18:ye("importLibPanel"),En("Imported ".concat(i," entr").concat(1===i?"y":"ies").concat(c?", skipped ".concat(c," duplicate").concat(1===c?"":"s"):"","."));case 19:return e.a(2)}},e,null,[[8,15,16,17],[3,4]])}))).apply(this,arguments)}function Nn(e){var n=(e||"").toLowerCase();return["ieee","numeric","vancouver","acs"].includes(n)}function Mn(e,n){return Dn.apply(this,arguments)}function Dn(){return(Dn=ae(ne().m(function e(n,t){var r,a,o,i,c,u,s,l,f,d,p,v,m,y;return ne().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,h();case 1:return r=e.v,e.n=2,w();case 2:a=e.v,o=n.filter(function(e,n,t){return t.indexOf(e)===n}),i=[],c=[],u=oe(o),e.p=3,u.s();case 4:if((s=u.n()).done){e.n=7;break}if(l=s.value,f=r[l]){e.n=5;break}return e.a(3,6);case 5:(d=a.indexOf(l)+1)>0&&i.push(d),p=(p=ue(f,t,Math.max(d,1))).replace(/^[\s\[(]+|[\s\])]+$/g,""),Nn(t)||c.push(p);case 6:e.n=4;break;case 7:e.n=9;break;case 8:e.p=8,y=e.v,u.e(y);case 9:return e.p=9,u.f(),e.f(9);case 10:if(i.sort(function(e,n){return e-n}),!Nn(t)){e.n=11;break}return v=i.length?"[".concat(Oe(i),"]"):"",e.a(2,v||"[]");case 11:return m=c.length?"(".concat(c.join("; "),")"):"()",e.a(2,m);case 12:return e.a(2)}},e,null,[[3,8,9,10]])}))).apply(this,arguments)}function Un(e){return Fn.apply(this,arguments)}function Fn(){return Fn=ae(ne().m(function e(n){return ne().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Word.run(function(){var e=ae(ne().m(function e(t){var r,a,o,i,c,u,s,l;return ne().w(function(e){for(;;)switch(e.p=e.n){case 0:return(r=t.document.contentControls.getByTitle(pe)).load("items/tag,items/id"),e.n=1,t.sync();case 1:a=oe(r.items),e.p=2,a.s();case 3:if((o=a.n()).done){e.n=7;break}if(i=o.value,(c=i.tag||"").startsWith(de)){e.n=4;break}return e.a(3,6);case 4:return u=c.slice(14).split(",").map(function(e){return e.trim()}).filter(Boolean),e.n=5,Mn(u,n);case 5:s=e.v,i.insertText(s,Word.InsertLocation.replace);case 6:e.n=3;break;case 7:e.n=9;break;case 8:e.p=8,l=e.v,a.e(l);case 9:return e.p=9,a.f(),e.f(9);case 10:return e.n=11,t.sync();case 11:return e.a(2)}},e,null,[[2,8,9,10]])}));return function(n){return e.apply(this,arguments)}}());case 1:return e.a(2)}},e)})),Fn.apply(this,arguments)}function Gn(){return qn.apply(this,arguments)}function qn(){return qn=ae(ne().m(function e(){var n,t,r;return ne().w(function(e){for(;;)switch(e.n){case 0:return n=ve(),t=function(e){return["ieee","numeric","vancouver","acs"].includes((e||"").toLowerCase())},r=function(){var e=ae(ne().m(function e(n,r){var a,o,i,c,u,s,l,f,d,p,v,m,y;return ne().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,h();case 1:return a=e.v,e.n=2,w();case 2:if(o=e.v,i=n.filter(function(e,n,t){return t.indexOf(e)===n}),!t(r)){e.n=3;break}return c=i.map(function(e){return o.indexOf(e)+1}).filter(function(e){return e>0}).sort(function(e,n){return e-n}),u=c.length?Oe(c):"",e.a(2,u?"[".concat(u,"]"):"[]");case 3:s=[],l=oe(i),e.p=4,l.s();case 5:if((f=l.n()).done){e.n=8;break}if(d=f.value,p=a[d]){e.n=6;break}return e.a(3,7);case 6:v=Math.max(o.indexOf(d)+1,1),m=(m=ue(p,r,v)).replace(/^[\s\[(]+|[\s\])]+$/g,""),s.push(m);case 7:e.n=5;break;case 8:e.n=10;break;case 9:e.p=9,y=e.v,l.e(y);case 10:return e.p=10,l.f(),e.f(10);case 11:return e.a(2,s.length?"(".concat(s.join("; "),")"):"()");case 12:return e.a(2)}},e,null,[[4,9,10,11]])}));return function(n,t){return e.apply(this,arguments)}}(),e.n=1,Ie("Merge selected citations",ae(ne().m(function e(){return ne().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Word.run(function(){var e=ae(ne().m(function e(t){var a,o,i,c,u,s,l,f,d,p,h,v,m,y,b,g,w,k,E,O,I,S,x,L;return ne().w(function(e){for(;;)switch(e.p=e.n){case 0:return a=t.document.getSelection(),(o=t.document.contentControls.getByTitle("WordRef Citation")).load("items/tag,items/id"),e.n=1,t.sync();case 1:i=[],c=oe(o.items),e.p=2,c.s();case 3:if((u=c.n()).done){e.n=7;break}if(s=u.value,(l=s.tag||"").startsWith("wordref-cite:")){e.n=4;break}return e.a(3,6);case 4:return f=s.getRange("Start"),d=s.getRange("End"),p=f.compareLocationWith(a),h=d.compareLocationWith(a),e.n=5,t.sync();case 5:!(p.value!==Word.LocationRelation.inside&&p.value!==Word.LocationRelation.equal||h.value!==Word.LocationRelation.inside&&h.value!==Word.LocationRelation.equal)&&i.push({cc:s,tag:l,start:f});case 6:e.n=3;break;case 7:e.n=9;break;case 8:e.p=8,L=e.v,c.e(L);case 9:return e.p=9,c.f(),e.f(9);case 10:if(!(i.length<2)){e.n=11;break}return En("Select two or more WordRef citations to merge."),e.a(2);case 11:v=[],m=0,y=i;case 12:if(!(m<y.length)){e.n=18;break}b=y[m],g=!1,w=0;case 13:if(!(w<v.length)){e.n=16;break}return k=b.start.compareLocationWith(v[w].start),e.n=14,t.sync();case 14:if(k.value!==Word.LocationRelation.before){e.n=15;break}return v.splice(w,0,b),g=!0,e.a(3,16);case 15:w++,e.n=13;break;case 16:g||v.push(b);case 17:m++,e.n=12;break;case 18:return E=v.map(function(e){return e.tag.replace("wordref-cite:","")}),e.n=19,r(E,n);case 19:return O=e.v,I="wordref-group:"+E.join(","),t.document.body.getRange("End").select(),e.n=20,t.sync();case 20:return(S=v[0].cc).title="WordRef Citation (Group)",S.tag=I,S.appearance="BoundingBox",S.insertText(O,Word.InsertLocation.replace),e.n=21,t.sync();case 21:x=1;case 22:if(!(x<v.length)){e.n=29;break}e.p=23,v[x].cc.delete(!1),e.n=28;break;case 24:return e.p=24,e.v,e.p=25,v[x].cc.getRange().insertText("",Word.InsertLocation.replace),e.n=26,t.sync();case 26:v[x].cc.delete(!0),e.n=28;break;case 27:e.p=27,e.v;case 28:x++,e.n=22;break;case 29:return e.n=30,t.sync();case 30:return e.a(2)}},e,null,[[25,27],[23,24],[2,8,9,10]])}));return function(n){return e.apply(this,arguments)}}());case 1:return e.a(2)}},e)})));case 1:return e.n=2,Ie("Post-merge refresh",ae(ne().m(function e(){return ne().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,ke();case 1:return e.n=2,Un(ve());case 2:return e.a(2)}},e)})));case 2:En("Citations merged.");case 3:return e.a(2)}},e)})),qn.apply(this,arguments)}function $n(){var e=document.getElementById("citedBibtexBox");e&&(e.select(),document.execCommand("copy"),En("Cited BibTeX copied to clipboard."))}}(),function(){"use strict";new URL(t(58394),t.b)}()}();
//# sourceMappingURL=taskpane.js.map