/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var t={58394:function(t,n,e){"use strict";t.exports=e.p+"915941b78bc81f41e803.css"},96014:function(t,n){!function(t){function n(){this.months=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],this.notKey=[",","{","}"," ","="],this.pos=0,this.input="",this.entries=new Array,this.currentEntry="",this.setInput=function(t){this.input=t},this.getEntries=function(){return this.entries},this.isWhitespace=function(t){return" "==t||"\r"==t||"\t"==t||"\n"==t},this.match=function(t,n){if(null!=n&&null!=n||(n=!0),this.skipWhitespace(n),this.input.substring(this.pos,this.pos+t.length)!=t)throw"Token mismatch, expected "+t+", found "+this.input.substring(this.pos);this.pos+=t.length,this.skipWhitespace(n)},this.tryMatch=function(t,n){return null!=n&&null!=n||(n=!0),this.skipWhitespace(n),this.input.substring(this.pos,this.pos+t.length)==t},this.matchAt=function(){for(;this.input.length>this.pos&&"@"!=this.input[this.pos];)this.pos++;return"@"==this.input[this.pos]},this.skipWhitespace=function(t){for(;this.isWhitespace(this.input[this.pos]);)this.pos++;if("%"==this.input[this.pos]&&1==t){for(;"\n"!=this.input[this.pos];)this.pos++;this.skipWhitespace(t)}},this.value_braces=function(){var t=0;this.match("{",!1);for(var n=this.pos,e=!1;;){if(!e)if("}"==this.input[this.pos]){if(!(t>0)){var r=this.pos;return this.match("}",!1),this.input.substring(n,r)}t--}else if("{"==this.input[this.pos])t++;else if(this.pos>=this.input.length-1)throw"Unterminated value";e="\\"==this.input[this.pos]&&0==e,this.pos++}},this.value_comment=function(){for(var t="",n=0;!this.tryMatch("}",!1)||0!=n;){if(t+=this.input[this.pos],"{"==this.input[this.pos]&&n++,"}"==this.input[this.pos]&&n--,this.pos>=this.input.length-1)throw"Unterminated value:"+this.input.substring(start);this.pos++}return t},this.value_quotes=function(){this.match('"',!1);for(var t=this.pos,n=!1;;){if(!n){if('"'==this.input[this.pos]){var e=this.pos;return this.match('"',!1),this.input.substring(t,e)}if(this.pos>=this.input.length-1)throw"Unterminated value:"+this.input.substring(t)}n="\\"==this.input[this.pos]&&0==n,this.pos++}},this.single_value=function(){var t=this.pos;if(this.tryMatch("{"))return this.value_braces();if(this.tryMatch('"'))return this.value_quotes();var n=this.key();if(n.match("^[0-9]+$"))return n;if(this.months.indexOf(n.toLowerCase())>=0)return n.toLowerCase();throw"Value expected:"+this.input.substring(t)+" for key: "+n},this.value=function(){var t=[];for(t.push(this.single_value());this.tryMatch("#");)this.match("#"),t.push(this.single_value());return t.join("")},this.key=function(){for(var t=this.pos;;){if(this.pos>=this.input.length)throw"Runaway key";if(this.notKey.indexOf(this.input[this.pos])>=0)return this.input.substring(t,this.pos);this.pos++}},this.key_equals_value=function(){var t=this.key();if(this.tryMatch("="))return this.match("="),[t,this.value()];throw"... = value expected, equals sign missing:"+this.input.substring(this.pos)},this.key_value_list=function(){var t=this.key_equals_value();for(this.currentEntry.entryTags={},this.currentEntry.entryTags[t[0]]=t[1];this.tryMatch(",")&&(this.match(","),!this.tryMatch("}"));)t=this.key_equals_value(),this.currentEntry.entryTags[t[0]]=t[1]},this.entry_body=function(t){this.currentEntry={},this.currentEntry.citationKey=this.key(),this.currentEntry.entryType=t.substring(1),this.match(","),this.key_value_list(),this.entries.push(this.currentEntry)},this.directive=function(){return this.match("@"),"@"+this.key()},this.preamble=function(){this.currentEntry={},this.currentEntry.entryType="PREAMBLE",this.currentEntry.entry=this.value_comment(),this.entries.push(this.currentEntry)},this.comment=function(){this.currentEntry={},this.currentEntry.entryType="COMMENT",this.currentEntry.entry=this.value_comment(),this.entries.push(this.currentEntry)},this.entry=function(t){this.entry_body(t)},this.bibtex=function(){for(;this.matchAt();){var t=this.directive();this.match("{"),"@STRING"==t?this.string():"@PREAMBLE"==t?this.preamble():"@COMMENT"==t?this.comment():this.entry(t),this.match("}")}}}t.toJSON=function(t){var e=new n;return e.setInput(t),e.bibtex(),e.entries},t.toBibtex=function(t){var n="";for(var e in t){if(n+="@"+t[e].entryType,n+="{",t[e].citationKey&&(n+=t[e].citationKey+", "),t[e].entry&&(n+=t[e].entry),t[e].entryTags){var r="";for(var i in t[e].entryTags)0!=r.length&&(r+=", "),r+=i+"= {"+t[e].entryTags[i]+"}";n+=r}n+="}\n\n"}return n}}(n)}},n={};function e(r){var i=n[r];if(void 0!==i)return i.exports;var o=n[r]={exports:{}};return t[r](o,o.exports,e),o.exports}e.m=t,e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},function(){var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(t=n.currentScript.src),!t)){var r=n.getElementsByTagName("script");if(r.length)for(var i=r.length-1;i>-1&&(!t||!/^http(s?):/.test(t));)t=r[i--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t}(),e.b=document.baseURI||self.location.href,function(){"use strict";var t=e(96014);function n(n){var e=(n||"").trim();return e?(t.toJSON(e)||[]).map(function(t){var n;return{id:t.citationKey||(null===(n=t.entryTags)||void 0===n?void 0:n.citationKey)||"id_"+Math.random().toString(36).slice(2,9),type:t.entryType,fields:t.entryTags||{},createdAt:(new Date).toISOString()}}):[]}function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function i(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),e.push.apply(e,r)}return e}function o(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?i(Object(e),!0).forEach(function(n){a(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):i(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function a(t,n,e){return(n=function(t){var n=function(t){if("object"!=r(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=r(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==r(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function c(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",i=e.toStringTag||"@@toStringTag";function o(e,r,i,o){var c=r&&r.prototype instanceof s?r:s,f=Object.create(c.prototype);return u(f,"_invoke",function(e,r,i){var o,c,u,s=0,f=i||[],l=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(n,e){return o=n,c=0,u=t,p.n=e,a}};function h(e,r){for(c=e,u=r,n=0;!l&&s&&!i&&n<f.length;n++){var i,o=f[n],h=p.p,d=o[2];e>3?(i=d===r)&&(u=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=h&&((i=e<2&&h<o[1])?(c=0,p.v=r,p.n=o[1]):h<d&&(i=e<3||o[0]>r||r>d)&&(o[4]=e,o[5]=r,p.n=d,c=0))}if(i||e>1)return a;throw l=!0,r}return function(i,f,d){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&h(f,d),c=f,u=d;(n=c<2?t:u)||!l;){o||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,o){if(c||(i="next"),n=o[i]){if(!(n=n.call(o,u)))throw TypeError("iterator result is not an object");if(!n.done)return n;u=n.value,c<2&&(c=0)}else 1===c&&(n=o.return)&&n.call(o),c<2&&(u=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=t}else if((n=(l=p.n<0)?u:e.call(r,p))!==a)break}catch(n){o=t,c=1,u=n}finally{s=1}}return{value:n,done:l}}}(e,i,o),!0),f}var a={};function s(){}function f(){}function l(){}n=Object.getPrototypeOf;var p=[][r]?n(n([][r]())):(u(n={},r,function(){return this}),n),h=l.prototype=s.prototype=Object.create(p);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,u(t,i,"GeneratorFunction")),t.prototype=Object.create(h),t}return f.prototype=l,u(h,"constructor",l),u(l,"constructor",f),f.displayName="GeneratorFunction",u(l,i,"GeneratorFunction"),u(h),u(h,i,"Generator"),u(h,r,function(){return this}),u(h,"toString",function(){return"[object Generator]"}),(c=function(){return{w:o,m:d}})()}function u(t,n,e,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}u=function(t,n,e,r){function o(n,e){u(t,n,function(t){return this._invoke(n,e,t)})}n?i?i(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(o("next",0),o("throw",1),o("return",2))},u(t,n,e,r)}function s(t,n,e,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void e(t)}c.done?n(u):Promise.resolve(u).then(r,i)}function f(t){return function(){var n=this,e=arguments;return new Promise(function(r,i){var o=t.apply(n,e);function a(t){s(o,r,i,a,c,"next",t)}function c(t){s(o,r,i,a,c,"throw",t)}a(void 0)})}}function l(){var t=globalThis.OfficeRuntime;return(null==t?void 0:t.storage)||{getItem:function(t){return f(c().m(function n(){return c().w(function(n){for(;;)if(0===n.n)return n.a(2,localStorage.getItem(t))},n)}))()},setItem:function(t,n){return f(c().m(function e(){return c().w(function(e){for(;;)switch(e.n){case 0:localStorage.setItem(t,n);case 1:return e.a(2)}},e)}))()},removeItem:function(t){return f(c().m(function n(){return c().w(function(n){for(;;)switch(n.n){case 0:localStorage.removeItem(t);case 1:return n.a(2)}},n)}))()}}}var p="wordref.library",h="wordref.citedOrder";function d(){return y.apply(this,arguments)}function y(){return(y=f(c().m(function t(){var n;return c().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,l().getItem(p);case 1:return n=t.v,t.a(2,n?JSON.parse(n):{})}},t)}))).apply(this,arguments)}function v(t){return m.apply(this,arguments)}function m(){return(m=f(c().m(function t(n){return c().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,l().setItem(p,JSON.stringify(n));case 1:return t.a(2)}},t)}))).apply(this,arguments)}function b(t){return g.apply(this,arguments)}function g(){return(g=f(c().m(function t(n){var e;return c().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,d();case 1:return(e=t.v)[n.id]=o(o({},e[n.id]||{}),n),t.n=2,v(e);case 2:return t.a(2)}},t)}))).apply(this,arguments)}function w(){return k.apply(this,arguments)}function k(){return(k=f(c().m(function t(){var n;return c().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,l().getItem(h);case 1:return n=t.v,t.a(2,n?JSON.parse(n):[])}},t)}))).apply(this,arguments)}function E(t){return S.apply(this,arguments)}function S(){return(S=f(c().m(function t(n){return c().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,l().setItem(h,JSON.stringify(n));case 1:return t.a(2)}},t)}))).apply(this,arguments)}function O(t){return I.apply(this,arguments)}function I(){return(I=f(c().m(function t(n){var e;return c().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,w();case 1:if((e=t.v).includes(n)){t.n=2;break}return e.push(n),t.n=2,E(e);case 2:return t.a(2)}},t)}))).apply(this,arguments)}function T(){return j.apply(this,arguments)}function j(){return(j=f(c().m(function t(){return c().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,l().removeItem(h);case 1:return t.a(2)}},t)}))).apply(this,arguments)}function x(){return C.apply(this,arguments)}function C(){return(C=f(c().m(function t(){return c().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,l().removeItem(p);case 1:return t.a(2)}},t)}))).apply(this,arguments)}function _(t){return function(t){if(Array.isArray(t))return W(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||P(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,i,o,a,c=[],u=!0,s=!1;try{if(o=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;u=!1}else for(;!(u=(r=o.call(e)).done)&&(c.push(r.value),c.length!==n);u=!0);}catch(t){s=!0,i=t}finally{try{if(!u&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(s)throw i}}return c}}(t,n)||P(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=P(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){c=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(c)throw o}}}}function P(t,n){if(t){if("string"==typeof t)return W(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?W(t,n):void 0}}function W(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function B(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",i=e.toStringTag||"@@toStringTag";function o(e,r,i,o){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return N(s,"_invoke",function(e,r,i){var o,c,u,s=0,f=i||[],l=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(n,e){return o=n,c=0,u=t,p.n=e,a}};function h(e,r){for(c=e,u=r,n=0;!l&&s&&!i&&n<f.length;n++){var i,o=f[n],h=p.p,d=o[2];e>3?(i=d===r)&&(u=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=h&&((i=e<2&&h<o[1])?(c=0,p.v=r,p.n=o[1]):h<d&&(i=e<3||o[0]>r||r>d)&&(o[4]=e,o[5]=r,p.n=d,c=0))}if(i||e>1)return a;throw l=!0,r}return function(i,f,d){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&h(f,d),c=f,u=d;(n=c<2?t:u)||!l;){o||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,o){if(c||(i="next"),n=o[i]){if(!(n=n.call(o,u)))throw TypeError("iterator result is not an object");if(!n.done)return n;u=n.value,c<2&&(c=0)}else 1===c&&(n=o.return)&&n.call(o),c<2&&(u=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=t}else if((n=(l=p.n<0)?u:e.call(r,p))!==a)break}catch(n){o=t,c=1,u=n}finally{s=1}}return{value:n,done:l}}}(e,i,o),!0),s}var a={};function c(){}function u(){}function s(){}n=Object.getPrototypeOf;var f=[][r]?n(n([][r]())):(N(n={},r,function(){return this}),n),l=s.prototype=c.prototype=Object.create(f);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,N(t,i,"GeneratorFunction")),t.prototype=Object.create(l),t}return u.prototype=s,N(l,"constructor",s),N(s,"constructor",u),u.displayName="GeneratorFunction",N(s,i,"GeneratorFunction"),N(l),N(l,i,"Generator"),N(l,r,function(){return this}),N(l,"toString",function(){return"[object Generator]"}),(B=function(){return{w:o,m:p}})()}function N(t,n,e,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}N=function(t,n,e,r){function o(n,e){N(t,n,function(t){return this._invoke(n,e,t)})}n?i?i(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(o("next",0),o("throw",1),o("return",2))},N(t,n,e,r)}function R(t,n,e,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void e(t)}c.done?n(u):Promise.resolve(u).then(r,i)}function M(t){return function(){var n=this,e=arguments;return new Promise(function(r,i){var o=t.apply(n,e);function a(t){R(o,r,i,a,c,"next",t)}function c(t){R(o,r,i,a,c,"throw",t)}a(void 0)})}}function G(t){return(t||"apa").toLowerCase()}function F(t,n,e){var r=G(n),i=function(t){return(t.fields.author||t.fields.editor||"Anon").split(" and ")[0].split(",")[0].trim()}(t),o=t.fields.year||"n.d.";return function(t){return"ieee"===(t=G(t))||"numeric"===t||"vancouver"===t||"acs"===t}(r)?"[".concat(e,"]"):"(".concat(i,", ").concat(o,")")}function D(t,n,e){var r=G(n),i=t.fields.author||t.fields.editor||"Anon",o=t.fields.year||"n.d.",a=t.fields.title||"",c=t.fields.journal||t.fields.booktitle||"",u=t.fields.volume?"".concat(t.fields.volume):"",s=t.fields.number?"(".concat(t.fields.number,")"):"",f=t.fields.pages?", ".concat(t.fields.pages):"",l=t.fields.doi?" https://doi.org/".concat(t.fields.doi):"";switch(r){case"ieee":case"numeric":return"[".concat(e,"] ").concat(i,". â€œ").concat(a,",â€ ").concat(c," ").concat(u).concat(s).concat(f,", ").concat(o,".").concat(l);case"vancouver":return"".concat(e,". ").concat(i,". ").concat(a,". ").concat(c," ").concat(o).concat(u?";".concat(u):"").concat(s?"(".concat(s,")"):"").concat(f?":".concat(f.replace(", ","-").replace(/^, /,"")):"",".");case"harvard":return"".concat(i,", ").concat(o,". ").concat(a,". ").concat(c).concat(u?", ".concat(u):"").concat(s?" ".concat(s):"").concat(f,".");case"acs":return"".concat(i,". ").concat(a,". ").concat(c," ").concat(o).concat(u?", ".concat(u):"").concat(s?" ".concat(s):"").concat(f,".");default:return"".concat(i," (").concat(o,"). ").concat(a,". ").concat(c).concat(u?", ".concat(u):"").concat(s?" ".concat(s):"").concat(f,".").concat(l)}}function U(t,n){return $.apply(this,arguments)}function $(){return($=M(B().m(function t(n,e){var r,i,o,a;return B().w(function(t){for(;;)switch(t.n){case 0:return(r=n.document.contentControls.getByTag("wordref-bibliography")).load("items"),t.n=1,n.sync();case 1:if(!(r.items.length>0)){t.n=2;break}return t.a(2,r.items[0]);case 2:return i=e.getRange("End"),o=i.insertParagraph("",Word.InsertLocation.after),(a=o.insertContentControl()).tag="wordref-bibliography",a.title="WordRef Bibliography",t.a(2,a)}},t)}))).apply(this,arguments)}function K(t){return J.apply(this,arguments)}function J(){return J=M(B().m(function t(n){var e,r,i,o,a=arguments;return B().w(function(t){for(;;)switch(t.n){case 0:return e=a.length>1&&void 0!==a[1]?a[1]:"apa",r=a.length>2?a[2]:void 0,i=new Set,o=n.filter(function(t){return!i.has(t.id)&&(i.add(t.id),!0)}),["apa","harvard","mla"].includes((e||"apa").toLowerCase())&&(o=_(o).sort(function(t,n){return(t.fields.author||"").localeCompare(n.fields.author||"")})),t.n=1,Word.run(function(){var t=M(B().m(function t(n){var i,a,c,u,s,f,l,p,h;return B().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.n=1,M(B().m(function t(){var e,r,i;return B().w(function(t){for(;;)switch(t.n){case 0:return e=n.document.body,(r=e.paragraphs).load("items,text"),t.n=1,n.sync();case 1:if(i=r.items.find(function(t){return"references"===t.text.trim().toLowerCase()}),i){t.n=2;break}return(i=e.insertParagraph("References",Word.InsertLocation.end)).styleBuiltIn=Word.BuiltInStyleName.heading1,e.insertParagraph("",Word.InsertLocation.end),t.n=2,n.sync();case 2:return t.a(2,i)}},t)}))();case 1:return i=t.v,t.n=2,U(n,i);case 2:return a=t.v,c=o.map(function(t,n){return D(t,e,n+1)}),u=c.join("\n"),a.insertText(u,Word.InsertLocation.replace),t.n=3,n.sync();case 3:return t.p=3,s=a.getRange(),(f=s.paragraphs).load("items/font"),t.n=4,n.sync();case 4:l=A(f.items);try{for(l.s();!(p=l.n()).done;)h=p.value,null!=r&&r.fontName&&(h.font.name=r.fontName),null!=r&&r.fontSize&&(h.font.size=r.fontSize),null!=r&&r.color&&(h.font.color=r.color),null!=r&&r.alignment&&(h.alignment=r.alignment),null!=r&&r.lineSpacing&&(h.lineSpacing=r.lineSpacing)}catch(t){l.e(t)}finally{l.f()}t.n=6;break;case 5:t.p=5,t.v;case 6:return t.n=7,n.sync();case 7:return t.a(2)}},t,null,[[3,5]])}));return function(n){return t.apply(this,arguments)}}());case 1:return t.a(2)}},t)})),J.apply(this,arguments)}function q(){return q=M(B().m(function t(){return B().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,Word.run(function(){var t=M(B().m(function t(n){var e,r,i,o,a,c,u;return B().w(function(t){for(;;)switch(t.n){case 0:return(e=n.document.contentControls).load("items/tag"),t.n=1,n.sync();case 1:r=[],i=A(e.items);try{for(i.s();!(o=i.n()).done;)a=o.value,(c=a.tag||"").startsWith("wordref-cite:")&&(u=c.split(":")[1])&&r.push(u)}catch(t){i.e(t)}finally{i.f()}return t.a(2,r)}},t)}));return function(n){return t.apply(this,arguments)}}());case 1:return t.a(2,t.v)}},t)})),q.apply(this,arguments)}function z(t,n,e){return V.apply(this,arguments)}function V(){return V=M(B().m(function t(n,e,r){return B().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,Word.run(function(){var t=M(B().m(function t(i){var o,a,c,u,s,f,l,p,h,d;return B().w(function(t){for(;;)switch(t.p=t.n){case 0:return(o=i.document.contentControls).load("items/tag"),t.n=1,i.sync();case 1:a=o.items.filter(function(t){return(t.tag||"").startsWith("wordref-cite:")}),c=A(a),t.p=2,c.s();case 3:if((u=c.n()).done){t.n=6;break}if(s=u.value,f=(s.tag||"").split(":")[1],l=r[f]){t.n=4;break}return t.a(3,5);case 4:p=Math.max(0,e.indexOf(f))+1,h=F(l,n,p),s.insertText(h,Word.InsertLocation.replace);case 5:t.n=3;break;case 6:t.n=8;break;case 7:t.p=7,d=t.v,c.e(d);case 8:return t.p=8,c.f(),t.f(8);case 9:return t.n=10,i.sync();case 10:return t.a(2)}},t,null,[[2,7,8,9]])}));return function(n){return t.apply(this,arguments)}}());case 1:return t.a(2)}},t)})),V.apply(this,arguments)}function H(t){var n=t.match(/\[(.*?)\]/g),e=[];if(!n)return e;var r,i=A(n);try{for(i.s();!(r=i.n()).done;){var o,a=A(r.value.replace(/^\[|\]$/g,"").split(",").map(function(t){return t.trim()}).filter(Boolean));try{for(a.s();!(o=a.n()).done;){var c=o.value;if(/^\d+$/.test(c))e.push(parseInt(c,10));else if(/^\d+\s*-\s*\d+$/.test(c))for(var u=L(c.split("-").map(function(t){return parseInt(t.trim(),10)}),2),s=u[0],f=u[1],l=Math.min(s,f);l<=Math.max(s,f);l++)e.push(l)}}catch(t){a.e(t)}finally{a.f()}}}catch(t){i.e(t)}finally{i.f()}return e}function X(t){var n=Array.from(new Set(t)).sort(function(t,n){return t-n});if(!n.length)return"[]";for(var e=[],r=n[0],i=n[0],o=1;o<=n.length;o++){var a=n[o];a!==i+1?(r===i?e.push("".concat(r)):i===r+1?e.push("".concat(r),"".concat(i)):e.push("".concat(r,"-").concat(i)),r=null!=a?a:NaN,i=null!=a?a:NaN):i=a}return"[".concat(e.join(", "),"]")}function Y(){return Q.apply(this,arguments)}function Q(){return Q=M(B().m(function t(){return B().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,Word.run(function(){var t=M(B().m(function t(n){var e,r,i,o,a,c,u,s,f,l,p,h;return B().w(function(t){for(;;)switch(t.n){case 0:return e=n.document.getSelection(),(r=e.paragraphs.getFirst()).load("contentControls/items/tag"),t.n=1,n.sync();case 1:i=r.contentControls.items,o=0;case 2:if(!(o<i.length)){t.n=5;break}for(a=[];o<i.length&&(i[o].tag||"").startsWith("wordref-cite:");)a.push(i[o]),o++;if(!(a.length>1)){t.n=4;break}return a.forEach(function(t){return t.getRange().load("text")}),t.n=3,n.sync();case 3:c=[],u=A(a);try{for(u.s();!(s=u.n()).done;)f=s.value,l=f.getRange().text||"",c.push.apply(c,_(H(l)))}catch(t){u.e(t)}finally{u.f()}for(p=X(c),a[0].insertText(p,Word.InsertLocation.replace),h=1;h<a.length;h++)a[h].delete(!1);return t.n=4,n.sync();case 4:for(;o<i.length&&!(i[o].tag||"").startsWith("wordref-cite:");)o++;t.n=2;break;case 5:return t.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}());case 1:return t.a(2)}},t)})),Q.apply(this,arguments)}function Z(){return Z=M(B().m(function t(n,e,r,i){var o,a,c,u,s,f,l;return B().w(function(t){for(;;)if(0===t.n)return o=(r||"apa").toLowerCase(),a=["ieee","numeric","vancouver","acs"].includes(o),c=window.__WORDREF_DEBUG__||{},u=!!c.FORCE_APPEND_END,s=!1!==c.NO_CONTENT_CONTROL_FALLBACK,f=!!c.SAFE_MODE_NO_MERGE,l=function(t){return new Promise(function(n){Office.context.document.setSelectedDataAsync(t,{coercionType:Office.CoercionType.Text},function(t){return n(t.status===Office.AsyncResultStatus.Succeeded)})})},t.a(2,Word.run(function(){var t=M(B().m(function t(r){var o,c,p,h,d,y,v,m,b,g,w,k,E,S,O;return B().w(function(t){for(;;)switch(t.p=t.n){case 0:if(o=r.document.body,!u){t.n=2;break}return o.insertParagraph("",Word.InsertLocation.end).getRange("Start").insertText(e,Word.InsertLocation.replace),t.n=1,r.sync();case 1:return t.a(2);case 2:return(c=r.document.getSelection()).load("text,parentContentControl,paragraphs"),t.n=3,r.sync();case 3:if(f){t.n=6;break}if(!(p=c.parentContentControl)||p.isNullObject||!(p.tag||"").startsWith("wordref-cite:")||!a||"number"!=typeof i){t.n=6;break}return(h=p.getRange()).load("text"),t.n=4,r.sync();case 4:return(d=H(h.text)).push(i),p.insertText(X(d),Word.InsertLocation.replace),t.n=5,r.sync();case 5:return t.a(2);case 6:if(f||!a||"number"!=typeof i){t.n=14;break}return t.p=7,c.paragraphs.getFirst().load("text"),t.n=8,r.sync();case 8:return t.n=9,M(B().m(function t(){var n,e,i,o,a,u,s;return B().w(function(t){for(;;)switch(t.p=t.n){case 0:return(n=r.document.contentControls).load("items/tag"),t.n=1,r.sync();case 1:e=n.items.filter(function(t){return(t.tag||"").startsWith("wordref-cite:")}),i=A(e),t.p=2,i.s();case 3:if((o=i.n()).done){t.n=6;break}return a=o.value,(u=a.getRange()).load("text"),t.n=4,r.sync();case 4:if("Equal"!==u.getRange("End").compareLocationWith(c).value){t.n=5;break}return t.a(2,a);case 5:t.n=3;break;case 6:t.n=8;break;case 7:t.p=7,s=t.v,i.e(s);case 8:return t.p=8,i.f(),t.f(8);case 9:return t.a(2,null)}},t,null,[[2,7,8,9]])}))();case 9:if(!(y=t.v)){t.n=12;break}return(v=y.getRange()).load("text"),t.n=10,r.sync();case 10:return(m=H(v.text)).push(i),y.insertText(X(m),Word.InsertLocation.replace),t.n=11,r.sync();case 11:return t.a(2);case 12:t.n=14;break;case 13:t.p=13,t.v;case 14:return b=function(){var t=M(B().m(function t(i){var o;return B().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,(o=i.insertContentControl()).tag="wordref-cite:".concat(n.id),o.title="WordRef Citation",o.appearance="BoundingBox",o.insertText(e,Word.InsertLocation.replace),t.n=1,r.sync();case 1:return t.a(2,!0);case 2:if(t.p=2,t.v,!s){t.n=4;break}return t.n=3,l(e);case 3:if(!t.v){t.n=4;break}return t.a(2,!0);case 4:return t.a(2,!1)}},t,null,[[0,2]])}));return function(n){return t.apply(this,arguments)}}(),t.n=15,b(c);case 15:if(!t.v){t.n=16;break}return t.a(2);case 16:if(t.p=16,!(g=c.parentContentControl)||g.isNullObject||(g.tag||"").startsWith("wordref-cite:")){t.n=18;break}return w=c.paragraphs.getFirst(),k=w.getRange("End").insertParagraph("",Word.InsertLocation.after),E=k.getRange("Start"),t.n=17,b(E);case 17:if(!t.v){t.n=18;break}return t.a(2);case 18:t.n=20;break;case 19:t.p=19,t.v;case 20:return t.n=21,l(e);case 21:if(!t.v){t.n=22;break}return t.a(2);case 22:return S=o.insertParagraph("",Word.InsertLocation.end),O=S.getRange("Start"),t.n=23,b(O);case 23:if(t.v){t.n=24;break}return O.insertText(e,Word.InsertLocation.replace),t.n=24,r.sync();case 24:return t.a(2)}},t,null,[[16,19],[7,13]])}));return function(n){return t.apply(this,arguments)}}()))},t)})),Z.apply(this,arguments)}function tt(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=nt(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){c=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(c)throw o}}}}function nt(t,n){if(t){if("string"==typeof t)return et(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?et(t,n):void 0}}function et(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function rt(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",i=e.toStringTag||"@@toStringTag";function o(e,r,i,o){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return it(s,"_invoke",function(e,r,i){var o,c,u,s=0,f=i||[],l=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(n,e){return o=n,c=0,u=t,p.n=e,a}};function h(e,r){for(c=e,u=r,n=0;!l&&s&&!i&&n<f.length;n++){var i,o=f[n],h=p.p,d=o[2];e>3?(i=d===r)&&(u=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=h&&((i=e<2&&h<o[1])?(c=0,p.v=r,p.n=o[1]):h<d&&(i=e<3||o[0]>r||r>d)&&(o[4]=e,o[5]=r,p.n=d,c=0))}if(i||e>1)return a;throw l=!0,r}return function(i,f,d){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&h(f,d),c=f,u=d;(n=c<2?t:u)||!l;){o||(c?c<3?(c>1&&(p.n=-1),h(c,u)):p.n=u:p.v=u);try{if(s=2,o){if(c||(i="next"),n=o[i]){if(!(n=n.call(o,u)))throw TypeError("iterator result is not an object");if(!n.done)return n;u=n.value,c<2&&(c=0)}else 1===c&&(n=o.return)&&n.call(o),c<2&&(u=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=t}else if((n=(l=p.n<0)?u:e.call(r,p))!==a)break}catch(n){o=t,c=1,u=n}finally{s=1}}return{value:n,done:l}}}(e,i,o),!0),s}var a={};function c(){}function u(){}function s(){}n=Object.getPrototypeOf;var f=[][r]?n(n([][r]())):(it(n={},r,function(){return this}),n),l=s.prototype=c.prototype=Object.create(f);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,it(t,i,"GeneratorFunction")),t.prototype=Object.create(l),t}return u.prototype=s,it(l,"constructor",s),it(s,"constructor",u),u.displayName="GeneratorFunction",it(s,i,"GeneratorFunction"),it(l),it(l,i,"Generator"),it(l,r,function(){return this}),it(l,"toString",function(){return"[object Generator]"}),(rt=function(){return{w:o,m:p}})()}function it(t,n,e,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}it=function(t,n,e,r){function o(n,e){it(t,n,function(t){return this._invoke(n,e,t)})}n?i?i(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(o("next",0),o("throw",1),o("return",2))},it(t,n,e,r)}function ot(t,n,e,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void e(t)}c.done?n(u):Promise.resolve(u).then(r,i)}function at(t){return function(){var n=this,e=arguments;return new Promise(function(r,i){var o=t.apply(n,e);function a(t){ot(o,r,i,a,c,"next",t)}function c(t){ot(o,r,i,a,c,"throw",t)}a(void 0)})}}window.__WORDREF_DEBUG__={NO_CONTENT_CONTROL_FALLBACK:!0,FORCE_APPEND_END:!1,SAFE_MODE_NO_MERGE:!1};var ct=F,ut=function(t,n,e,r){return Z.apply(this,arguments)},st=K,ft=function(){return q.apply(this,arguments)},lt=z;function pt(){var t,n,e,r,i,o=(null===(t=document.getElementById("bibFont"))||void 0===t?void 0:t.value)||"Times New Roman",a=parseInt((null===(n=document.getElementById("bibSize"))||void 0===n?void 0:n.value)||"12",10),c=parseInt((null===(e=document.getElementById("bibSpacing"))||void 0===e?void 0:e.value)||"14",10),u=(null===(r=document.getElementById("bibAlign"))||void 0===r?void 0:r.value)||"Left",s=(null===(i=document.getElementById("bibColor"))||void 0===i?void 0:i.value)||"#333333";return{fontName:o,fontSize:a,lineSpacing:c,alignment:function(t){switch((t||"").toLowerCase()){case"center":case"centered":return Word.Alignment.centered;case"right":return Word.Alignment.right;case"justify":case"justified":return Word.Alignment.justified;default:return Word.Alignment.left}}(u),color:s}}var ht=function(t){return document.getElementById(t)},dt=function(){var t;return((null===(t=ht("styleSelect"))||void 0===t?void 0:t.value)||"apa").toLowerCase()};function yt(t,n){return vt.apply(this,arguments)}function vt(){return vt=at(rt().m(function t(n,e){var r,i,o;return rt().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,w();case 1:if(r=t.v,-1!==(i=r.indexOf(n.id))){t.n=4;break}return t.n=2,O(n.id);case 2:return t.n=3,w();case 3:r=t.v,i=r.indexOf(n.id);case 4:return o=ct(n,e,i>=0?i+1:1),t.n=5,Word.run(function(){var t=at(rt().m(function t(e){var r,i,a,c,u,s,f,l;return rt().w(function(t){for(;;)switch(t.p=t.n){case 0:return r=e.document.body,i=function(){var t=at(rt().m(function t(){var n,i;return rt().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,(n=e.document.getSelection()).load("text"),t.n=1,e.sync();case 1:return t.a(2,n);case 2:return t.p=2,t.v,r.getRange("End").select(),t.n=3,e.sync();case 3:return i=e.document.getSelection(),t.a(2,i)}},t,null,[[0,2]])}));return function(){return t.apply(this,arguments)}}(),t.p=1,t.n=2,i();case 2:return a=t.v,(c=a.insertContentControl()).tag="wordref-cite:".concat(n.id),c.title="WordRef Citation",c.appearance="BoundingBox",c.insertText(o,Word.InsertLocation.replace),t.n=3,e.sync();case 3:case 5:return t.a(2);case 4:return t.p=4,l=t.v,console.warn("[WordRef] selection CC insert failed; will append at end",l),u=r.insertParagraph("",Word.InsertLocation.end),s=u.getRange("Start"),(f=s.insertContentControl()).tag="wordref-cite:".concat(n.id),f.title="WordRef Citation",f.appearance="BoundingBox",f.insertText(o,Word.InsertLocation.replace),t.n=5,e.sync()}},t,null,[[1,4]])}));return function(n){return t.apply(this,arguments)}}());case 5:return t.a(2)}},t)})),vt.apply(this,arguments)}function mt(){var t=document.getElementById("styleBadge");if(t){var n=dt(),e={ieee:"IEEE (numeric)",numeric:"Numeric",apa:"APA",mla:"MLA",harvard:"Harvard",acs:"ACS",vancouver:"Vancouver"}[n]||n.toUpperCase();t.textContent=e}}function bt(t){return gt.apply(this,arguments)}function gt(){return(gt=at(rt().m(function t(n){var e,r;return rt().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,w();case 1:if(e=t.v,-1!==(r=e.indexOf(n))){t.n=4;break}return t.n=2,O(n);case 2:return t.n=3,w();case 3:e=t.v,r=e.indexOf(n);case 4:return t.a(2,r+1)}},t)}))).apply(this,arguments)}function wt(){return kt.apply(this,arguments)}function kt(){return(kt=at(rt().m(function t(){var e,r,i,o,a,c,u,s,f,l,p,h;return rt().w(function(t){for(;;)switch(t.p=t.n){case 0:if(e=ht("bibtexInput")){t.n=1;break}return t.a(2);case 1:if(r=e.value.trim()){t.n=2;break}return t.a(2);case 2:i=[],t.p=3,i=n(r),t.n=5;break;case 4:return t.p=4,t.v,Gt("Could not parse the BibTeX you pasted."),t.a(2);case 5:return t.n=6,d();case 6:o=t.v,a=tt(i),t.p=7,a.s();case 8:if((c=a.n()).done){t.n=12;break}if(f=c.value,!o[f.id]){t.n=10;break}return t.n=9,At("");case 9:return Dt(document.getElementById("results"),f.id),Gt("Already in your library (key: ".concat(f.id,").")),t.a(3,11);case 10:return l=(null===(u=ht("notePage"))||void 0===u?void 0:u.value.trim())||"",p=(null===(s=ht("noteText"))||void 0===s?void 0:s.value.trim())||"",(l||p)&&(f.notes=[{where:l,text:p}]),t.n=11,b(f);case 11:t.n=8;break;case 12:t.n=14;break;case 13:t.p=13,h=t.v,a.e(h);case 14:return t.p=14,a.f(),t.f(14);case 15:return e.value="",t.n=16,At("");case 16:return t.a(2)}},t,null,[[7,13,14,15],[3,4]])}))).apply(this,arguments)}function Et(){return St.apply(this,arguments)}function St(){return(St=at(rt().m(function t(){var e,r,i,o,a,c,u,s,f,l,p,h,y,v,m,g,w;return rt().w(function(t){for(;;)switch(t.p=t.n){case 0:if(i=ht("bibtexInput")){t.n=1;break}return t.a(2);case 1:if(o=i.value.trim()){t.n=2;break}return t.a(2);case 2:a=(null===(e=ht("notePage"))||void 0===e?void 0:e.value.trim())||"",c=(null===(r=ht("noteText"))||void 0===r?void 0:r.value.trim())||"",u=dt(),s=[],t.p=3,s=n(o),t.n=5;break;case 4:return t.p=4,t.v,Gt("Could not parse the BibTeX you pasted."),t.a(2);case 5:return t.n=6,d();case 6:f=t.v,l=tt(s),t.p=7,l.s();case 8:if((p=l.n()).done){t.n=22;break}if(h=p.value,!f[h.id]){t.n=10;break}return t.n=9,At("");case 9:return Dt(document.getElementById("results"),h.id),Gt("Already cited/added (".concat(h.id,").")),t.a(3,21);case 10:return(a||c)&&(h.notes=[{where:a,text:c}]),t.n=11,b(h);case 11:return f[h.id]=h,t.n=12,bt(h.id);case 12:return y=t.v,v=ct(h,u,y),t.n=13,yt(h,u);case 13:return t.n=14,_t(u);case 14:t.n=21;break;case 15:return t.n=16,ut(h,v,u,y);case 16:return t.n=17,_t(u);case 17:if(!["ieee","numeric","vancouver","acs"].includes(dt())){t.n=21;break}return t.p=18,t.n=19,Y();case 19:t.n=21;break;case 20:t.p=20,t.v;case 21:t.n=8;break;case 22:t.n=24;break;case 23:t.p=23,w=t.v,l.e(w);case 24:return t.p=24,l.f(),t.f(24);case 25:return i.value="",(m=ht("notePage"))&&(m.value=""),(g=ht("noteText"))&&(g.value=""),t.n=26,At("");case 26:return t.a(2)}},t,null,[[18,20],[7,23,24,25],[3,4]])}))).apply(this,arguments)}function Ot(){return It.apply(this,arguments)}function It(){return(It=at(rt().m(function t(){var n,e,r,i,o,a,c;return rt().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.n=1,d();case 1:if(n=t.v,0!==(e=Object.values(n)).length){t.n=2;break}return t.a(2);case 2:return r=e[0],i=dt(),t.p=3,t.n=4,bt(r.id);case 4:return o=t.v,a=ct(r,i,o),t.n=5,yt(r,i);case 5:return t.n=6,_t(i);case 6:t.n=13;break;case 7:return t.n=8,ut(r,a,i,o);case 8:return t.n=9,_t(i);case 9:if(!["ieee","numeric","vancouver","acs"].includes(dt())){t.n=13;break}return t.p=10,t.n=11,Y();case 11:t.n=13;break;case 12:t.p=12,t.v;case 13:t.n=15;break;case 14:t.p=14,c=t.v,console.error("Insert citation error:",c),Gt("Insert citation failed: "+(null!=c&&c.debugInfo?JSON.stringify(c.debugInfo):String(c)));case 15:return t.a(2)}},t,null,[[10,12],[3,14]])}))).apply(this,arguments)}function Tt(){return jt.apply(this,arguments)}function jt(){return(jt=at(rt().m(function t(){var n,e;return rt().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,Ut("Reset numbering? This keeps your library but re-numbers citations from [1].");case 1:if(t.v){t.n=2;break}return t.a(2);case 2:return t.n=3,T();case 3:return n=dt(),t.n=4,d();case 4:return e=t.v,t.n=5,z(n,[],e);case 5:return t.n=6,K([],n);case 6:Gt("Numbering reset.");case 7:return t.a(2)}},t)}))).apply(this,arguments)}function xt(){return Ct.apply(this,arguments)}function Ct(){return(Ct=at(rt().m(function t(){return rt().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.n=1,Ut("Clear ENTIRE library and numbering? This cannot be undone.");case 1:if(t.v){t.n=2;break}return t.a(2);case 2:return t.n=3,x();case 3:return t.n=4,T();case 4:return t.n=5,At("");case 5:return t.p=5,t.n=6,st([],dt());case 6:t.n=8;break;case 7:t.p=7,t.v;case 8:Gt("Library cleared.");case 9:return t.a(2)}},t,null,[[5,7]])}))).apply(this,arguments)}function _t(t){return Lt.apply(this,arguments)}function Lt(){return(Lt=at(rt().m(function t(n){var e,r,i,o;return rt().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,d();case 1:return e=t.v,t.n=2,ft();case 2:return r=t.v,i=new Set,o=r.filter(function(t){return e[t]&&!i.has(t)&&(i.add(t),!0)}).map(function(t){return e[t]}),t.n=3,st(o,n,pt());case 3:return t.a(2)}},t)}))).apply(this,arguments)}function At(t){return Pt.apply(this,arguments)}function Pt(){return(Pt=at(rt().m(function t(n){var e,r,i,o,a,c;return rt().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,d();case 1:if(e=t.v,r=Object.values(e),i=Wt(n||""),o=i?r.filter(function(t){var n,e;return[t.id,t.fields.title,t.fields.author,t.fields.year,t.fields.journal,t.fields.booktitle,t.fields.doi].concat((e=(null===(n=t.notes)||void 0===n?void 0:n.map(function(t){return"".concat(t.where||""," ").concat(t.text||"")}))||[],function(t){if(Array.isArray(t))return et(t)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||nt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())).join(" ").toLowerCase().includes(i)}):r,a=ht("results")){t.n=2;break}return t.a(2);case 2:c=function(t){return i?Ft(t,n):t},a.innerHTML=o.map(function(t){var n,e=c(t.fields.title||t.id),r=c("".concat(t.fields.author||"Anon"," â€” ").concat(t.fields.year||"n.d.")),i=(null===(n=t.notes)||void 0===n?void 0:n.map(function(t){return'<div class="note">'.concat(c("ðŸ”– ".concat(t.where||""," ").concat(t.text||"")),"</div>")}).join(""))||"";return'\n        <div class="row item" data-id="'.concat(t.id,'">\n          <div class="grow">\n            <div class="title">').concat(e,'</div>\n            <div class="meta">').concat(r,"</div>\n            ").concat(i,'\n          </div>\n          <button class="cite-btn" data-id="').concat(t.id,'">Cite</button>\n        </div>\n      ')}).join(""),a.querySelectorAll("button.cite-btn").forEach(function(t){t.addEventListener("click",at(rt().m(function n(){var e,r,i,o,a,c,u;return rt().w(function(n){for(;;)switch(n.p=n.n){case 0:if(e=t.getAttribute("data-id")){n.n=1;break}return n.a(2);case 1:return n.n=2,d();case 2:if(r=n.v,i=r[e]){n.n=3;break}return n.a(2);case 3:return o=dt(),n.n=4,bt(i.id);case 4:return a=n.v,c=ct(i,o,a),n.p=5,n.n=6,yt(i,o);case 6:n.n=8;break;case 7:return n.n=8,ut(i,c,o,a);case 8:n.n=10;break;case 9:n.p=9,u=n.v,console.error("Insert citation error:",u,null==u?void 0:u.debugInfo),Gt("Insert citation failed: "+(null!=u&&u.debugInfo?JSON.stringify(u.debugInfo):String(u)));case 10:return n.a(2)}},n,null,[[5,9]])})))});case 3:return t.a(2)}},t)}))).apply(this,arguments)}function Wt(t){return(t||"").toLowerCase().replace(/\s+/g," ").trim()}function Bt(t){return Wt(t).replace(/[^a-z0-9 ]/g,"")}function Nt(t){return/@\w+\s*\{[\s\S]*\}/.test(t)}function Rt(t){return Mt.apply(this,arguments)}function Mt(){return(Mt=at(rt().m(function t(e){var r,i,o,a,c,u,s,f,l,p;return rt().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.n=1,d();case 1:r=t.v,i=Object.values(r),t.p=2,o=n(e),t.n=4;break;case 3:return t.p=3,t.v,t.a(2,null);case 4:if(o.length){t.n=5;break}return t.a(2,null);case 5:if(a=o[0],!(c=(a.id||"").trim())){t.n=6;break}if(!(u=i.find(function(t){return t.id===c}))){t.n=6;break}return t.a(2,{id:u.id,reason:"citationKey"});case 6:if(!(s=Wt(a.fields.doi||""))){t.n=7;break}if(!(f=i.find(function(t){return Wt(t.fields.doi||"")===s}))){t.n=7;break}return t.a(2,{id:f.id,reason:"doi"});case 7:if(!(l=Bt(a.fields.title||""))){t.n=8;break}if(!(p=i.find(function(t){return Bt(t.fields.title||"")===l}))){t.n=8;break}return t.a(2,{id:p.id,reason:"title"});case 8:return t.a(2,null)}},t,null,[[2,3]])}))).apply(this,arguments)}function Gt(t){var n=document.getElementById("toast");n&&(n.textContent=t,n.classList.add("show"),setTimeout(function(){return n.classList.remove("show")},1800))}function Ft(t,n){var e=n.trim();if(!e)return t;var r=e.split(/\s+/).filter(Boolean).map(function(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")});if(!r.length)return t;var i=new RegExp("(".concat(r.join("|"),")"),"gi");return t.replace(i,"<mark>$1</mark>")}function Dt(t,n){var e=t.querySelector('.item[data-id="'.concat(CSS.escape(n),'"]'));e&&(e.classList.add("hit-highlight"),e.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(function(){return e.classList.remove("hit-highlight")},1200))}function Ut(t){return new Promise(function(n){var e=document.getElementById("confirmBar"),r=document.getElementById("confirmMsg"),i=document.getElementById("confirmYes"),o=document.getElementById("confirmNo");r.textContent=t,e.style.display="flex";var a=function(){e.style.display="none",i.removeEventListener("click",c),o.removeEventListener("click",u)},c=function(){a(),n(!0)},u=function(){a(),n(!1)};i.addEventListener("click",c),o.addEventListener("click",u)})}function $t(){return Kt.apply(this,arguments)}function Kt(){return(Kt=at(rt().m(function t(){var n,e,r,i,o,a;return rt().w(function(t){for(;;)switch(t.p=t.n){case 0:return n=dt(),t.n=1,d();case 1:return e=t.v,t.n=2,ft();case 2:return r=t.v,t.n=3,E(r);case 3:return i=new Set,o=r.filter(function(t){return e[t]&&!i.has(t)&&(i.add(t),!0)}).map(function(t){return e[t]}),t.p=4,t.n=5,st(o,n,pt());case 5:t.n=7;break;case 6:t.p=6,a=t.v,console.error("updateBibliography failed",a),Gt("Update bibliography failed. "+(a&&a.debugInfo?JSON.stringify(a.debugInfo):String(a)));case 7:return t.a(2)}},t,null,[[4,6]])}))).apply(this,arguments)}function Jt(){return qt.apply(this,arguments)}function qt(){return(qt=at(rt().m(function t(){var n,e,r,i,o,a;return rt().w(function(t){for(;;)switch(t.p=t.n){case 0:return mt(),n=dt(),t.n=1,d();case 1:return e=t.v,t.n=2,ft();case 2:return r=t.v,t.n=3,E(r);case 3:return t.n=4,lt(n,r,e);case 4:return i=new Set,o=r.filter(function(t){return e[t]&&!i.has(t)&&(i.add(t),!0)}).map(function(t){return e[t]}),t.p=5,t.n=6,st(o,n,pt());case 6:t.n=8;break;case 7:t.p=7,a=t.v,console.error("updateBibliography failed",a),Gt("Update bibliography failed. "+(a&&a.debugInfo?JSON.stringify(a.debugInfo):String(a)));case 8:return t.a(2)}},t,null,[[5,7]])}))).apply(this,arguments)}Office.onReady(at(rt().m(function t(){var n,e,r,i,o,a,c,u,s,f,l,p;return rt().w(function(t){for(;;)switch(t.n){case 0:return null===(n=ht("btnAddOnly"))||void 0===n||n.addEventListener("click",wt),null===(e=ht("btnAddCite"))||void 0===e||e.addEventListener("click",Et),null===(r=ht("btnInsertCite"))||void 0===r||r.addEventListener("click",Ot),null===(i=ht("btnUpdateBib"))||void 0===i||i.addEventListener("click",$t),null===(o=ht("btnResetNumbering"))||void 0===o||o.addEventListener("click",Tt),null===(a=ht("btnClearLibrary"))||void 0===a||a.addEventListener("click",xt),null===(c=ht("btnReload"))||void 0===c||c.addEventListener("click",function(){return location.reload()}),null===(u=document.getElementById("helpIcon"))||void 0===u||u.addEventListener("click",function(){var t;null===(t=document.getElementById("instructionsModal"))||void 0===t||t.classList.add("show")}),null===(s=document.getElementById("closeInstructions"))||void 0===s||s.addEventListener("click",function(){var t;null===(t=document.getElementById("instructionsModal"))||void 0===t||t.classList.remove("show")}),null==(l=document.getElementById("bibColor"))||l.addEventListener("input",function(){l.style.backgroundColor=l.value}),t.n=1,At("");case 1:return null==(p=ht("search"))||p.addEventListener("input",at(rt().m(function t(){var n,e,r;return rt().w(function(t){for(;;)switch(t.n){case 0:if(!Nt(n=p.value)){t.n=3;break}return t.n=1,Rt(n);case 1:return e=t.v,t.n=2,At("");case 2:if(null==e||!e.id){t.n=3;break}return Dt(document.getElementById("results"),e.id),r="citationKey"===e.reason?"citation key":e.reason.toUpperCase(),Gt("Already in your library (matched by ".concat(r,").")),t.a(2);case 3:return t.n=4,At(n);case 4:return t.a(2)}},t)}))),mt(),null===(f=document.getElementById("styleSelect"))||void 0===f||f.addEventListener("change",Jt),t.n=2,At("");case 2:return t.a(2)}},t)})))}(),function(){"use strict";new URL(e(58394),e.b)}()}();
//# sourceMappingURL=taskpane.js.map