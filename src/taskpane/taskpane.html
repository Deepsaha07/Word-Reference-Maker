<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>WordRef</title>

  <link rel="stylesheet" href="./taskpane.css" />
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>

<body>
  <!-- Header -->
  <div class="app-header">
    <h2 class="app-title">WordRef</h2>
    <div class="help-wrap">
      <button id="helpIcon" class="help-icon" title="Instructions">i</button>
      <span id="helpText" class="help-text">Instructions</span>
    </div>
  </div>

  <!-- Instructions modal -->
  <div id="instructionsModal" class="backdrop" role="dialog" aria-modal="true" aria-labelledby="instTitle">
    <div class="modal">
      <div class="modal-header">
        <div id="instTitle" class="modal-title">How to use WordRef</div>
        <button id="closeInstructions" class="modal-close" aria-label="Close">&times;</button>
      </div>
      <div class="modal-body">
        <ol>
          <li>Search your paper on <strong>Google Scholar</strong>.</li>
          <li>Click <em>Cite</em>, then choose <em>BibTeX</em>.</li>
          <li>Copy the BibTeX entry and paste it into the input box.</li>
          <li>
            If your cursor is at the right place in Word:
            <ul><li>Click <strong>Add &amp; Cite</strong> → it inserts immediately.</li></ul>
            Otherwise:
            <ul><li>Click <strong>Add</strong> → it saves in your library to cite later.</li></ul>
          </li>
          <li>You can add optional notes (page/line and remarks).</li>
          <li>Re-use items in your library via the <strong>Cite</strong> button beside each result.</li>
          <li>Duplicates are detected and you’ll get a notification.</li>
          <li>Change citation style anytime (APA, IEEE, etc.); in-text and bibliography update.</li>
          <li>Multiple numeric cites: place them adjacent and then merge to <code>[2,3]</code> or <code>[2–3]</code> if needed.</li>
          <li>Bibliography formatting (font, size, spacing, color, alignment) is adjustable below.</li>
        </ol>
      </div>
    </div>
  </div>

  <!-- Toast (single) -->
  <div id="toast" class="toast" aria-live="polite"></div>

  <!-- Main pane -->
  <div class="pane">

    <!-- BibTeX box -->
    <textarea id="bibtexInput" placeholder="Paste BibTeX entry here…"></textarea>

    <!-- Page/Note inputs -->
    <div id="noteInputs">
      <input id="notePage" placeholder="Page / para / line"/>
      <input id="noteText" placeholder="Your note (optional)"/>
    </div>

    <!-- Controls: Add / Add & Cite / Style -->
    <div id="controlsRow">
      <button id="btnAddOnly">Add</button>
      <button id="btnAddCite">Add &amp; Cite</button>

      <select id="styleSelect" aria-label="Citation style">
        <option value="apa">APA</option>
        <option value="ieee">IEEE</option>
        <option value="harvard">Harvard</option>
        <option value="acs">American Chemical Society</option>
        <option value="vancouver">Vancouver</option>
      </select>
    </div>

    <!-- Style badge -->
    <div class="row" id="styleBadgeRow">
      <span id="styleBadge" class="badge">APA</span>
    </div>

    <!-- Search + results -->
    <input id="search" placeholder="Search author, year, title…"/>
    <div id="results"></div>

    <hr/>

    <!-- Actions -->
    <div class="row">
      <button id="btnInsertCite">Insert citation</button>
      <button id="btnUpdateBib">Update bibliography</button>
    </div>

    <div class="row" style="margin-top:12px">
      <button id="btnResetNumbering" title="Forget first-cited order only">Reset numbering</button>
      <button id="btnClearLibrary" title="Delete all saved entries">Clear Library</button>
      <button id="btnReload" title="Reload task pane UI">Reload</button>
    </div>

    <!-- Bibliography Format (indented container so title + panel align) -->
    <section id="bibFormat">
      <div class="section-title">Bibliography Format</div>

      <div id="bibFormatRow">
        <div class="form-chunk">
          <label for="bibFont">Font:</label>
          <select id="bibFont">
            <option value="Times New Roman" selected>Times New Roman</option>
            <option value="Calibri">Calibri</option>
            <option value="Arial">Arial</option>
            <option value="Cambria">Cambria</option>
          </select>
        </div>

        <div class="form-chunk">
          <label for="bibSize">Size:</label>
          <input id="bibSize" type="number" value="12" min="8" max="24" style="width:4.5em;">
        </div>

        <div class="form-chunk">
          <label for="bibSpacing">Line spacing:</label>
          <input id="bibSpacing" type="number" value="14" min="10" max="36" style="width:4.5em;">
        </div>

        <div class="form-chunk">
          <label for="bibAlign">Alignment:</label>
          <select id="bibAlign">
            <option value="Left" selected>Left</option>
            <option value="Justified">Justified</option>
            <option value="Centered">Centered</option>
            <option value="Right">Right</option>
          </select>
        </div>

        <div class="form-chunk">
          <label for="bibColor">Font color:</label>
          <input id="bibColor" class="swatch" type="color" value="#333333" />
        </div>
      </div>
    </section>
  </div>

  <!-- Inline confirm (kept) -->
  <div id="confirmBar" class="confirm-bar" style="display:none">
    <span id="confirmMsg"></span>
    <button id="confirmYes">Yes</button>
    <button id="confirmNo">Cancel</button>
  </div>
</body>
</html>